http://rahn80643-blog.logdown.com/posts/1308161

因為有些指令的權限會需要是 root，所以在這邊會把使用者切換成 root

$ sudo su
# cd

透過 wget 把 ubuntu 安裝映像檔下載下來。

# wget http://releases.ubuntu.com/18.04/ubuntu-18.04.6-desktop-amd64.iso

建立一個新的目錄來儲存解壓縮後的 iso 檔案。

# mkdir -p /mnt/iso
在這個階段，會需要 mount 這些檔案，可是這些檔案是唯讀的(read-only)，為了能夠修改這些檔案，會需要把它們複製到另一個能夠修改的目錄裡面，所以要再創造新的目錄並複製這些檔案。

# mount -o loop ubuntu-14.04.4-server-amd64.iso /mnt/iso
# mkdir -p /opt/ubuntuiso
# cp -rT /mnt/iso /opt/ubuntuiso
執行之後，目錄(/opt/ubuntuiso)的內容如下圖所示


在這邊會設定三個檔案，分別是:
/ubuntuiso/ks.cfg：剛剛從 kickstart 產生出來的檔案
/ubuntuiso/ks.pressed：後面的步驟需要新增的檔案
/ubuntuiso/isolinux/txt.cfg：在目錄裡面已經存在，需要修改的檔案
為避免在安裝階段跳出語言選擇的選項，所以必須要提供語言的使用資訊，在這邊使用的是英文(en)。

# echo en >isolinux/lang
把先前從 kickstart 設定好的 ks.cfg 複製到 /opt/ubuntuiso。 以下是我的 ks.cfg 的內容:

#Generated by Kickstart Configurator
#platform=x86
#System language
lang en_US
#Language modules to install
langsupport zh_TW --default=en_US
#System keyboard
keyboard us
#System mouse
mouse
#System timezone
timezone Asia/Taipei
#Root password
rootpw --disabled
#Initial user
user control --fullname "control" --password control
#Reboot after installation
reboot
#Use text mode install
text
#Install OS instead of upgrade
install
#Use CDROM installation media
cdrom
#System bootloader configuration
bootloader --location=mbr
#Clear the Master Boot Record
zerombr yes
#Partition clearing information
clearpart --all --initlabel
#Basic disk partition
part / --fstype ext4 --size 1 --grow --asprimary
part swap --size 1024
part /boot --fstype ext4 --size 256 --asprimary
#system authorization infomation
auth  --useshadow  --enablemd5
#Network information
network --bootproto=dhcp --device=p2p1
#Firewall configuration
firewall --disabled --ssh
#Do not configure the X Window System
skipx
%packages
openssh-server
新增一個 pressed 檔案來自動應答其他選項。

# nano ks.pressed
d-i user-setup/allow-password-weak boolean true
d-i preseed/early_command string umount /media || true
d-i partman/confirm_write_new_label boolean true
d-i partman/choose_partition \
select Finish partitioning and write changes to disk
d-i partman/confirm boolean true
10.現在需要告訴安裝程式剛剛設定的兩個檔案「ks.cfg」、「ks.pressed」，所以需要設定 isolinux/txt.cfg。首先須要讓這個檔案能夠被寫入。

# chmod +w isolinux/txt.cfg
# nano isolinux/txt.cfg
在最後面加入這段文字

label autoInstall
menu label ^Install Ubuntu Server Automatically
kernel /install/vmlinuz
append file=/cdrom/preseed/ubuntu-server.seed initrd=/install/initrd.gz ks=cdrom:/ks.cfg preseed/fil
e=/cdrom/ks.pressed --
編輯完之後，復原檔案的存取權限。

# chmod -w isolinux/txt.cfg
11.創造新的 iso 檔以供之後的 USB 開機碟使用。

# mkisofs -D -r -V "ATTENDLESS_UBUNTU" -cache-inodes -J -l -b isolinux/isolinux.bin -c isolinux/boot.cat -no-emul-boot -boot-load-size 4 -boot-info-table -o /opt/autoinstall.iso /opt/ubuntuiso
  
# isohybrid /opt/autoinstall.iso
12.使用 Startup Disk Creator 把設定好的 iso 檔製作成 USB 開機碟。
13.設定電腦的 BIOS 從 USB 開機，就可以開始安裝了。


