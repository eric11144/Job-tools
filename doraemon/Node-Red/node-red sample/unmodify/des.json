[
    {
        "id": "f941175c.d563d8",
        "type": "tab",
        "label": "Initialize",
        "disabled": false,
        "info": ""
    },
    {
        "id": "c8d83dd6.129da",
        "type": "tab",
        "label": "Control",
        "disabled": false,
        "info": ""
    },
    {
        "id": "282939f0.8d3486",
        "type": "tab",
        "label": "首件 View",
        "disabled": false,
        "info": ""
    },
    {
        "id": "976482dc.415df",
        "type": "tab",
        "label": "首件 Control",
        "disabled": false,
        "info": ""
    },
    {
        "id": "e7333943.c4bbc8",
        "type": "tab",
        "label": "量產工單 View",
        "disabled": false,
        "info": ""
    },
    {
        "id": "e2d46b65.8c3d28",
        "type": "tab",
        "label": "量產工單 Control",
        "disabled": false,
        "info": ""
    },
    {
        "id": "833a454f.52ebf8",
        "type": "tab",
        "label": "量產 View",
        "disabled": false,
        "info": ""
    },
    {
        "id": "91f6d9cd.bc6648",
        "type": "tab",
        "label": "量產 Control",
        "disabled": false,
        "info": ""
    },
    {
        "id": "68e17fbd.b18c8",
        "type": "tab",
        "label": "投板 View",
        "disabled": false,
        "info": ""
    },
    {
        "id": "a8fedd5f.a9ed3",
        "type": "tab",
        "label": "投板 Control",
        "disabled": false,
        "info": ""
    },
    {
        "id": "e0b73c3e.34741",
        "type": "tab",
        "label": "待寫入配方 Control",
        "disabled": false,
        "info": ""
    },
    {
        "id": "a160ae94.2c31a",
        "type": "ui_base",
        "theme": {
            "name": "theme-light",
            "lightTheme": {
                "default": "#0094CE",
                "baseColor": "#0094CE",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "darkTheme": {
                "default": "#097479",
                "baseColor": "#097479",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": false
            },
            "customTheme": {
                "name": "Untitled Theme 1",
                "default": "#4B7930",
                "baseColor": "#4B7930",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
            },
            "themeState": {
                "base-color": {
                    "default": "#0094CE",
                    "value": "#0094CE",
                    "edited": false
                },
                "page-titlebar-backgroundColor": {
                    "value": "#0094CE",
                    "edited": false
                },
                "page-backgroundColor": {
                    "value": "#fafafa",
                    "edited": false
                },
                "page-sidebar-backgroundColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "group-textColor": {
                    "value": "#1bbfff",
                    "edited": false
                },
                "group-borderColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "group-backgroundColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "widget-textColor": {
                    "value": "#111111",
                    "edited": false
                },
                "widget-backgroundColor": {
                    "value": "#0094ce",
                    "edited": false
                },
                "widget-borderColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "base-font": {
                    "value": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
                }
            },
            "angularTheme": {
                "primary": "indigo",
                "accents": "blue",
                "warn": "red",
                "background": "grey"
            }
        },
        "site": {
            "name": "Node-RED Dashboard",
            "hideToolbar": "false",
            "allowSwipe": "false",
            "lockMenu": "false",
            "allowTempTheme": "true",
            "dateFormat": "DD/MM/YYYY",
            "sizes": {
                "sx": 48,
                "sy": 48,
                "gx": 6,
                "gy": 6,
                "cx": 6,
                "cy": 6,
                "px": 0,
                "py": 0
            }
        }
    },
    {
        "id": "f1bd677f.27a368",
        "type": "ui_tab",
        "name": "首件",
        "icon": "dashboard",
        "order": 1,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "ea32b750.6ca6f8",
        "type": "ui_group",
        "name": "量產歷史",
        "tab": "f1bd677f.27a368",
        "order": 1,
        "disp": true,
        "width": "34",
        "collapse": false
    },
    {
        "id": "f26be9c1.ab8438",
        "type": "ui_group",
        "name": "投料狀態",
        "tab": "f1bd677f.27a368",
        "order": 2,
        "disp": true,
        "width": "3",
        "collapse": false
    },
    {
        "id": "97df8564.127258",
        "type": "ui_group",
        "name": "輸入",
        "tab": "f1bd677f.27a368",
        "order": 3,
        "disp": true,
        "width": "5",
        "collapse": false
    },
    {
        "id": "aee96011.ff3ad",
        "type": "ui_group",
        "name": "工單內容",
        "tab": "f1bd677f.27a368",
        "order": 4,
        "disp": true,
        "width": "4",
        "collapse": false
    },
    {
        "id": "8d8c707b.b5185",
        "type": "ui_group",
        "name": "確認站別",
        "tab": "f1bd677f.27a368",
        "order": 5,
        "disp": true,
        "width": "4",
        "collapse": false
    },
    {
        "id": "1478aa03.9927e6",
        "type": "ui_group",
        "name": "取得配方上下限",
        "tab": "f1bd677f.27a368",
        "order": 6,
        "disp": true,
        "width": "9",
        "collapse": false
    },
    {
        "id": "4355f279.d7b5bc",
        "type": "ui_group",
        "name": "首件配方",
        "tab": "f1bd677f.27a368",
        "order": 7,
        "disp": true,
        "width": "4",
        "collapse": false
    },
    {
        "id": "7512340c.61316c",
        "type": "ui_group",
        "name": "待寫入配方",
        "tab": "f1bd677f.27a368",
        "order": 8,
        "disp": true,
        "width": "4",
        "collapse": false
    },
    {
        "id": "62b00e11.f7f9d",
        "type": "ui_tab",
        "name": "量產工單",
        "icon": "dashboard",
        "order": 2,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "ac37d3a3.8412",
        "type": "ui_group",
        "name": "輸入",
        "tab": "62b00e11.f7f9d",
        "order": 1,
        "disp": true,
        "width": "5",
        "collapse": false
    },
    {
        "id": "7f5cf29a.43516c",
        "type": "ui_group",
        "name": "工單內容",
        "tab": "62b00e11.f7f9d",
        "order": 2,
        "disp": true,
        "width": "4",
        "collapse": false
    },
    {
        "id": "631fbc7b.c62c04",
        "type": "ui_group",
        "name": "首件配方",
        "tab": "62b00e11.f7f9d",
        "order": 3,
        "disp": true,
        "width": "4",
        "collapse": false
    },
    {
        "id": "6ac1c94a.e8c9c8",
        "type": "ui_group",
        "name": "量產條碼",
        "tab": "62b00e11.f7f9d",
        "order": 5,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "7c98d06e.b62ed",
        "type": "ui_group",
        "name": "量產配方",
        "tab": "62b00e11.f7f9d",
        "order": 4,
        "disp": true,
        "width": "4",
        "collapse": false
    },
    {
        "id": "1daf06ec.68d819",
        "type": "ui_tab",
        "name": "量產",
        "icon": "dashboard",
        "order": 3,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "d3a4a9ae.62a9e8",
        "type": "ui_group",
        "name": "投料狀態",
        "tab": "1daf06ec.68d819",
        "order": 1,
        "disp": true,
        "width": "3",
        "collapse": false
    },
    {
        "id": "9bf62832.832ea8",
        "type": "ui_group",
        "name": "輸入",
        "tab": "1daf06ec.68d819",
        "order": 2,
        "disp": true,
        "width": "5",
        "collapse": false
    },
    {
        "id": "5fa6bd42.a3e104",
        "type": "ui_group",
        "name": "工單內容",
        "tab": "1daf06ec.68d819",
        "order": 3,
        "disp": true,
        "width": "4",
        "collapse": false
    },
    {
        "id": "1d217389.2e440c",
        "type": "ui_group",
        "name": "確認站別",
        "tab": "1daf06ec.68d819",
        "order": 4,
        "disp": true,
        "width": "4",
        "collapse": false
    },
    {
        "id": "19b39d08.770233",
        "type": "ui_group",
        "name": "待寫入配方",
        "tab": "1daf06ec.68d819",
        "order": 5,
        "disp": true,
        "width": "4",
        "collapse": false
    },
    {
        "id": "89deeca0.97b31",
        "type": "ui_tab",
        "name": "投板",
        "icon": "dashboard",
        "order": 4,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "f9fdaf2.a529a5",
        "type": "ui_group",
        "name": "投料狀態",
        "tab": "89deeca0.97b31",
        "order": 1,
        "disp": true,
        "width": "3",
        "collapse": false
    },
    {
        "id": "f78a35ed.5b0018",
        "type": "ui_group",
        "name": "輸入",
        "tab": "89deeca0.97b31",
        "order": 2,
        "disp": true,
        "width": "5",
        "collapse": false
    },
    {
        "id": "ba848a9a.d0ffe8",
        "type": "ui_group",
        "name": "工單內容",
        "tab": "89deeca0.97b31",
        "order": 3,
        "disp": true,
        "width": "4",
        "collapse": false
    },
    {
        "id": "174c3a20.2d7fe6",
        "type": "ui_group",
        "name": "最後投入工單",
        "tab": "89deeca0.97b31",
        "order": 4,
        "disp": true,
        "width": "4",
        "collapse": false
    },
    {
        "id": "ac3dfebc.ad43",
        "type": "ui_group",
        "name": "應投工單",
        "tab": "89deeca0.97b31",
        "order": 5,
        "disp": true,
        "width": "4",
        "collapse": false
    },
    {
        "id": "a33eb33d.bcefc",
        "type": "ui_group",
        "name": "待寫入配方",
        "tab": "89deeca0.97b31",
        "order": 6,
        "disp": true,
        "width": "4",
        "collapse": false
    },
    {
        "id": "4d491436.aab4dc",
        "type": "ui_table",
        "z": "282939f0.8d3486",
        "group": "ea32b750.6ca6f8",
        "name": "量產歷史",
        "order": 0,
        "width": "33",
        "height": "5",
        "columns": [
            {
                "field": "at",
                "title": "時間",
                "width": "250",
                "align": "left",
                "formatter": "plaintext",
                "formatterParams": {
                    "target": "_blank"
                }
            },
            {
                "field": "etchingSpeedSet",
                "title": "蝕刻速度",
                "width": "",
                "align": "left",
                "formatter": "plaintext",
                "formatterParams": {
                    "target": "_blank"
                }
            },
            {
                "field": "etching1UpSprayPressureSet",
                "title": "蝕刻1上噴",
                "width": "",
                "align": "left",
                "formatter": "plaintext",
                "formatterParams": {
                    "target": "_blank"
                }
            },
            {
                "field": "etching1DownSprayPressureSet",
                "title": "蝕刻1下噴",
                "width": "",
                "align": "left",
                "formatter": "plaintext",
                "formatterParams": {
                    "target": "_blank"
                }
            },
            {
                "field": "etching2SwitchSet",
                "title": "蝕刻2開關",
                "width": "",
                "align": "left",
                "formatter": "plaintext",
                "formatterParams": {
                    "target": "_blank"
                }
            },
            {
                "field": "etching3SwitchSet",
                "title": "蝕刻3開關",
                "width": "",
                "align": "left",
                "formatter": "plaintext",
                "formatterParams": {
                    "target": "_blank"
                }
            },
            {
                "field": "developSpeedSet",
                "title": "顯影速度",
                "width": "",
                "align": "left",
                "formatter": "plaintext",
                "formatterParams": {
                    "target": "_blank"
                }
            }
        ],
        "outputs": 1,
        "cts": true,
        "x": 520,
        "y": 320,
        "wires": [
            []
        ]
    },
    {
        "id": "50821772.d4b818",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "f26be9c1.ab8438",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "可投料",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 510,
        "y": 440,
        "wires": []
    },
    {
        "id": "3bfec1c7.f26aae",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "f26be9c1.ab8438",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "E槽",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 510,
        "y": 480,
        "wires": []
    },
    {
        "id": "173e9993.e394f6",
        "type": "comment",
        "z": "282939f0.8d3486",
        "name": "量產歷史",
        "info": "",
        "x": 200,
        "y": 260,
        "wires": []
    },
    {
        "id": "f5aae11c.cea08",
        "type": "comment",
        "z": "282939f0.8d3486",
        "name": "輸入",
        "info": "",
        "x": 190,
        "y": 600,
        "wires": []
    },
    {
        "id": "dbe1892b.c6a968",
        "type": "ui_text_input",
        "z": "282939f0.8d3486",
        "name": "",
        "label": "生產人員編號",
        "tooltip": "",
        "group": "97df8564.127258",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "mode": "text",
        "delay": 300,
        "topic": "topic",
        "topicType": "msg",
        "x": 540,
        "y": 660,
        "wires": [
            [
                "ba48c648.66a808"
            ]
        ]
    },
    {
        "id": "26d3b984.34f296",
        "type": "comment",
        "z": "282939f0.8d3486",
        "name": "投料狀態",
        "info": "",
        "x": 200,
        "y": 420,
        "wires": []
    },
    {
        "id": "44afce8a.3d7a",
        "type": "ui_text_input",
        "z": "282939f0.8d3486",
        "name": "",
        "label": "工單碼",
        "tooltip": "",
        "group": "97df8564.127258",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": true,
        "mode": "text",
        "delay": 300,
        "topic": "topic",
        "topicType": "msg",
        "x": 510,
        "y": 700,
        "wires": [
            [
                "fe8cac2.31b065"
            ]
        ]
    },
    {
        "id": "2fee62a3.f8ba4e",
        "type": "ui_text_input",
        "z": "282939f0.8d3486",
        "name": "",
        "label": "層別",
        "tooltip": "",
        "group": "97df8564.127258",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": true,
        "mode": "text",
        "delay": 300,
        "topic": "topic",
        "topicType": "msg",
        "x": 510,
        "y": 740,
        "wires": [
            [
                "5f38c520.f089ac"
            ]
        ]
    },
    {
        "id": "24aa162b.32518a",
        "type": "comment",
        "z": "282939f0.8d3486",
        "name": "工單內容",
        "info": "",
        "x": 200,
        "y": 820,
        "wires": []
    },
    {
        "id": "3a9485af.90958a",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "aee96011.ff3ad",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "料號 (PN)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 520,
        "y": 860,
        "wires": []
    },
    {
        "id": "6b42a028.c70a3",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "aee96011.ff3ad",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "批號 (Lot)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 520,
        "y": 900,
        "wires": []
    },
    {
        "id": "8ebc5c48.36439",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "aee96011.ff3ad",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "工令 (Lot ID)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 530,
        "y": 940,
        "wires": []
    },
    {
        "id": "ce0da323.c0341",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "aee96011.ff3ad",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "層別 (Stage)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 530,
        "y": 980,
        "wires": []
    },
    {
        "id": "33320730.e54268",
        "type": "comment",
        "z": "282939f0.8d3486",
        "name": "確認站別",
        "info": "",
        "x": 200,
        "y": 1100,
        "wires": []
    },
    {
        "id": "33b1daf3.0ccc26",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "8d8c707b.b5185",
        "order": 0,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "狀態",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "x": 510,
        "y": 1160,
        "wires": []
    },
    {
        "id": "670cda08.659fb4",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "8d8c707b.b5185",
        "order": 0,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "當前站別",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 520,
        "y": 1200,
        "wires": []
    },
    {
        "id": "6631b873.70d598",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "8d8c707b.b5185",
        "order": 0,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "預期站別",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 520,
        "y": 1240,
        "wires": []
    },
    {
        "id": "138d9785.e962b8",
        "type": "ui_button",
        "z": "282939f0.8d3486",
        "name": "",
        "group": "aee96011.ff3ad",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "確定",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 510,
        "y": 1020,
        "wires": [
            [
                "4ae81823.fb11b8"
            ]
        ]
    },
    {
        "id": "3b67edbc.356df2",
        "type": "comment",
        "z": "282939f0.8d3486",
        "name": "取得配方上下限",
        "info": "",
        "x": 220,
        "y": 1400,
        "wires": []
    },
    {
        "id": "edc01c5a.dba7",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "1478aa03.9927e6",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "狀態",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "x": 510,
        "y": 1480,
        "wires": []
    },
    {
        "id": "cf033f28.ab584",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "1478aa03.9927e6",
        "order": 2,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "蝕刻速度",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 520,
        "y": 1540,
        "wires": []
    },
    {
        "id": "d0b0bb78.efd7b8",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "1478aa03.9927e6",
        "order": 3,
        "width": "2",
        "height": "1",
        "name": "蝕刻速度/上限",
        "label": "上限",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 700,
        "y": 1540,
        "wires": []
    },
    {
        "id": "cdb4623.1d1eea",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "1478aa03.9927e6",
        "order": 4,
        "width": "2",
        "height": "1",
        "name": "蝕刻速度/中值",
        "label": "中值",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 880,
        "y": 1540,
        "wires": []
    },
    {
        "id": "5e616290.ec0acc",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "1478aa03.9927e6",
        "order": 5,
        "width": "2",
        "height": "1",
        "name": "蝕刻速度/下限",
        "label": "下限",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 1060,
        "y": 1540,
        "wires": []
    },
    {
        "id": "ac73aa42.a87168",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "1478aa03.9927e6",
        "order": 6,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "蝕刻1上噴",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 530,
        "y": 1620,
        "wires": []
    },
    {
        "id": "4b98b69c.8c9308",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "1478aa03.9927e6",
        "order": 7,
        "width": "2",
        "height": "1",
        "name": "蝕刻1上噴/上限",
        "label": "上限",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 700,
        "y": 1620,
        "wires": []
    },
    {
        "id": "7ebb1133.2241",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "1478aa03.9927e6",
        "order": 8,
        "width": "2",
        "height": "1",
        "name": "蝕刻1上噴/中值",
        "label": "中值",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 880,
        "y": 1620,
        "wires": []
    },
    {
        "id": "a0e7fd2b.e7981",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "1478aa03.9927e6",
        "order": 9,
        "width": "2",
        "height": "1",
        "name": "蝕刻1上噴下限",
        "label": "下限",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 1060,
        "y": 1620,
        "wires": []
    },
    {
        "id": "6a5551eb.d45e9",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "1478aa03.9927e6",
        "order": 10,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "蝕刻1下噴",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 530,
        "y": 1700,
        "wires": []
    },
    {
        "id": "ca8da069.50853",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "1478aa03.9927e6",
        "order": 11,
        "width": "2",
        "height": "1",
        "name": "蝕刻1下噴/上限",
        "label": "上限",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 700,
        "y": 1700,
        "wires": []
    },
    {
        "id": "9d72f27b.b7345",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "1478aa03.9927e6",
        "order": 12,
        "width": "2",
        "height": "1",
        "name": "蝕刻1下噴/中值",
        "label": "中值",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 880,
        "y": 1700,
        "wires": []
    },
    {
        "id": "a57a4fe5.64f2",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "1478aa03.9927e6",
        "order": 13,
        "width": "2",
        "height": "1",
        "name": "蝕刻1下噴/下限",
        "label": "下限",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 1060,
        "y": 1700,
        "wires": []
    },
    {
        "id": "88251c1a.aaa86",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "1478aa03.9927e6",
        "order": 14,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "蝕刻2開關",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 530,
        "y": 1780,
        "wires": []
    },
    {
        "id": "9ab07ea0.5d06b",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "1478aa03.9927e6",
        "order": 15,
        "width": "2",
        "height": "1",
        "name": "蝕刻2開關/上限",
        "label": "上限",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 700,
        "y": 1780,
        "wires": []
    },
    {
        "id": "995ca317.fa355",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "1478aa03.9927e6",
        "order": 16,
        "width": "2",
        "height": "1",
        "name": "蝕刻2開關/中值",
        "label": "中值",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 880,
        "y": 1780,
        "wires": []
    },
    {
        "id": "a633cd4c.17ee5",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "1478aa03.9927e6",
        "order": 17,
        "width": "2",
        "height": "1",
        "name": "蝕刻2開關/下限",
        "label": "下限",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 1060,
        "y": 1780,
        "wires": []
    },
    {
        "id": "d9f5b088.ada5e",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "1478aa03.9927e6",
        "order": 18,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "蝕刻3開關",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 530,
        "y": 1860,
        "wires": []
    },
    {
        "id": "465366bd.5da678",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "1478aa03.9927e6",
        "order": 19,
        "width": "2",
        "height": "1",
        "name": "蝕刻3開關/上限",
        "label": "上限",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 700,
        "y": 1860,
        "wires": []
    },
    {
        "id": "4ecfb9a3.8370e8",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "1478aa03.9927e6",
        "order": 20,
        "width": "2",
        "height": "1",
        "name": "蝕刻3開關/中值",
        "label": "中值",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 880,
        "y": 1860,
        "wires": []
    },
    {
        "id": "1778e040.b0fe1",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "1478aa03.9927e6",
        "order": 21,
        "width": "2",
        "height": "1",
        "name": "蝕刻3開關/下限",
        "label": "下限",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 1060,
        "y": 1860,
        "wires": []
    },
    {
        "id": "bf3a8fe6.9828f",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "1478aa03.9927e6",
        "order": 22,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "顯影速度",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 520,
        "y": 1940,
        "wires": []
    },
    {
        "id": "60f07d0a.e52544",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "1478aa03.9927e6",
        "order": 23,
        "width": "2",
        "height": "1",
        "name": "顯影速度/上限",
        "label": "上限",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 700,
        "y": 1940,
        "wires": []
    },
    {
        "id": "3b242dca.a23d82",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "1478aa03.9927e6",
        "order": 24,
        "width": "2",
        "height": "1",
        "name": "顯影速度/中值",
        "label": "中值",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 880,
        "y": 1940,
        "wires": []
    },
    {
        "id": "e5ef0b7c.90fda8",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "1478aa03.9927e6",
        "order": 25,
        "width": "2",
        "height": "1",
        "name": "顯影速度/下限",
        "label": "下限",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 1060,
        "y": 1940,
        "wires": []
    },
    {
        "id": "cb22a85b.6576d8",
        "type": "comment",
        "z": "282939f0.8d3486",
        "name": "首件配方",
        "info": "",
        "x": 200,
        "y": 2100,
        "wires": []
    },
    {
        "id": "4aa6c5a6.1d20bc",
        "type": "ui_button",
        "z": "282939f0.8d3486",
        "name": "",
        "group": "4355f279.d7b5bc",
        "order": 1,
        "width": "2",
        "height": "1",
        "passthru": false,
        "label": "{{msg.topic}}",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 510,
        "y": 2480,
        "wires": [
            [
                "9e73e03b.bfc23"
            ]
        ]
    },
    {
        "id": "658bd7e7.30b2d8",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "4355f279.d7b5bc",
        "order": 2,
        "width": "2",
        "height": "1",
        "name": "",
        "label": "狀態",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "x": 510,
        "y": 2180,
        "wires": []
    },
    {
        "id": "eaa97b63.cfb518",
        "type": "ui_text_input",
        "z": "282939f0.8d3486",
        "name": "",
        "label": "蝕刻速度",
        "tooltip": "",
        "group": "4355f279.d7b5bc",
        "order": 3,
        "width": "3",
        "height": "1",
        "passthru": true,
        "mode": "number",
        "delay": 300,
        "topic": "topic",
        "topicType": "msg",
        "x": 520,
        "y": 2220,
        "wires": [
            [
                "e874781.9639788"
            ]
        ]
    },
    {
        "id": "bb0b3792.097a98",
        "type": "ui_text_input",
        "z": "282939f0.8d3486",
        "name": "",
        "label": "蝕刻1上噴",
        "tooltip": "",
        "group": "4355f279.d7b5bc",
        "order": 5,
        "width": "3",
        "height": "1",
        "passthru": true,
        "mode": "number",
        "delay": 300,
        "topic": "topic",
        "topicType": "msg",
        "x": 530,
        "y": 2260,
        "wires": [
            [
                "470a372c.a67ba8"
            ]
        ]
    },
    {
        "id": "d3e32137.6e4be",
        "type": "ui_text_input",
        "z": "282939f0.8d3486",
        "name": "",
        "label": "蝕刻1下噴",
        "tooltip": "",
        "group": "4355f279.d7b5bc",
        "order": 7,
        "width": "3",
        "height": "1",
        "passthru": true,
        "mode": "number",
        "delay": 300,
        "topic": "topic",
        "topicType": "msg",
        "x": 530,
        "y": 2300,
        "wires": [
            [
                "524a4608.b22bb8"
            ]
        ]
    },
    {
        "id": "c62ef2c9.cfa25",
        "type": "ui_text_input",
        "z": "282939f0.8d3486",
        "name": "",
        "label": "蝕刻2開關",
        "tooltip": "",
        "group": "4355f279.d7b5bc",
        "order": 9,
        "width": "3",
        "height": "1",
        "passthru": true,
        "mode": "text",
        "delay": 300,
        "topic": "topic",
        "topicType": "msg",
        "x": 530,
        "y": 2340,
        "wires": [
            [
                "1d5f04b.55d0afb"
            ]
        ]
    },
    {
        "id": "eb706ab8.c7e358",
        "type": "ui_text_input",
        "z": "282939f0.8d3486",
        "name": "",
        "label": "蝕刻3開關",
        "tooltip": "",
        "group": "4355f279.d7b5bc",
        "order": 11,
        "width": "3",
        "height": "1",
        "passthru": true,
        "mode": "text",
        "delay": 300,
        "topic": "topic",
        "topicType": "msg",
        "x": 530,
        "y": 2380,
        "wires": [
            [
                "3551d436.53c05c"
            ]
        ]
    },
    {
        "id": "da09edf0.b1d0c",
        "type": "ui_text_input",
        "z": "282939f0.8d3486",
        "name": "",
        "label": "顯影速度",
        "tooltip": "",
        "group": "4355f279.d7b5bc",
        "order": 13,
        "width": "3",
        "height": "1",
        "passthru": true,
        "mode": "number",
        "delay": 300,
        "topic": "topic",
        "topicType": "msg",
        "x": 520,
        "y": 2420,
        "wires": [
            [
                "e58800d4.eb77d"
            ]
        ]
    },
    {
        "id": "d67af132.8bb14",
        "type": "comment",
        "z": "282939f0.8d3486",
        "name": "待寫入配方",
        "info": "",
        "x": 200,
        "y": 2680,
        "wires": []
    },
    {
        "id": "d591e9e1.5b7da8",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "7512340c.61316c",
        "order": 1,
        "width": "2",
        "height": "1",
        "name": "",
        "label": "狀態",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "x": 510,
        "y": 2740,
        "wires": []
    },
    {
        "id": "11915014.35bfc",
        "type": "ui_button",
        "z": "282939f0.8d3486",
        "name": "",
        "group": "7512340c.61316c",
        "order": 2,
        "width": "2",
        "height": "1",
        "passthru": false,
        "label": "清除",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 510,
        "y": 3100,
        "wires": [
            [
                "7c8fa0ae.4daa4"
            ]
        ]
    },
    {
        "id": "5ccfe01.6cce02",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "7512340c.61316c",
        "order": 3,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "蝕刻速度",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 520,
        "y": 2780,
        "wires": []
    },
    {
        "id": "76e87833.0db1e8",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "7512340c.61316c",
        "order": 4,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "蝕刻1上噴",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 530,
        "y": 2820,
        "wires": []
    },
    {
        "id": "d4c3df4f.f9fe",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "7512340c.61316c",
        "order": 5,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "蝕刻1下噴",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 530,
        "y": 2860,
        "wires": []
    },
    {
        "id": "295ef717.c0a398",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "7512340c.61316c",
        "order": 6,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "蝕刻2開關",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 530,
        "y": 2900,
        "wires": []
    },
    {
        "id": "a5c28eb1.19edc",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "7512340c.61316c",
        "order": 7,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "蝕刻3開關",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 530,
        "y": 2940,
        "wires": []
    },
    {
        "id": "13528740.8a1f69",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "7512340c.61316c",
        "order": 8,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "顯影速度",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 520,
        "y": 2980,
        "wires": []
    },
    {
        "id": "a1d0e5c4.1446d8",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "7512340c.61316c",
        "order": 10,
        "width": "4",
        "height": "1",
        "name": "",
        "label": "工單碼/量產工單碼",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "x": 550,
        "y": 3020,
        "wires": []
    },
    {
        "id": "56f55ca2.0599b4",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "7512340c.61316c",
        "order": 12,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "時間",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "x": 510,
        "y": 3060,
        "wires": []
    },
    {
        "id": "906e5b22.4989f8",
        "type": "link in",
        "z": "282939f0.8d3486",
        "name": "To View",
        "links": [
            "1c425765.6b2309",
            "fae00d5b.4d7cf",
            "fe3b68d5.4d9bb8",
            "dd06c8ba.f3ede8",
            "89789973.e5e468",
            "489ba77a.50c808",
            "5996a99f.a82ad8",
            "e603e132.0cbe1",
            "a6a2f658.b55fa8",
            "774a8f54.a250b",
            "5cc58842.141918",
            "680f0250.6e2a2c",
            "e0443fff.4e35f",
            "49ed37b1.523d68",
            "5b27ed13.a3c814",
            "4abf0a7b.536ba4",
            "f4ddf088.12237",
            "e075a031.de73d",
            "b577d158.09844",
            "aa9618e3.489e98",
            "a50ccc58.1f6dd",
            "9c6f34ec.44c938",
            "8ee38a81.6bdf38",
            "b1be3310.5727e"
        ],
        "x": 155,
        "y": 680,
        "wires": [
            [
                "defdf854.fd3528",
                "1f9196f9.459a39"
            ]
        ]
    },
    {
        "id": "defdf854.fd3528",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "if (msg.topic !== 'model.pilotRun')\n{\n    return\n}\n\nconst model = global.get('model')\n\nconst enabled = model.pilotRun.state === 'INPUT'\n\nreturn [\n    {\n        enabled,\n        payload: model.pilotRun.input.operator\n    },\n    {\n        enabled,\n        payload: model.pilotRun.input.workorder\n    }\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 680,
        "wires": [
            [
                "dbe1892b.c6a968"
            ],
            [
                "44afce8a.3d7a"
            ]
        ]
    },
    {
        "id": "fae00d5b.4d7cf",
        "type": "link out",
        "z": "c8d83dd6.129da",
        "name": "To View",
        "links": [
            "906e5b22.4989f8",
            "25c230cf.7d5c1",
            "1f11def9.bf34a1",
            "7b8c2c08.b563e4",
            "78dc8b8f.5838b4",
            "5a694f49.a6dc1",
            "9c023a.051afdc8",
            "ae422560.686178",
            "e6618bc.b92f578",
            "6022ffbc.3bfec",
            "6e7d7659.49a0c8",
            "86c694dd.0d3b58",
            "b00a14bc.49c178",
            "72b20f0d.07717",
            "7201918.9d8ef7",
            "92f89b72.0dfc58",
            "2296d51b.bb473a",
            "fb3100ee.25d73",
            "563d78f.923fb88",
            "4ed6ea6c.5812f4",
            "79ce718d.22dbf",
            "54cc6ac1.ba3754",
            "9cd75563.219f28",
            "2c4b532c.3aee0c",
            "fa88555.452f3a8",
            "fcecc3e7.5eb01",
            "bb14064e.2c38e8"
        ],
        "x": 775,
        "y": 260,
        "wires": []
    },
    {
        "id": "fe8cac2.31b065",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "const workorder = msg.payload\n\nreturn {\n    topic: 'pilotRun.workorder',\n    payload: {\n        workorder: workorder\n    }\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 740,
        "y": 700,
        "wires": [
            [
                "58e75c96.95b2b4"
            ]
        ]
    },
    {
        "id": "58e75c96.95b2b4",
        "type": "link out",
        "z": "282939f0.8d3486",
        "name": "To Control",
        "links": [
            "3541d990.925686",
            "52efc3ab.55ab6c",
            "7418d21.45ad22c",
            "a7975a02.8a0c88",
            "3b97a635.15979a",
            "bb7671b1.06e21",
            "b0dc5ccf.b1d62",
            "55b00947.ddc508",
            "abb166c.3e09798",
            "6d90df4e.6ef51",
            "61ea8d29.c6a4f4",
            "f45dd390.154fa",
            "d83de82b.db06e8",
            "6d610381.b62fac",
            "bc6010e1.7537c",
            "f99d52f2.f8f68",
            "d3dcc847.1cd478",
            "6b1721e5.459cc",
            "37ba1dd3.f5c012",
            "71a73452.ac13dc",
            "beee06f7.be6498",
            "a9a83c81.2306a",
            "79dbf37.1b4860c"
        ],
        "x": 915,
        "y": 700,
        "wires": []
    },
    {
        "id": "3541d990.925686",
        "type": "link in",
        "z": "976482dc.415df",
        "name": "To Control",
        "links": [
            "58e75c96.95b2b4",
            "f9e43485.fec318",
            "44e76f83.bd737",
            "b20ba137.be08",
            "b17c3083.dd0c8",
            "b5f7b64b.c7a248",
            "b7b6c644.b328b8",
            "a8c2a30.58b5d6",
            "672a7a09.265094",
            "418f844b.671e2c",
            "8c4b9603.e1aee8",
            "4c11d973.d583d8",
            "73ad0302.9c13ac",
            "ca153323.175d",
            "9fb81c12.c17a1",
            "3d474729.48c3b8",
            "c362751b.9d6ec8",
            "b8efe10f.b23fd",
            "d84a2899.ed42d8",
            "a3a6fb04.90f508",
            "b3f2298f.3de718",
            "cb0d22ed.50e19"
        ],
        "x": 175,
        "y": 340,
        "wires": [
            [
                "de34b46c.6c8568",
                "9c79ce58.77be3",
                "888a2192.7986b8"
            ]
        ]
    },
    {
        "id": "3ae6a906.326586",
        "type": "comment",
        "z": "976482dc.415df",
        "name": "輸入",
        "info": "",
        "x": 210,
        "y": 240,
        "wires": []
    },
    {
        "id": "888a2192.7986b8",
        "type": "function",
        "z": "976482dc.415df",
        "name": "Handle workorder (LC2 工單碼 3+1 段)",
        "func": "if (msg.topic !== 'pilotRun.workorder')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.pilotRun.state !== 'INPUT')\n{\n    node.error('unexpected')\n    return\n}\n\nconst workorder = msg.payload.workorder\n\nlet exp = /^[0-9A-Z]+;[0-9A-Z.]+;[0-9.]+$/ig\n\nif (!exp.test(workorder))\n{\n    return [null, msg]\n}\n\nlet splitted = workorder.split(';')\nlet pn = splitted[0]\nlet lotId = splitted[1]\nlet lot = splitted[2]\n\nlet input = model.pilotRun.input\ninput.workorder = workorder\ninput.enableStage = true\n\nconst changes = {\n    input,\n    workorder: {\n        lotId: lotId,\n        pn: pn,\n        lot: lot,\n        stage: ''\n    }\n}\n\nmodel.pilotRun = Object.assign(model.pilotRun, changes)\nglobal.set('model', model)\n\nreturn [\n    {\n        topic: 'model.pilotRun',\n        payload: changes\n    },\n    null\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 490,
        "y": 420,
        "wires": [
            [
                "1c425765.6b2309"
            ],
            [
                "d8015c0b.b5477"
            ]
        ]
    },
    {
        "id": "1f9196f9.459a39",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "if (msg.topic !== 'model.pilotRun')\n{\n    return\n}\n\nconst model = global.get('model')\n\nconst enabled = model.pilotRun.state === 'INPUT'\n && !!model.pilotRun.workorder.lotId\n && !!model.pilotRun.workorder.pn\n && !!model.pilotRun.workorder.lot\n && model.pilotRun.input.enableStage\n\nreturn {\n    enabled,\n    payload: model.pilotRun.workorder.stage\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 740,
        "wires": [
            [
                "2fee62a3.f8ba4e"
            ]
        ]
    },
    {
        "id": "1c425765.6b2309",
        "type": "link out",
        "z": "976482dc.415df",
        "name": "To View",
        "links": [
            "1f11def9.bf34a1",
            "25c230cf.7d5c1",
            "906e5b22.4989f8",
            "7b8c2c08.b563e4",
            "78dc8b8f.5838b4",
            "5a694f49.a6dc1",
            "9c023a.051afdc8",
            "ae422560.686178",
            "e6618bc.b92f578",
            "6022ffbc.3bfec",
            "6e7d7659.49a0c8",
            "86c694dd.0d3b58",
            "b00a14bc.49c178",
            "72b20f0d.07717",
            "7201918.9d8ef7",
            "92f89b72.0dfc58",
            "2296d51b.bb473a",
            "fb3100ee.25d73",
            "563d78f.923fb88",
            "4ed6ea6c.5812f4",
            "79ce718d.22dbf",
            "54cc6ac1.ba3754",
            "9cd75563.219f28",
            "2c4b532c.3aee0c",
            "fa88555.452f3a8",
            "fcecc3e7.5eb01",
            "bb14064e.2c38e8"
        ],
        "x": 1015,
        "y": 480,
        "wires": []
    },
    {
        "id": "5f38c520.f089ac",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "const stage = msg.payload\n\nreturn {\n    topic: 'pilotRun.stage',\n    payload: {\n        stage: stage\n    }\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 740,
        "y": 740,
        "wires": [
            [
                "58e75c96.95b2b4"
            ]
        ]
    },
    {
        "id": "9c79ce58.77be3",
        "type": "function",
        "z": "976482dc.415df",
        "name": "Handle stage",
        "func": "if (msg.topic !== 'pilotRun.stage')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.pilotRun.state !== 'INPUT')\n{\n    node.error('unexpected')\n    return\n}\n\nconst stage = msg.payload.stage\n\nlet workorder = model.pilotRun.workorder\nworkorder.stage = stage\n\nconst changes = {\n    workorder\n}\n\nmodel.pilotRun = Object.assign(model.pilotRun, changes)\n\nreturn {\n    topic: 'model.pilotRun',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 410,
        "y": 640,
        "wires": [
            [
                "1c425765.6b2309"
            ]
        ]
    },
    {
        "id": "c15be354.f8f11",
        "type": "function",
        "z": "976482dc.415df",
        "name": "Handle workorder (parse error)",
        "func": "if (msg.topic !== 'pilotRun.workorder')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.pilotRun.state !== 'INPUT')\n{\n    node.error('unexpected')\n    return\n}\n\nlet input = model.pilotRun.input\ninput.workorder = msg.payload.workorder\ninput.enableStage = false\n\nconst changes = {\n    input,\n    workorder: {\n        lotId: '',\n        pn: '',\n        lot: '',\n        stage: ''\n    }\n}\n\nmodel.pilotRun = Object.assign(model.pilotRun, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.pilotRun',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 470,
        "y": 580,
        "wires": [
            [
                "1c425765.6b2309"
            ]
        ]
    },
    {
        "id": "7e9f57fa.8a4138",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "if (msg.topic !== 'model.pilotRun')\n{\n    return\n}\n\nconst model = global.get('model')\n\nconst enabled = model.pilotRun.state === 'INPUT'\n\nreturn [\n    {\n        enabled,\n        payload: model.pilotRun.workorder.pn\n    },\n    {\n        enabled,\n        payload: model.pilotRun.workorder.lot\n    },\n    {\n        enabled,\n        payload: model.pilotRun.workorder.lotId\n    },\n    {\n        enabled,\n        payload: model.pilotRun.workorder.stage\n    }\n]\n",
        "outputs": 4,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 920,
        "wires": [
            [
                "3a9485af.90958a"
            ],
            [
                "6b42a028.c70a3"
            ],
            [
                "8ebc5c48.36439"
            ],
            [
                "ce0da323.c0341"
            ]
        ]
    },
    {
        "id": "25c230cf.7d5c1",
        "type": "link in",
        "z": "282939f0.8d3486",
        "name": "To View",
        "links": [
            "1c425765.6b2309",
            "fae00d5b.4d7cf",
            "fe3b68d5.4d9bb8",
            "dd06c8ba.f3ede8",
            "89789973.e5e468",
            "489ba77a.50c808",
            "5996a99f.a82ad8",
            "e603e132.0cbe1",
            "a6a2f658.b55fa8",
            "774a8f54.a250b",
            "5cc58842.141918",
            "680f0250.6e2a2c",
            "e0443fff.4e35f",
            "49ed37b1.523d68",
            "5b27ed13.a3c814",
            "4abf0a7b.536ba4",
            "f4ddf088.12237",
            "e075a031.de73d",
            "b577d158.09844",
            "aa9618e3.489e98",
            "a50ccc58.1f6dd",
            "9c6f34ec.44c938",
            "8ee38a81.6bdf38",
            "b1be3310.5727e"
        ],
        "x": 155,
        "y": 920,
        "wires": [
            [
                "7e9f57fa.8a4138",
                "1843eb12.b95955"
            ]
        ]
    },
    {
        "id": "1843eb12.b95955",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "if (msg.topic !== 'model.pilotRun')\n{\n    return\n}\n\nconst model = global.get('model')\n\nconst enabled = model.pilotRun.state === 'INPUT'\n && model.pilotRun.workorder.lotId\n && model.pilotRun.workorder.pn\n && model.pilotRun.workorder.lot\n && model.pilotRun.workorder.stage\n\nreturn {\n    enabled\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 1020,
        "wires": [
            [
                "138d9785.e962b8"
            ]
        ]
    },
    {
        "id": "ba48c648.66a808",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "const operator = msg.payload\n\nreturn {\n    topic: 'pilotRun.operator',\n    payload: {\n        operator: operator\n    }\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 740,
        "y": 660,
        "wires": [
            [
                "58e75c96.95b2b4"
            ]
        ]
    },
    {
        "id": "de34b46c.6c8568",
        "type": "function",
        "z": "976482dc.415df",
        "name": "Handle operator",
        "func": "if (msg.topic !== 'pilotRun.operator')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.pilotRun.state !== 'INPUT')\n{\n    node.error('unexpected')\n    return\n}\n\nconst operator = msg.payload.operator\nlet input = model.pilotRun.input\n\ninput.operator = operator\n\nconst changes = {\n    input\n}\n\nmodel.pilotRun = Object.assign(model.pilotRun, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.pilotRun',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 420,
        "y": 320,
        "wires": [
            [
                "1c425765.6b2309"
            ]
        ]
    },
    {
        "id": "d8015c0b.b5477",
        "type": "function",
        "z": "976482dc.415df",
        "name": "Handle workorder (LC2 工單碼 4 段)",
        "func": "if (msg.topic !== 'pilotRun.workorder')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.pilotRun.state !== 'INPUT')\n{\n    node.error('unexpected')\n    return\n}\n\nconst workorder = msg.payload.workorder\n\nlet exp = /^[0-9A-Z]+;[0-9A-Z.]+;[0-9.]+&[0-9A-Z]+$/ig\n\nif (!exp.test(workorder))\n{\n    return [null, msg]\n}\n\nlet splitted = workorder.split(';')\nlet pn = splitted[0]\nlet lotId = splitted[1]\n\nsplitted = splitted[2].split('&')\nlet lot = splitted[0]\nlet stage = splitted[1]\n\nlet input = model.pilotRun.input\ninput.workorder = workorder\ninput.enableStage = false\n\nconst changes = {\n    input,\n    workorder: {\n        lotId: lotId,\n        pn: pn,\n        lot: lot,\n        stage: stage\n    }\n}\n\nmodel.pilotRun = Object.assign(model.pilotRun, changes)\nglobal.set('model', model)\n\nreturn [\n    {\n        topic: 'model.pilotRun',\n        payload: changes\n    },\n    null\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 490,
        "y": 460,
        "wires": [
            [
                "1c425765.6b2309"
            ],
            [
                "a3103a3.98f76c8"
            ]
        ]
    },
    {
        "id": "a3103a3.98f76c8",
        "type": "function",
        "z": "976482dc.415df",
        "name": "Handle workorder (工單碼 3+1 段)",
        "func": "if (msg.topic !== 'pilotRun.workorder')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.pilotRun.state !== 'INPUT')\n{\n    node.error('unexpected')\n    return\n}\n\nconst workorder = msg.payload.workorder\n\nlet exp = /^[0-9A-Z.]+\\|[0-9A-Z]+\\|[0-9]+$/ig\n\nif (!exp.test(workorder))\n{\n    return [null, msg]\n}\n\nlet splitted = workorder.split('|')\nlet lotId = splitted[0]\nlet pn = splitted[1]\nlet lot = splitted[2]\n\nlet input = model.pilotRun.input\ninput.workorder = workorder\ninput.enableStage = true\n\nconst changes = {\n    input,\n    workorder: {\n        lotId: lotId,\n        pn: pn,\n        lot: lot,\n        stage: ''\n    }\n}\n\nmodel.pilotRun = Object.assign(model.pilotRun, changes)\nglobal.set('model', model)\n\nreturn [\n    {\n        topic: 'model.pilotRun',\n        payload: changes\n    },\n    null\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 480,
        "y": 500,
        "wires": [
            [
                "1c425765.6b2309"
            ],
            [
                "2b231eff.457a02"
            ]
        ]
    },
    {
        "id": "2b231eff.457a02",
        "type": "function",
        "z": "976482dc.415df",
        "name": "Handle workorder (工單碼 4 段)",
        "func": "if (msg.topic !== 'pilotRun.workorder')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.pilotRun.state !== 'INPUT')\n{\n    node.error('unexpected')\n    return\n}\n\nconst workorder = msg.payload.workorder\n\nlet exp = /^[0-9A-Z.]+\\|[0-9A-Z]+\\|[0-9]+\\|[0-9A-Z]+$/ig\n\nif (!exp.test(workorder))\n{\n    return [null, msg]\n}\n\nlet splitted = workorder.split('|')\nlet lotId = splitted[0]\nlet pn = splitted[1]\nlet lot = splitted[2]\nlet stage = splitted[3]\n\nlet input = model.pilotRun.input\ninput.workorder = workorder\ninput.enableStage = false\n\nconst changes = {\n    input,\n    workorder: {\n        lotId: lotId,\n        pn: pn,\n        lot: lot,\n        stage: stage\n    }\n}\n\nmodel.pilotRun = Object.assign(model.pilotRun, changes)\nglobal.set('model', model)\n\nreturn [\n    {\n        topic: 'model.pilotRun',\n        payload: changes\n    },\n    null\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 470,
        "y": 540,
        "wires": [
            [
                "1c425765.6b2309"
            ],
            [
                "c15be354.f8f11"
            ]
        ]
    },
    {
        "id": "88c39661.a44c98",
        "type": "comment",
        "z": "976482dc.415df",
        "name": "工單內容",
        "info": "",
        "x": 220,
        "y": 720,
        "wires": []
    },
    {
        "id": "44e76f83.bd737",
        "type": "link out",
        "z": "282939f0.8d3486",
        "name": "To Control",
        "links": [
            "3541d990.925686",
            "52efc3ab.55ab6c",
            "7418d21.45ad22c",
            "a7975a02.8a0c88",
            "3b97a635.15979a",
            "bb7671b1.06e21",
            "b0dc5ccf.b1d62",
            "55b00947.ddc508",
            "abb166c.3e09798",
            "6d90df4e.6ef51",
            "61ea8d29.c6a4f4",
            "f45dd390.154fa",
            "d83de82b.db06e8",
            "6d610381.b62fac",
            "bc6010e1.7537c",
            "f99d52f2.f8f68",
            "d3dcc847.1cd478",
            "6b1721e5.459cc",
            "37ba1dd3.f5c012",
            "71a73452.ac13dc",
            "beee06f7.be6498",
            "a9a83c81.2306a",
            "79dbf37.1b4860c"
        ],
        "x": 915,
        "y": 1020,
        "wires": []
    },
    {
        "id": "52efc3ab.55ab6c",
        "type": "link in",
        "z": "976482dc.415df",
        "name": "To Control",
        "links": [
            "44e76f83.bd737",
            "58e75c96.95b2b4",
            "f9e43485.fec318",
            "b20ba137.be08",
            "b17c3083.dd0c8",
            "b5f7b64b.c7a248",
            "b7b6c644.b328b8",
            "a8c2a30.58b5d6",
            "672a7a09.265094",
            "418f844b.671e2c",
            "8c4b9603.e1aee8",
            "4c11d973.d583d8",
            "73ad0302.9c13ac",
            "ca153323.175d",
            "9fb81c12.c17a1",
            "3d474729.48c3b8",
            "c362751b.9d6ec8",
            "b8efe10f.b23fd",
            "d84a2899.ed42d8",
            "a3a6fb04.90f508",
            "b3f2298f.3de718",
            "cb0d22ed.50e19"
        ],
        "x": 175,
        "y": 800,
        "wires": [
            [
                "e8c0025a.11092"
            ]
        ]
    },
    {
        "id": "e8c0025a.11092",
        "type": "function",
        "z": "976482dc.415df",
        "name": "Handle confirmWorkorder",
        "func": "if (msg.topic !== 'pilotRun.confirmWorkorder')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.pilotRun.state !== 'INPUT')\n{\n    node.error('unexpected')\n    return\n}\n\nlet changes = {\n    recipe: {\n        status: 'N/A',\n        etchingSpeedSet: model.reading.etchingSpeedSet,\n        etching1UpSprayPressureSet: model.reading.etching1UpSprayPressureSet,\n        etching1DownSprayPressureSet: model.reading.etching1DownSprayPressureSet,\n        etching2SwitchSet: model.reading.etching2SwitchSet,\n        etching3SwitchSet: model.reading.etching3SwitchSet,\n        developSpeedSet: model.reading.developSpeedSet\n    }\n}\n\nmodel.pilotRun = Object.assign(model.pilotRun, changes)\nglobal.set('model', model)\n\nreturn [\n    {\n        topic: 'model.pilotRun',\n        payload: changes\n    },\n    {}\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 450,
        "y": 800,
        "wires": [
            [
                "fe3b68d5.4d9bb8"
            ],
            [
                "54fcaba5.9d18f4"
            ]
        ]
    },
    {
        "id": "4ae81823.fb11b8",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "return {\n    topic: 'pilotRun.confirmWorkorder',\n    payload: {}\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 740,
        "y": 1020,
        "wires": [
            [
                "44e76f83.bd737"
            ]
        ]
    },
    {
        "id": "1f11def9.bf34a1",
        "type": "link in",
        "z": "282939f0.8d3486",
        "name": "To View",
        "links": [
            "1c425765.6b2309",
            "fae00d5b.4d7cf",
            "fe3b68d5.4d9bb8",
            "dd06c8ba.f3ede8",
            "89789973.e5e468",
            "489ba77a.50c808",
            "5996a99f.a82ad8",
            "e603e132.0cbe1",
            "a6a2f658.b55fa8",
            "774a8f54.a250b",
            "5cc58842.141918",
            "680f0250.6e2a2c",
            "e0443fff.4e35f",
            "49ed37b1.523d68",
            "5b27ed13.a3c814",
            "4abf0a7b.536ba4",
            "f4ddf088.12237",
            "e075a031.de73d",
            "b577d158.09844",
            "aa9618e3.489e98",
            "a50ccc58.1f6dd",
            "9c6f34ec.44c938",
            "8ee38a81.6bdf38",
            "b1be3310.5727e"
        ],
        "x": 155,
        "y": 1180,
        "wires": [
            [
                "6f23e80c.2f1b18",
                "1071b552.4536fb"
            ]
        ]
    },
    {
        "id": "6f23e80c.2f1b18",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "if (msg.topic !== 'model.pilotRun')\n{\n    return\n}\n\nconst model = global.get('model')\n\nconst enabled = model.pilotRun.state === 'MES'\n\nreturn [\n    {\n        enabled,\n        payload: model.pilotRun.stageResult.status\n    },\n    {\n        enabled,\n        // payload: model.pilotRun.stageResult. // TODO\n    },\n    {\n        enabled,\n        // payload: model.pilotRun.stageResult. // TODO\n    }\n]\n",
        "outputs": 3,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 1180,
        "wires": [
            [
                "33b1daf3.0ccc26"
            ],
            [
                "670cda08.659fb4"
            ],
            [
                "6631b873.70d598"
            ]
        ]
    },
    {
        "id": "1071b552.4536fb",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "if (msg.topic !== 'model.pilotRun')\n{\n    return\n}\n\nif (msg.payload.state !== 'MES') {\n    return\n}\n\nreturn {\n    topic: 'pilotRun.mes',\n    payload: {}\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 1320,
        "wires": [
            [
                "f9e43485.fec318"
            ]
        ]
    },
    {
        "id": "f9e43485.fec318",
        "type": "link out",
        "z": "282939f0.8d3486",
        "name": "To Control",
        "links": [
            "3541d990.925686",
            "52efc3ab.55ab6c",
            "7418d21.45ad22c",
            "a7975a02.8a0c88",
            "3b97a635.15979a",
            "bb7671b1.06e21",
            "b0dc5ccf.b1d62",
            "55b00947.ddc508",
            "abb166c.3e09798",
            "6d90df4e.6ef51",
            "61ea8d29.c6a4f4",
            "f45dd390.154fa",
            "d83de82b.db06e8",
            "6d610381.b62fac",
            "bc6010e1.7537c",
            "f99d52f2.f8f68",
            "d3dcc847.1cd478",
            "6b1721e5.459cc",
            "37ba1dd3.f5c012",
            "71a73452.ac13dc",
            "beee06f7.be6498",
            "a9a83c81.2306a",
            "79dbf37.1b4860c"
        ],
        "x": 915,
        "y": 1320,
        "wires": []
    },
    {
        "id": "db691543.ed4d18",
        "type": "comment",
        "z": "976482dc.415df",
        "name": "確認站別",
        "info": "",
        "x": 220,
        "y": 1140,
        "wires": []
    },
    {
        "id": "7418d21.45ad22c",
        "type": "link in",
        "z": "976482dc.415df",
        "name": "To Control",
        "links": [
            "44e76f83.bd737",
            "58e75c96.95b2b4",
            "b20ba137.be08",
            "f9e43485.fec318",
            "b17c3083.dd0c8",
            "b5f7b64b.c7a248",
            "b7b6c644.b328b8",
            "a8c2a30.58b5d6",
            "672a7a09.265094",
            "418f844b.671e2c",
            "8c4b9603.e1aee8",
            "4c11d973.d583d8",
            "73ad0302.9c13ac",
            "ca153323.175d",
            "9fb81c12.c17a1",
            "3d474729.48c3b8",
            "c362751b.9d6ec8",
            "b8efe10f.b23fd",
            "d84a2899.ed42d8",
            "a3a6fb04.90f508",
            "b3f2298f.3de718",
            "cb0d22ed.50e19"
        ],
        "x": 175,
        "y": 1220,
        "wires": [
            [
                "2f696fa7.75069"
            ]
        ]
    },
    {
        "id": "2f696fa7.75069",
        "type": "function",
        "z": "976482dc.415df",
        "name": "Handle mes",
        "func": "if (msg.topic !== 'pilotRun.mes')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.pilotRun.state !== 'MES')\n{\n    node.error('unexpected')\n    return\n}\n\nlet stageResult = model.pilotRun.stageResult\nstageResult.status = 'REQUESTING'\n\nlet changes = {\n    stageResult\n}\n\nmodel.pilotRun = Object.assign(model.pilotRun, changes)\nglobal.set('model', model)\n\nreturn [\n    {\n        topic: 'model.pilotRun',\n        payload: changes\n    },\n    {}\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 410,
        "y": 1220,
        "wires": [
            [
                "dd06c8ba.f3ede8"
            ],
            [
                "6ac80944.3f8288"
            ]
        ]
    },
    {
        "id": "6ac80944.3f8288",
        "type": "function",
        "z": "976482dc.415df",
        "name": "",
        "func": "// TODO visit unimicron to test\n\nconst model = global.get('model')\n\nreturn {\n    payload: {\n        method: 'EPL_Check',\n\n        args: {\n            pLotid: model.pilotRun.workorder.lotId,\n            pUserID: model.env.epl.userId,\n            pPWD: model.env.epl.pwd,\n            pStage: model.pilotRun.workorder.stage,\n            pEMS_EQID: model.env.machineNo\n        }\n    }\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 400,
        "y": 1300,
        "wires": [
            [
                "a9927500.505138",
                "c9948699.321c78"
            ]
        ]
    },
    {
        "id": "a9927500.505138",
        "type": "soap",
        "z": "976482dc.415df",
        "name": "",
        "wsdlUrl": "http://10.13.66.33/ws_promis/Service.asmx?WSDL",
        "username": "",
        "password": "",
        "x": 590,
        "y": 1300,
        "wires": [
            [
                "f218d543.cc8ac8",
                "e10ea17.548b96"
            ]
        ]
    },
    {
        "id": "f218d543.cc8ac8",
        "type": "function",
        "z": "976482dc.415df",
        "name": "",
        "func": "// TODO visit unimicron to test\n\nlet changes = {}\ndo {\n    if (msg.payload.code) {\n        changes = {\n            state: 'INPUT',\n            stageResult: {\n                status: `KO ${msg.payload.code}`,\n                recipeId: null\n            }\n        }\n        break\n    }\n\n    const result = msg.payload.result\n\n    const arrived = !!result.EPL_CheckResult.PRO_EQPID\n\n    if (!arrived) {\n        changes = {\n            state: 'INPUT',\n            stageResult: {\n                status: `未到站`,\n                recipeId: null\n            }\n        }\n        break\n    }\n\n    changes = {\n        state: 'RMS',\n        stageResult: {\n            status: 'OK',\n            recipeId: result.EPL_CheckResult.RecipeId\n        }\n    }\n} while (false);\n\nlet model = global.get('model')\nmodel.pilotRun = Object.assign(model.pilotRun, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.pilotRun',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 780,
        "y": 1300,
        "wires": [
            [
                "dd06c8ba.f3ede8"
            ]
        ]
    },
    {
        "id": "a4f1f644.e130c8",
        "type": "delay",
        "z": "976482dc.415df",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 400,
        "y": 1380,
        "wires": [
            [
                "1345a59f.41fcea"
            ]
        ]
    },
    {
        "id": "1345a59f.41fcea",
        "type": "function",
        "z": "976482dc.415df",
        "name": "dummy OK",
        "func": "const changes = {\n    state: 'RMS',\n    stageResult: {\n        status: 'OK',\n        recipeId: '10VK70011CALB'\n    }\n}\n\nlet model = global.get('model')\n\nmodel.pilotRun = Object.assign(model.pilotRun, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.pilotRun',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 610,
        "y": 1380,
        "wires": [
            [
                "dd06c8ba.f3ede8"
            ]
        ]
    },
    {
        "id": "fe3b68d5.4d9bb8",
        "type": "link out",
        "z": "976482dc.415df",
        "name": "To View",
        "links": [
            "1f11def9.bf34a1",
            "25c230cf.7d5c1",
            "906e5b22.4989f8",
            "7b8c2c08.b563e4",
            "78dc8b8f.5838b4",
            "5a694f49.a6dc1",
            "9c023a.051afdc8",
            "ae422560.686178",
            "e6618bc.b92f578",
            "6022ffbc.3bfec",
            "6e7d7659.49a0c8",
            "86c694dd.0d3b58",
            "b00a14bc.49c178",
            "72b20f0d.07717",
            "7201918.9d8ef7",
            "92f89b72.0dfc58",
            "2296d51b.bb473a",
            "fb3100ee.25d73",
            "563d78f.923fb88",
            "4ed6ea6c.5812f4",
            "79ce718d.22dbf",
            "54cc6ac1.ba3754",
            "9cd75563.219f28",
            "2c4b532c.3aee0c",
            "fa88555.452f3a8",
            "fcecc3e7.5eb01",
            "bb14064e.2c38e8"
        ],
        "x": 1015,
        "y": 800,
        "wires": []
    },
    {
        "id": "dd06c8ba.f3ede8",
        "type": "link out",
        "z": "976482dc.415df",
        "name": "To View",
        "links": [
            "1f11def9.bf34a1",
            "25c230cf.7d5c1",
            "906e5b22.4989f8",
            "7b8c2c08.b563e4",
            "78dc8b8f.5838b4",
            "5a694f49.a6dc1",
            "9c023a.051afdc8",
            "ae422560.686178",
            "e6618bc.b92f578",
            "6022ffbc.3bfec",
            "6e7d7659.49a0c8",
            "86c694dd.0d3b58",
            "b00a14bc.49c178",
            "72b20f0d.07717",
            "7201918.9d8ef7",
            "92f89b72.0dfc58",
            "2296d51b.bb473a",
            "fb3100ee.25d73",
            "563d78f.923fb88",
            "4ed6ea6c.5812f4",
            "79ce718d.22dbf",
            "54cc6ac1.ba3754",
            "9cd75563.219f28",
            "2c4b532c.3aee0c",
            "fa88555.452f3a8",
            "fcecc3e7.5eb01",
            "bb14064e.2c38e8"
        ],
        "x": 1015,
        "y": 1220,
        "wires": []
    },
    {
        "id": "7b8c2c08.b563e4",
        "type": "link in",
        "z": "282939f0.8d3486",
        "name": "To View",
        "links": [
            "1c425765.6b2309",
            "dd06c8ba.f3ede8",
            "fae00d5b.4d7cf",
            "fe3b68d5.4d9bb8",
            "89789973.e5e468",
            "489ba77a.50c808",
            "5996a99f.a82ad8",
            "e603e132.0cbe1",
            "a6a2f658.b55fa8",
            "774a8f54.a250b",
            "5cc58842.141918",
            "680f0250.6e2a2c",
            "e0443fff.4e35f",
            "49ed37b1.523d68",
            "5b27ed13.a3c814",
            "4abf0a7b.536ba4",
            "f4ddf088.12237",
            "e075a031.de73d",
            "b577d158.09844",
            "aa9618e3.489e98",
            "a50ccc58.1f6dd",
            "9c6f34ec.44c938",
            "8ee38a81.6bdf38",
            "b1be3310.5727e"
        ],
        "x": 155,
        "y": 1480,
        "wires": [
            [
                "a3fbff99.d3cdd",
                "b99a7055.41f76",
                "76c6ea9a.75a6d4",
                "8b041f6c.6c438",
                "3b27f6d8.60d77a",
                "a0a28ce3.bb9fb",
                "dd11ca48.45ab98",
                "d255ae33.0ede2"
            ]
        ]
    },
    {
        "id": "a3fbff99.d3cdd",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "if (msg.topic !== 'model.pilotRun')\n{\n    return\n}\n\nconst model = global.get('model')\n\nconst enabled = model.pilotRun.state === 'RMS'\n\nreturn {\n    enabled,\n    payload: model.pilotRun.rmsResult.status\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 1480,
        "wires": [
            [
                "edc01c5a.dba7"
            ]
        ]
    },
    {
        "id": "b99a7055.41f76",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "if (msg.topic !== 'model.pilotRun')\n{\n    return\n}\n\nconst model = global.get('model')\nconst recipe = model.pilotRun.rmsResult.recipe\n\nconst enabled = model.pilotRun.state === 'RMS'\n\nreturn [\n    {\n        enabled\n    },\n    {\n        enabled,\n        payload: recipe.etching1DownSprayPressureUpper\n    },\n    {\n        enabled,\n        payload: recipe.etching1DownSprayPressureSet\n    },\n    {\n        enabled,\n        payload: recipe.etching1DownSprayPressureLower\n    },\n]\n",
        "outputs": 4,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 1700,
        "wires": [
            [
                "6a5551eb.d45e9"
            ],
            [
                "ca8da069.50853"
            ],
            [
                "9d72f27b.b7345"
            ],
            [
                "a57a4fe5.64f2"
            ]
        ]
    },
    {
        "id": "76c6ea9a.75a6d4",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "if (msg.topic !== 'model.pilotRun')\n{\n    return\n}\n\nconst model = global.get('model')\nconst recipe = model.pilotRun.rmsResult.recipe\n\nconst enabled = model.pilotRun.state === 'RMS'\n\nreturn [\n    {\n        enabled\n    },\n    {\n        enabled,\n        payload: recipe.etching2SwitchUpper\n    },\n    {\n        enabled,\n        payload: recipe.etching2SwitchSet\n    },\n    {\n        enabled,\n        payload: recipe.etching2SwitchLower\n    },\n]\n",
        "outputs": 4,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 1780,
        "wires": [
            [
                "88251c1a.aaa86"
            ],
            [
                "9ab07ea0.5d06b"
            ],
            [
                "995ca317.fa355"
            ],
            [
                "a633cd4c.17ee5"
            ]
        ]
    },
    {
        "id": "8b041f6c.6c438",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "if (msg.topic !== 'model.pilotRun')\n{\n    return\n}\n\nconst model = global.get('model')\nconst recipe = model.pilotRun.rmsResult.recipe\n\nconst enabled = model.pilotRun.state === 'RMS'\n\nreturn [\n    {\n        enabled\n    },\n    {\n        enabled,\n        payload: recipe.etching3SwitchUpper\n    },\n    {\n        enabled,\n        payload: recipe.etching3SwitchSet\n    },\n    {\n        enabled,\n        payload: recipe.etching3SwitchLower\n    },\n]\n",
        "outputs": 4,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 1860,
        "wires": [
            [
                "d9f5b088.ada5e"
            ],
            [
                "465366bd.5da678"
            ],
            [
                "4ecfb9a3.8370e8"
            ],
            [
                "1778e040.b0fe1"
            ]
        ]
    },
    {
        "id": "3b27f6d8.60d77a",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "if (msg.topic !== 'model.pilotRun')\n{\n    return\n}\n\nconst model = global.get('model')\nconst recipe = model.pilotRun.rmsResult.recipe\n\nconst enabled = model.pilotRun.state === 'RMS'\n\nreturn [\n    {\n        enabled\n    },\n    {\n        enabled,\n        payload: recipe.developSpeedUpper\n    },\n    {\n        enabled,\n        payload: recipe.developSpeedSet\n    },\n    {\n        enabled,\n        payload: recipe.developSpeedLower\n    },\n]\n",
        "outputs": 4,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 1940,
        "wires": [
            [
                "bf3a8fe6.9828f"
            ],
            [
                "60f07d0a.e52544"
            ],
            [
                "3b242dca.a23d82"
            ],
            [
                "e5ef0b7c.90fda8"
            ]
        ]
    },
    {
        "id": "a0a28ce3.bb9fb",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "if (msg.topic !== 'model.pilotRun')\n{\n    return\n}\n\nconst model = global.get('model')\nconst recipe = model.pilotRun.rmsResult.recipe\n\nconst enabled = model.pilotRun.state === 'RMS'\n\nreturn [\n    {\n        enabled\n    },\n    {\n        enabled,\n        payload: recipe.etching1UpSprayPressureUpper\n    },\n    {\n        enabled,\n        payload: recipe.etching1UpSprayPressureSet\n    },\n    {\n        enabled,\n        payload: recipe.etching1UpSprayPressureLower\n    },\n]\n",
        "outputs": 4,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 1620,
        "wires": [
            [
                "ac73aa42.a87168"
            ],
            [
                "4b98b69c.8c9308"
            ],
            [
                "7ebb1133.2241"
            ],
            [
                "a0e7fd2b.e7981"
            ]
        ]
    },
    {
        "id": "dd11ca48.45ab98",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "if (msg.topic !== 'model.pilotRun')\n{\n    return\n}\n\nconst model = global.get('model')\nconst recipe = model.pilotRun.rmsResult.recipe\n\nconst enabled = model.pilotRun.state === 'RMS'\n\nreturn [\n    {\n        enabled\n    },\n    {\n        enabled,\n        payload: recipe.etchingSpeedUpper\n    },\n    {\n        enabled,\n        payload: recipe.etchingSpeedSet\n    },\n    {\n        enabled,\n        payload: recipe.etchingSpeedLower\n    },\n]\n",
        "outputs": 4,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 1540,
        "wires": [
            [
                "cf033f28.ab584"
            ],
            [
                "d0b0bb78.efd7b8"
            ],
            [
                "cdb4623.1d1eea"
            ],
            [
                "5e616290.ec0acc"
            ]
        ]
    },
    {
        "id": "d255ae33.0ede2",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "if (msg.topic !== 'model.pilotRun')\n{\n    return\n}\n\nif (msg.payload.state !== 'RMS') {\n    return\n}\n\nreturn {\n    topic: 'pilotRun.rms',\n    payload: {}\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 2020,
        "wires": [
            [
                "b20ba137.be08"
            ]
        ]
    },
    {
        "id": "b20ba137.be08",
        "type": "link out",
        "z": "282939f0.8d3486",
        "name": "To Control",
        "links": [
            "3541d990.925686",
            "52efc3ab.55ab6c",
            "7418d21.45ad22c",
            "a7975a02.8a0c88",
            "3b97a635.15979a",
            "bb7671b1.06e21",
            "b0dc5ccf.b1d62",
            "55b00947.ddc508",
            "abb166c.3e09798",
            "6d90df4e.6ef51",
            "61ea8d29.c6a4f4",
            "f45dd390.154fa",
            "d83de82b.db06e8",
            "6d610381.b62fac",
            "bc6010e1.7537c",
            "f99d52f2.f8f68",
            "d3dcc847.1cd478",
            "6b1721e5.459cc",
            "37ba1dd3.f5c012",
            "71a73452.ac13dc",
            "beee06f7.be6498",
            "a9a83c81.2306a",
            "79dbf37.1b4860c"
        ],
        "x": 915,
        "y": 2020,
        "wires": []
    },
    {
        "id": "35c48778.516298",
        "type": "comment",
        "z": "976482dc.415df",
        "name": "取得配方上下限",
        "info": "",
        "x": 240,
        "y": 1500,
        "wires": []
    },
    {
        "id": "d313322d.56e61",
        "type": "function",
        "z": "976482dc.415df",
        "name": "Handle rms",
        "func": "if (msg.topic !== 'pilotRun.rms')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.pilotRun.state !== 'RMS')\n{\n    node.error('unexpected')\n    return\n}\n\nlet rmsResult = model.pilotRun.rmsResult\nrmsResult.status = 'REQUESTING'\n\nlet changes = {\n    rmsResult\n}\n\nmodel.pilotRun = Object.assign(model.pilotRun, changes)\n\n// let changes = {\n//     status: 'REQUESTING'\n// }\n\n// model.pilotRun.rmsResult = Object.assign(model.pilotRun.rmsResult, changes)\n// global.set('model', model)\n\nreturn [\n    {\n        topic: 'model.pilotRun',\n        payload: changes\n    },\n    {}\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 410,
        "y": 1580,
        "wires": [
            [
                "89789973.e5e468"
            ],
            [
                "1f7b350e.01b1eb"
            ]
        ]
    },
    {
        "id": "a7975a02.8a0c88",
        "type": "link in",
        "z": "976482dc.415df",
        "name": "To Control",
        "links": [
            "44e76f83.bd737",
            "58e75c96.95b2b4",
            "b20ba137.be08",
            "f9e43485.fec318",
            "b17c3083.dd0c8",
            "b5f7b64b.c7a248",
            "b7b6c644.b328b8",
            "a8c2a30.58b5d6",
            "672a7a09.265094",
            "418f844b.671e2c",
            "8c4b9603.e1aee8",
            "4c11d973.d583d8",
            "73ad0302.9c13ac",
            "ca153323.175d",
            "9fb81c12.c17a1",
            "3d474729.48c3b8",
            "c362751b.9d6ec8",
            "b8efe10f.b23fd",
            "d84a2899.ed42d8",
            "a3a6fb04.90f508",
            "b3f2298f.3de718",
            "cb0d22ed.50e19"
        ],
        "x": 175,
        "y": 1580,
        "wires": [
            [
                "d313322d.56e61"
            ]
        ]
    },
    {
        "id": "89789973.e5e468",
        "type": "link out",
        "z": "976482dc.415df",
        "name": "To View",
        "links": [
            "1f11def9.bf34a1",
            "25c230cf.7d5c1",
            "7b8c2c08.b563e4",
            "906e5b22.4989f8",
            "78dc8b8f.5838b4",
            "5a694f49.a6dc1",
            "9c023a.051afdc8",
            "ae422560.686178",
            "e6618bc.b92f578",
            "6022ffbc.3bfec",
            "6e7d7659.49a0c8",
            "86c694dd.0d3b58",
            "b00a14bc.49c178",
            "72b20f0d.07717",
            "7201918.9d8ef7",
            "92f89b72.0dfc58",
            "2296d51b.bb473a",
            "fb3100ee.25d73",
            "563d78f.923fb88",
            "4ed6ea6c.5812f4",
            "79ce718d.22dbf",
            "54cc6ac1.ba3754",
            "9cd75563.219f28",
            "2c4b532c.3aee0c",
            "fa88555.452f3a8",
            "fcecc3e7.5eb01",
            "bb14064e.2c38e8"
        ],
        "x": 1015,
        "y": 1580,
        "wires": []
    },
    {
        "id": "c8cb8050.7bca2",
        "type": "delay",
        "z": "976482dc.415df",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 400,
        "y": 1740,
        "wires": [
            [
                "d17127d7.e7ca78"
            ]
        ]
    },
    {
        "id": "d17127d7.e7ca78",
        "type": "function",
        "z": "976482dc.415df",
        "name": "dummy OK",
        "func": "const changes = {\n    state: 'RECIPE',\n    rmsResult: {\n        status: 'OK',\n        recipe: {\n            etchingSpeedUpper: 1.9,\n            etchingSpeedSet: 1.5,\n            etchingSpeedLower: 1.1,\n            etching1UpSprayPressureUpper: 2.9,\n            etching1UpSprayPressureSet: 2.5,\n            etching1UpSprayPressureLower: 2.1,\n            etching1DownSprayPressureUpper: 3.9,\n            etching1DownSprayPressureSet: 3.5,\n            etching1DownSprayPressureLower: 3.1,\n            etching2SwitchUpper: 'N/A',\n            etching2SwitchSet: 'ON',\n            etching2SwitchLower: 'N/A',\n            etching3SwitchUpper: 'N/A',\n            etching3SwitchSet: 'ON',\n            etching3SwitchLower: 'N/A',\n            developSpeedUpper: 6.9,\n            developSpeedSet: 6.5,\n            developSpeedLower: 6.1\n        }\n    }\n}\n\nlet model = global.get('model')\nmodel.pilotRun = Object.assign(model.pilotRun, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.pilotRun',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 610,
        "y": 1740,
        "wires": [
            [
                "89789973.e5e468"
            ]
        ]
    },
    {
        "id": "1f7b350e.01b1eb",
        "type": "function",
        "z": "976482dc.415df",
        "name": "",
        "func": "const model = global.get('model')\nconst machineNo = model.env.machineNo\nconst recipeId = model.pilotRun.stageResult.recipeId\n\nreturn {\n    config: {\n        query:\n`SELECT * FROM EPL_LC2.dbo.RecipeSpec\nWHERE MachineNo = '${machineNo}'\n AND RecipeName = '${recipeId}'`\n    }\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 400,
        "y": 1660,
        "wires": [
            [
                "2c2a120d.6107de"
            ]
        ]
    },
    {
        "id": "2c2a120d.6107de",
        "type": "mssql",
        "z": "976482dc.415df",
        "name": "",
        "server": "10.12.65.40",
        "port": "1433",
        "connectionTimeout": "15000",
        "requestTimeout": "15000",
        "connectionPoolSize": "1",
        "username": "datamation",
        "password": "P@ssw0rd",
        "database": "Datamation_LC2",
        "query": "",
        "x": 610,
        "y": 1660,
        "wires": [
            [
                "97589adb.60b198",
                "cb9bef38.9b83c"
            ]
        ]
    },
    {
        "id": "97589adb.60b198",
        "type": "function",
        "z": "976482dc.415df",
        "name": "",
        "func": "const payload = msg.payload\n\nlet changes = {}\nlet recipe = {\n    etchingSpeedUpper: null,\n    etchingSpeedSet: null,\n    etchingSpeedLower: null,\n    etching1UpSprayPressureUpper: null,\n    etching1UpSprayPressureSet: null,\n    etching1UpSprayPressureLower: null,\n    etching1DownSprayPressureUpper: null,\n    etching1DownSprayPressureSet: null,\n    etching1DownSprayPressureLower: null,\n    etching2SwitchUpper: null,\n    etching2SwitchSet: null,\n    etching2SwitchLower: null,\n    etching3SwitchUpper: null,\n    etching3SwitchSet: null,\n    etching3SwitchLower: null,\n    developSpeedUpper: null,\n    developSpeedSet: null,\n    developSpeedLower: null\n}\n\ndo {\n    changes = {\n        state: 'RECIPE',\n        rmsResult: {\n            status: `OK`,\n            recipe\n        }\n    }\n\n    if (payload.code)\n    {\n        changes = {\n            state: 'INPUT',\n            rmsResult: {\n                status: `KO ${payload.code}`,\n                recipe\n            }\n        }\n\n        break\n    }\n\n    const result = payload.result\n\n    if (result.length === 0)\n    {\n        changes = {\n            state: 'INPUT',\n            rmsResult: {\n                status: `KO, 配方未建立`,\n                recipe\n            }\n        }\n\n        break\n    }\n\n    for (let i = 0; i < result.length; ++i)\n    {\n        const r = result[i]\n\n        if (r.ParameterName !== '蝕刻#1 上噴' &&\n                r.ParameterName !== '蝕刻#1 下噴' &&\n                r.ParameterName !== '蝕刻速度' &&\n                r.ParameterName !== '蝕刻#2 開&關' &&\n                r.ParameterName !== '蝕刻#3 開&關' &&\n                r.ParameterName !== '顯影速度')\n        {\n            continue\n        }\n\n        const upper = parseFloat(r.UCL)\n        const setValue = parseFloat(r.Set_Value)\n        const lower = parseFloat(r.LCL)\n\n        let invalid = isNaN(setValue)\n\n        if (r.ParameterName === '蝕刻#1 上噴' ||\n                r.ParameterName === '蝕刻#1 下噴' ||\n                r.ParameterName === '蝕刻速度' ||\n                r.ParameterName === '顯影速度')\n        {\n            invalid = isNaN(upper) || isNaN(setValue) || isNaN(lower)\n        }\n\n        if (invalid)\n        {\n            changes = {\n                state: 'INPUT',\n                rmsResult: {\n                    status: `KO, parse ${r.ParameterName} error`,\n                    recipe\n                }\n            }\n\n            break\n        }\n\n        if (r.ParameterName === '蝕刻速度')\n        {\n            recipe.etchingSpeedUpper = upper\n            recipe.etchingSpeedSet = setValue\n            recipe.etchingSpeedLower = lower\n        }\n        else if (r.ParameterName === '蝕刻#1 上噴')\n        {\n            recipe.etching1UpSprayPressureUpper = upper\n            recipe.etching1UpSprayPressureSet = setValue\n            recipe.etching1UpSprayPressureLower = lower\n        }\n        else if (r.ParameterName === '蝕刻#1 下噴')\n        {\n            recipe.etching1DownSprayPressureUpper = upper\n            recipe.etching1DownSprayPressureSet = setValue\n            recipe.etching1DownSprayPressureLower = lower\n        }\n        else if (r.ParameterName === '蝕刻#2 開&關')\n        {\n            recipe.etching2SwitchUpper = 'N/A'\n            recipe.etching2SwitchSet = setValue ? 'ON' : 'OFF'\n            recipe.etching2SwitchLower = 'N/A'\n        }\n        else if (r.ParameterName === '蝕刻#3 開&關')\n        {\n            recipe.etching3SwitchUpper = 'N/A'\n            recipe.etching3SwitchSet = setValue ? 'ON' : 'OFF'\n            recipe.etching3SwitchLower = 'N/A'\n        }\n        else if (r.ParameterName === '顯影速度')\n        {\n            recipe.developSpeedUpper = upper\n            recipe.developSpeedSet = setValue\n            recipe.developSpeedLower = lower\n        }\n    }\n} while (false)\n\nlet model = global.get('model')\nmodel.pilotRun = Object.assign(model.pilotRun, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.pilotRun',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 800,
        "y": 1660,
        "wires": [
            [
                "89789973.e5e468"
            ]
        ]
    },
    {
        "id": "9946be90.f682d",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "if (msg.topic !== 'model.pilotRun')\n{\n    return\n}\n\nconst model = global.get('model')\n\nconst enabled = model.pilotRun.state === 'RECIPE'\n\nreturn {\n    enabled,\n    payload: model.pilotRun.recipe.status\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 2180,
        "wires": [
            [
                "658bd7e7.30b2d8"
            ]
        ]
    },
    {
        "id": "78dc8b8f.5838b4",
        "type": "link in",
        "z": "282939f0.8d3486",
        "name": "To View",
        "links": [
            "1c425765.6b2309",
            "89789973.e5e468",
            "dd06c8ba.f3ede8",
            "fae00d5b.4d7cf",
            "fe3b68d5.4d9bb8",
            "489ba77a.50c808",
            "5996a99f.a82ad8",
            "e603e132.0cbe1",
            "a6a2f658.b55fa8",
            "774a8f54.a250b",
            "5cc58842.141918",
            "680f0250.6e2a2c",
            "e0443fff.4e35f",
            "49ed37b1.523d68",
            "5b27ed13.a3c814",
            "4abf0a7b.536ba4",
            "f4ddf088.12237",
            "e075a031.de73d",
            "b577d158.09844",
            "aa9618e3.489e98",
            "a50ccc58.1f6dd",
            "9c6f34ec.44c938",
            "8ee38a81.6bdf38",
            "b1be3310.5727e"
        ],
        "x": 155,
        "y": 2180,
        "wires": [
            [
                "9946be90.f682d",
                "2153a795.7dd868",
                "54b0c340.75f26c",
                "1799e9b6.a6f0c6"
            ]
        ]
    },
    {
        "id": "2153a795.7dd868",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "if (msg.topic !== 'model.pilotRun')\n{\n    return\n}\n\nconst model = global.get('model')\nconst recipe = model.pilotRun.recipe\n\nconst enabled = model.pilotRun.state === 'RECIPE'\nconst fontAwesomeIcon = '<i class=\"fa fa-exclamation-circle fa-1x nr-dashboard-error\"></i>'\n\nreturn [\n    {\n        enabled,\n        payload: recipe.etchingSpeedSet\n    },\n    {\n        enabled,\n        topic: enabled ? (model.pilotRun.exceeded('etchingSpeed') ? fontAwesomeIcon : '') : ''\n    },\n    {\n        enabled,\n        payload: recipe.etching1UpSprayPressureSet\n    },\n    {\n        enabled,\n        topic: enabled ? (model.pilotRun.exceeded('etching1UpSprayPressure') ? fontAwesomeIcon : '') : ''\n    },\n    {\n        enabled,\n        payload: recipe.etching1DownSprayPressureSet\n    },\n    {\n        enabled,\n        topic: enabled ? (model.pilotRun.exceeded('etching1DownSprayPressure') ? fontAwesomeIcon : '') : ''\n    },\n    {\n        enabled,\n        payload: recipe.etching2SwitchSet\n    },\n    {\n        enabled,\n        topic: enabled ? (model.pilotRun.isSwitchSetValue(recipe.etching2SwitchSet) ? '' : fontAwesomeIcon) : ''\n    },\n    {\n        enabled,\n        payload: recipe.etching3SwitchSet\n    },\n    {\n        enabled,\n        topic: enabled ? (model.pilotRun.isSwitchSetValue(recipe.etching3SwitchSet) ? '' : fontAwesomeIcon) : ''\n    },\n    {\n        enabled,\n        payload: recipe.developSpeedSet\n    },\n    {\n        enabled,\n        topic: enabled ? (model.pilotRun.exceeded('developSpeed') ? fontAwesomeIcon : '') : ''\n    }\n]\n",
        "outputs": 12,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 2300,
        "wires": [
            [
                "eaa97b63.cfb518"
            ],
            [
                "32a2f82e.03cba8"
            ],
            [
                "bb0b3792.097a98"
            ],
            [
                "c32b2190.e6155"
            ],
            [
                "d3e32137.6e4be"
            ],
            [
                "22e7f9dc.e2e5f6"
            ],
            [
                "c62ef2c9.cfa25"
            ],
            [
                "486ecd5c.74b524"
            ],
            [
                "eb706ab8.c7e358"
            ],
            [
                "5452de5a.05d07"
            ],
            [
                "da09edf0.b1d0c"
            ],
            [
                "ff20720f.7a4eb"
            ]
        ]
    },
    {
        "id": "b17c3083.dd0c8",
        "type": "link out",
        "z": "282939f0.8d3486",
        "name": "To Control",
        "links": [
            "3541d990.925686",
            "3b97a635.15979a",
            "52efc3ab.55ab6c",
            "7418d21.45ad22c",
            "a7975a02.8a0c88",
            "bb7671b1.06e21",
            "b0dc5ccf.b1d62",
            "55b00947.ddc508",
            "abb166c.3e09798",
            "6d90df4e.6ef51",
            "61ea8d29.c6a4f4",
            "f45dd390.154fa",
            "d83de82b.db06e8",
            "6d610381.b62fac",
            "bc6010e1.7537c",
            "f99d52f2.f8f68",
            "d3dcc847.1cd478",
            "6b1721e5.459cc",
            "37ba1dd3.f5c012",
            "71a73452.ac13dc",
            "beee06f7.be6498",
            "a9a83c81.2306a",
            "79dbf37.1b4860c"
        ],
        "x": 1055,
        "y": 2480,
        "wires": []
    },
    {
        "id": "e3a075ac.be32f8",
        "type": "comment",
        "z": "976482dc.415df",
        "name": "首件配方",
        "info": "",
        "x": 220,
        "y": 1860,
        "wires": []
    },
    {
        "id": "3b97a635.15979a",
        "type": "link in",
        "z": "976482dc.415df",
        "name": "To Control",
        "links": [
            "44e76f83.bd737",
            "58e75c96.95b2b4",
            "b17c3083.dd0c8",
            "b20ba137.be08",
            "f9e43485.fec318",
            "b5f7b64b.c7a248",
            "b7b6c644.b328b8",
            "a8c2a30.58b5d6",
            "672a7a09.265094",
            "418f844b.671e2c",
            "8c4b9603.e1aee8",
            "4c11d973.d583d8",
            "73ad0302.9c13ac",
            "ca153323.175d",
            "9fb81c12.c17a1",
            "3d474729.48c3b8",
            "c362751b.9d6ec8",
            "b8efe10f.b23fd",
            "d84a2899.ed42d8",
            "a3a6fb04.90f508",
            "b3f2298f.3de718",
            "cb0d22ed.50e19"
        ],
        "x": 175,
        "y": 1940,
        "wires": [
            [
                "7e60961.574bd68",
                "fb42c9b.5da4638",
                "8b383197.c1368",
                "6d2d68fb.d8e4f8",
                "6e4394e3.3a9fec",
                "be6f46a8.725058",
                "cd07be69.d114",
                "ca54c8.a4689b38"
            ]
        ]
    },
    {
        "id": "489ba77a.50c808",
        "type": "link out",
        "z": "976482dc.415df",
        "name": "To View",
        "links": [
            "1f11def9.bf34a1",
            "25c230cf.7d5c1",
            "78dc8b8f.5838b4",
            "7b8c2c08.b563e4",
            "906e5b22.4989f8",
            "5a694f49.a6dc1",
            "9c023a.051afdc8",
            "ae422560.686178",
            "e6618bc.b92f578",
            "6022ffbc.3bfec",
            "6e7d7659.49a0c8",
            "86c694dd.0d3b58",
            "b00a14bc.49c178",
            "72b20f0d.07717",
            "7201918.9d8ef7",
            "92f89b72.0dfc58",
            "2296d51b.bb473a",
            "fb3100ee.25d73",
            "563d78f.923fb88",
            "4ed6ea6c.5812f4",
            "79ce718d.22dbf",
            "54cc6ac1.ba3754",
            "9cd75563.219f28",
            "2c4b532c.3aee0c",
            "fa88555.452f3a8",
            "fcecc3e7.5eb01",
            "bb14064e.2c38e8"
        ],
        "x": 1015,
        "y": 1940,
        "wires": []
    },
    {
        "id": "35b515e7.5b5dea",
        "type": "recipe-update",
        "z": "976482dc.415df",
        "name": "",
        "category": "pre_production",
        "x": 670,
        "y": 2280,
        "wires": [
            [
                "6f5bd601.2dd008"
            ]
        ]
    },
    {
        "id": "65b53e5e.d5d77",
        "type": "function",
        "z": "976482dc.415df",
        "name": "update recipe",
        "func": "const model = global.get('model')\n\nconst workorder = model.pilotRun.workorder\n\nif (workorder.lotId === 'DUMMYBOARDS')\n{\n    return [\n        null,\n        {}\n    ]\n}\n\nconst pn = model.pilotRun.workorder.pn\nconst lot = model.pilotRun.workorder.lot\nconst lotId = model.pilotRun.workorder.lotId\nconst stage = model.pilotRun.workorder.stage\n\nlet recipeId = pn + '|' + lot + '|' + lotId + '|' + stage\n\nconst recipe = model.pilotRun.recipe\n\nreturn [\n    {\n        payload: {\n            id: recipeId,\n            ingredients: {\n                etching_speed: recipe.etchingSpeedSet,\n                etching_1_up_spray_pressure: recipe.etching1UpSprayPressureSet,\n                etching_1_down_spray_pressure: recipe.etching1DownSprayPressureSet,\n                etching_2_switch: recipe.etching2SwitchSet,\n                etching_3_switch: recipe.etching3SwitchSet,\n                develop_speed: recipe.developSpeedSet\n            }\n        }\n    },\n    null\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 420,
        "y": 2280,
        "wires": [
            [
                "35b515e7.5b5dea"
            ],
            [
                "32cedacc.429ef6"
            ]
        ]
    },
    {
        "id": "6f5bd601.2dd008",
        "type": "function",
        "z": "976482dc.415df",
        "name": "",
        "func": "let changes = {}\nlet model = global.get('model')\n\nlet recipe = model.pilotRun.recipe\n\nif (msg.payload.code)\n{\n    recipe.status = `KO RMS ${msg.payload.code}`\n\n    changes = {\n        recipe\n    }\n\n    model.pilotRun = Object.assign(model.pilotRun, changes)\n    global.set('model', model)\n\n    return [\n        {\n            topic: 'model.pilotRun',\n            payload: changes\n        },\n        null\n    ]\n}\n\nreturn [\n    null,\n    {}\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 900,
        "y": 2280,
        "wires": [
            [
                "489ba77a.50c808"
            ],
            [
                "32cedacc.429ef6"
            ]
        ]
    },
    {
        "id": "32cedacc.429ef6",
        "type": "function",
        "z": "976482dc.415df",
        "name": "ready to write",
        "func": "const DATE_STRING = global.get('DATE_STRING')\nlet model = global.get('model')\n\nconst recipe = model.pilotRun.recipe\nconst input = model.pilotRun.input\nconst workorder = model.pilotRun.workorder\n\nlet changes = {\n    status: 'READY',\n    etchingSpeedSet: recipe.etchingSpeedSet,\n    etching1UpSprayPressureSet: recipe.etching1UpSprayPressureSet,\n    etching1DownSprayPressureSet: recipe.etching1DownSprayPressureSet,\n    etching2SwitchSet: recipe.etching2SwitchSet,\n    etching3SwitchSet: recipe.etching3SwitchSet,\n    developSpeedSet: recipe.developSpeedSet,\n    workorder: input.workorder,\n    lotId: workorder.lotId,\n    pn: workorder.pn,\n    lot: workorder.lot,\n    stage: workorder.stage,\n    recipeTimestamp: DATE_STRING(new Date()),\n    workorderTimestamp: DATE_STRING(new Date())\n}\n\nmodel.pendingRecipe = Object.assign(model.pendingRecipe, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.pendingRecipe',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 920,
        "y": 2340,
        "wires": [
            [
                "489ba77a.50c808",
                "f729b0d.b33025"
            ]
        ]
    },
    {
        "id": "7d0633c7.fb1e1c",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "if (msg.topic !== 'model.pendingRecipe')\n{\n    return\n}\n\nconst model = global.get('model')\n\nreturn {\n    payload: model.pendingRecipe.status\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 2740,
        "wires": [
            [
                "d591e9e1.5b7da8"
            ]
        ]
    },
    {
        "id": "5a694f49.a6dc1",
        "type": "link in",
        "z": "282939f0.8d3486",
        "name": "To View",
        "links": [
            "1c425765.6b2309",
            "489ba77a.50c808",
            "5996a99f.a82ad8",
            "89789973.e5e468",
            "dd06c8ba.f3ede8",
            "fae00d5b.4d7cf",
            "fe3b68d5.4d9bb8",
            "e603e132.0cbe1",
            "a6a2f658.b55fa8",
            "774a8f54.a250b",
            "5cc58842.141918",
            "680f0250.6e2a2c",
            "e0443fff.4e35f",
            "49ed37b1.523d68",
            "5b27ed13.a3c814",
            "4abf0a7b.536ba4",
            "f4ddf088.12237",
            "e075a031.de73d",
            "b577d158.09844",
            "aa9618e3.489e98",
            "a50ccc58.1f6dd",
            "9c6f34ec.44c938",
            "8ee38a81.6bdf38",
            "b1be3310.5727e"
        ],
        "x": 155,
        "y": 2740,
        "wires": [
            [
                "7d0633c7.fb1e1c",
                "e62b05a9.f79818",
                "9901af8f.8fccf",
                "5c92605f.2d78f",
                "c727c595.a56698"
            ]
        ]
    },
    {
        "id": "f729b0d.b33025",
        "type": "function",
        "z": "976482dc.415df",
        "name": "",
        "func": "let model = global.get('model')\nlet recipe = model.pilotRun.recipe\n\nrecipe.status = 'OK'\n\nlet changes = {\n    recipe\n}\n\nmodel.pilotRun = Object.assign(model.pilotRun, changes)\n\nreturn {\n    topic: 'model.pilotRun',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 900,
        "y": 2420,
        "wires": [
            [
                "489ba77a.50c808",
                "464d7bc.af34d84"
            ]
        ]
    },
    {
        "id": "e62b05a9.f79818",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "if (msg.topic !== 'model.pendingRecipe')\n{\n    return\n}\n\nconst model = global.get('model')\nconst pendingRecipe = model.pendingRecipe\n\nif (pendingRecipe.status === 'OK')\n{\n    return\n}\n\nreturn [\n    {\n        payload: pendingRecipe.etchingSpeedSet\n    },\n    {\n        payload: pendingRecipe.etching1UpSprayPressureSet\n    },\n    {\n        payload: pendingRecipe.etching1DownSprayPressureSet\n    },\n    {\n        payload: pendingRecipe.etching2SwitchSet\n    },\n    {\n        payload: pendingRecipe.etching3SwitchSet\n    },\n    {\n        payload: pendingRecipe.developSpeedSet\n    },\n    {\n        payload: pendingRecipe.workorder\n    }\n]\n",
        "outputs": 7,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 2820,
        "wires": [
            [
                "5ccfe01.6cce02"
            ],
            [
                "76e87833.0db1e8"
            ],
            [
                "d4c3df4f.f9fe"
            ],
            [
                "295ef717.c0a398"
            ],
            [
                "a5c28eb1.19edc"
            ],
            [
                "13528740.8a1f69"
            ],
            [
                "a1d0e5c4.1446d8"
            ]
        ]
    },
    {
        "id": "9901af8f.8fccf",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "if (msg.topic !== 'model.pendingRecipe')\n{\n    return\n}\n\nconst model = global.get('model')\nconst pendingRecipe = model.pendingRecipe\n\nconst enabled = pendingRecipe.status === 'READY'\n  && pendingRecipe.etchingSpeedSet\n  && pendingRecipe.etching1UpSprayPressureSet\n  && pendingRecipe.etching1DownSprayPressureSet\n  && pendingRecipe.etching2SwitchSet\n  && pendingRecipe.etching3SwitchSet\n  && pendingRecipe.developSpeedSet\n\nreturn {\n    enabled\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 3100,
        "wires": [
            [
                "11915014.35bfc"
            ]
        ]
    },
    {
        "id": "cdf52054.1596",
        "type": "reading-in",
        "z": "c8d83dd6.129da",
        "name": "",
        "equipmentId": "A21DFPDES001",
        "categorizedReadingRequired": false,
        "channelNamesRequired": false,
        "x": 210,
        "y": 260,
        "wires": [
            [
                "17047691.9088a9"
            ]
        ]
    },
    {
        "id": "17047691.9088a9",
        "type": "function",
        "z": "c8d83dd6.129da",
        "name": "model.reading",
        "func": "const payload = msg.payload\n\nlet reading = {\n    at: msg.payload.at,\n\n    etchingSpeedSet: payload.reading.D152,\n    etching1UpSprayPressureSet: payload.reading.D162,\n    etching1DownSprayPressureSet: payload.reading.D172,\n    etching2SwitchSet: payload.reading.L1759 ? 'ON' : 'OFF',\n    etching3SwitchSet: payload.reading.L1758 ? 'ON' : 'OFF',\n    developSpeedSet: payload.reading.D122,\n\n    eSlot: payload.reading.D712 !== 0 ? '送料中' : '空線',\n    boardStatus: payload.reading.D712 === 0 ? 'OK' : `倒數 ${payload.reading.D712} 秒`\n}\n\nconst changes = {\n    reading\n}\n\nlet model = global.get('model')\nmodel = Object.assign(model, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.reading',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 460,
        "y": 260,
        "wires": [
            [
                "fae00d5b.4d7cf"
            ]
        ]
    },
    {
        "id": "10697a11.6621f6",
        "type": "delay",
        "z": "976482dc.415df",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 400,
        "y": 1440,
        "wires": [
            [
                "f185c88d.47c4a8"
            ]
        ]
    },
    {
        "id": "f185c88d.47c4a8",
        "type": "function",
        "z": "976482dc.415df",
        "name": "dummy KO",
        "func": "const changes = {\n    state: 'INPUT',\n    stageResult: {\n        status: 'KO',\n        recipeId: null\n    }\n}\n\nlet model = global.get('model')\n\nmodel.pilotRun = Object.assign(model.pilotRun, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.pilotRun',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 610,
        "y": 1440,
        "wires": [
            [
                "dd06c8ba.f3ede8"
            ]
        ]
    },
    {
        "id": "a8393e6f.c56ff",
        "type": "function",
        "z": "976482dc.415df",
        "name": "dummy KO",
        "func": "const changes = {\n    state: 'INPUT',\n    rmsResult: {\n        status: 'KO',\n        recipe: {\n            etchingSpeedUpper: null,\n            etchingSpeedSet: null,\n            etchingSpeedLower: null,\n            etching1UpSprayPressureUpper: null,\n            etching1UpSprayPressureSet: null,\n            etching1UpSprayPressureLower: null,\n            etching1DownSprayPressureUpper: null,\n            etching1DownSprayPressureSet: null,\n            etching1DownSprayPressureLower: null,\n            etching2SwitchUpper: null,\n            etching2SwitchSet: null,\n            etching2SwitchLower: null,\n            etching3SwitchUpper: null,\n            etching3SwitchSet: null,\n            etching3SwitchLower: null,\n            developSpeedUpper: null,\n            developSpeedSet: null,\n            developSpeedLower: null\n        }\n    }\n}\n\nlet model = global.get('model')\nmodel.pilotRun = Object.assign(model.pilotRun, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.pilotRun',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 610,
        "y": 1780,
        "wires": [
            [
                "89789973.e5e468"
            ]
        ]
    },
    {
        "id": "aaa5b8fb.74dce8",
        "type": "delay",
        "z": "976482dc.415df",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 400,
        "y": 1780,
        "wires": [
            [
                "a8393e6f.c56ff"
            ]
        ]
    },
    {
        "id": "32a2f82e.03cba8",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "4355f279.d7b5bc",
        "order": 4,
        "width": "1",
        "height": "1",
        "name": "蝕刻速度超標",
        "label": "{{msg.topic}}",
        "format": "",
        "layout": "row-spread",
        "x": 720,
        "y": 2220,
        "wires": []
    },
    {
        "id": "c32b2190.e6155",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "4355f279.d7b5bc",
        "order": 6,
        "width": "1",
        "height": "1",
        "name": "蝕刻1上噴超標",
        "label": "{{msg.topic}}",
        "format": "",
        "layout": "row-spread",
        "x": 720,
        "y": 2260,
        "wires": []
    },
    {
        "id": "22e7f9dc.e2e5f6",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "4355f279.d7b5bc",
        "order": 8,
        "width": "1",
        "height": "1",
        "name": "蝕刻1下噴超標",
        "label": "{{msg.topic}}",
        "format": "",
        "layout": "row-spread",
        "x": 720,
        "y": 2300,
        "wires": []
    },
    {
        "id": "486ecd5c.74b524",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "4355f279.d7b5bc",
        "order": 10,
        "width": "1",
        "height": "1",
        "name": "蝕刻2開關超標",
        "label": "{{msg.topic}}",
        "format": "",
        "layout": "row-spread",
        "x": 720,
        "y": 2340,
        "wires": []
    },
    {
        "id": "5452de5a.05d07",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "4355f279.d7b5bc",
        "order": 12,
        "width": "1",
        "height": "1",
        "name": "蝕刻3開關超標",
        "label": "{{msg.topic}}",
        "format": "",
        "layout": "row-spread",
        "x": 720,
        "y": 2380,
        "wires": []
    },
    {
        "id": "ff20720f.7a4eb",
        "type": "ui_text",
        "z": "282939f0.8d3486",
        "group": "4355f279.d7b5bc",
        "order": 14,
        "width": "1",
        "height": "1",
        "name": "顯影速度超標",
        "label": "{{msg.topic}}",
        "format": "",
        "layout": "row-spread",
        "x": 720,
        "y": 2420,
        "wires": []
    },
    {
        "id": "e874781.9639788",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "const etchingSpeedSet = msg.payload\n\nreturn {\n    topic: 'pilotRun.etchingSpeedSet',\n    payload: {\n        etchingSpeedSet\n    }\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 900,
        "y": 2220,
        "wires": [
            [
                "b17c3083.dd0c8"
            ]
        ]
    },
    {
        "id": "470a372c.a67ba8",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "const etching1UpSprayPressureSet = msg.payload\n\nreturn {\n    topic: 'pilotRun.etching1UpSprayPressureSet',\n    payload: {\n        etching1UpSprayPressureSet\n    }\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 900,
        "y": 2260,
        "wires": [
            [
                "b17c3083.dd0c8"
            ]
        ]
    },
    {
        "id": "524a4608.b22bb8",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "const etching1DownSprayPressureSet = msg.payload\n\nreturn {\n    topic: 'pilotRun.etching1DownSprayPressureSet',\n    payload: {\n        etching1DownSprayPressureSet\n    }\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 900,
        "y": 2300,
        "wires": [
            [
                "b17c3083.dd0c8"
            ]
        ]
    },
    {
        "id": "1d5f04b.55d0afb",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "const etching2SwitchSet = msg.payload\n\nreturn {\n    topic: 'pilotRun.etching2SwitchSet',\n    payload: {\n        etching2SwitchSet\n    }\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 900,
        "y": 2340,
        "wires": [
            [
                "b17c3083.dd0c8"
            ]
        ]
    },
    {
        "id": "3551d436.53c05c",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "const etching3SwitchSet = msg.payload\n\nreturn {\n    topic: 'pilotRun.etching3SwitchSet',\n    payload: {\n        etching3SwitchSet\n    }\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 900,
        "y": 2380,
        "wires": [
            [
                "b17c3083.dd0c8"
            ]
        ]
    },
    {
        "id": "e58800d4.eb77d",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "const developSpeedSet = msg.payload\n\nreturn {\n    topic: 'pilotRun.developSpeedSet',\n    payload: {\n        developSpeedSet\n    }\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 900,
        "y": 2420,
        "wires": [
            [
                "b17c3083.dd0c8"
            ]
        ]
    },
    {
        "id": "54b0c340.75f26c",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "if (msg.topic !== 'model.pilotRun' &&\n        msg.topic !== 'model.pendingRecipe')\n{\n    return\n}\n\nconst model = global.get('model')\n\nconst recipe = model.pilotRun.recipe\nconst pendingRecipe = model.pendingRecipe\n\nconst enabled = model.pilotRun.state === 'RECIPE'\n  && recipe.etchingSpeedSet\n  && recipe.etching1UpSprayPressureSet\n  && recipe.etching1DownSprayPressureSet\n  && recipe.etching2SwitchSet\n  && recipe.etching3SwitchSet\n  && recipe.developSpeedSet\n  && !model.pilotRun.exceeded('etchingSpeed')\n  && !model.pilotRun.exceeded('etching1UpSprayPressure')\n  && !model.pilotRun.exceeded('etching1DownSprayPressure')\n  && model.pilotRun.isSwitchSetValue(recipe.etching2SwitchSet)\n  && model.pilotRun.isSwitchSetValue(recipe.etching3SwitchSet)\n  && !model.pilotRun.exceeded('developSpeed')\n  && !pendingRecipe.etchingSpeedSet\n  && !pendingRecipe.etching1UpSprayPressureSet\n  && !pendingRecipe.etching1DownSprayPressureSet\n  && !pendingRecipe.etching2SwitchSet\n  && !pendingRecipe.etching3SwitchSet\n  && !pendingRecipe.developSpeedSet\n\nconst workorder = model.pilotRun.workorder\n\nconst topic = workorder.lotId === 'DUMMYBOARDS' ? '寫入' : '儲存並寫入'\n\nreturn {\n    topic,\n    enabled\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 2480,
        "wires": [
            [
                "4aa6c5a6.1d20bc"
            ]
        ]
    },
    {
        "id": "9e73e03b.bfc23",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "return {\n    topic: 'pilotRun.save',\n    payload: {}\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 740,
        "y": 2480,
        "wires": [
            [
                "b17c3083.dd0c8"
            ]
        ]
    },
    {
        "id": "7e60961.574bd68",
        "type": "function",
        "z": "976482dc.415df",
        "name": "Handle etchingSpeedSet",
        "func": "if (msg.topic !== 'pilotRun.etchingSpeedSet')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.pilotRun.state !== 'RECIPE')\n{\n    return\n}\n\nconst etchingSpeedSet = msg.payload.etchingSpeedSet\nlet recipe = model.pilotRun.recipe\n\nrecipe.etchingSpeedSet = etchingSpeedSet\n\nconst changes = {\n    recipe\n}\n\nmodel.pilotRun = Object.assign(model.pilotRun, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.pilotRun',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 450,
        "y": 1940,
        "wires": [
            [
                "489ba77a.50c808"
            ]
        ]
    },
    {
        "id": "fb42c9b.5da4638",
        "type": "function",
        "z": "976482dc.415df",
        "name": "Handle etching1UpSprayPressureSet",
        "func": "if (msg.topic !== 'pilotRun.etching1UpSprayPressureSet')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.pilotRun.state !== 'RECIPE')\n{\n    return\n}\n\nconst etching1UpSprayPressureSet = msg.payload.etching1UpSprayPressureSet\nlet recipe = model.pilotRun.recipe\n\nrecipe.etching1UpSprayPressureSet = etching1UpSprayPressureSet\n\nconst changes = {\n    recipe\n}\n\nmodel.pilotRun = Object.assign(model.pilotRun, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.pilotRun',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 490,
        "y": 1980,
        "wires": [
            [
                "489ba77a.50c808"
            ]
        ]
    },
    {
        "id": "8b383197.c1368",
        "type": "function",
        "z": "976482dc.415df",
        "name": "Handle etching1DownSprayPressureSet",
        "func": "if (msg.topic !== 'pilotRun.etching1DownSprayPressureSet')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.pilotRun.state !== 'RECIPE')\n{\n    return\n}\n\nconst etching1DownSprayPressureSet = msg.payload.etching1DownSprayPressureSet\nlet recipe = model.pilotRun.recipe\n\nrecipe.etching1DownSprayPressureSet = etching1DownSprayPressureSet\n\nconst changes = {\n    recipe\n}\n\nmodel.pilotRun = Object.assign(model.pilotRun, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.pilotRun',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 500,
        "y": 2020,
        "wires": [
            [
                "489ba77a.50c808"
            ]
        ]
    },
    {
        "id": "6d2d68fb.d8e4f8",
        "type": "function",
        "z": "976482dc.415df",
        "name": "Handle etching2SwitchSet",
        "func": "if (msg.topic !== 'pilotRun.etching2SwitchSet')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.pilotRun.state !== 'RECIPE')\n{\n    return\n}\n\nconst etching2SwitchSet = msg.payload.etching2SwitchSet\nlet recipe = model.pilotRun.recipe\n\nrecipe.etching2SwitchSet = etching2SwitchSet\n\nconst changes = {\n    recipe\n}\n\nmodel.pilotRun = Object.assign(model.pilotRun, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.pilotRun',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 450,
        "y": 2060,
        "wires": [
            [
                "489ba77a.50c808"
            ]
        ]
    },
    {
        "id": "6e4394e3.3a9fec",
        "type": "function",
        "z": "976482dc.415df",
        "name": "Handle etching3SwitchSet",
        "func": "if (msg.topic !== 'pilotRun.etching3SwitchSet')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.pilotRun.state !== 'RECIPE')\n{\n    return\n}\n\nconst etching3SwitchSet = msg.payload.etching3SwitchSet\nlet recipe = model.pilotRun.recipe\n\nrecipe.etching3SwitchSet = etching3SwitchSet\n\nconst changes = {\n    recipe\n}\n\nmodel.pilotRun = Object.assign(model.pilotRun, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.pilotRun',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 450,
        "y": 2100,
        "wires": [
            [
                "489ba77a.50c808"
            ]
        ]
    },
    {
        "id": "be6f46a8.725058",
        "type": "function",
        "z": "976482dc.415df",
        "name": "Handle developSpeedSet",
        "func": "if (msg.topic !== 'pilotRun.developSpeedSet')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.pilotRun.state !== 'RECIPE')\n{\n    return\n}\n\nconst developSpeedSet = msg.payload.developSpeedSet\nlet recipe = model.pilotRun.recipe\n\nrecipe.developSpeedSet = developSpeedSet\n\nconst changes = {\n    recipe\n}\n\nmodel.pilotRun = Object.assign(model.pilotRun, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.pilotRun',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 450,
        "y": 2140,
        "wires": [
            [
                "489ba77a.50c808"
            ]
        ]
    },
    {
        "id": "cd07be69.d114",
        "type": "function",
        "z": "976482dc.415df",
        "name": "Handle save",
        "func": "if (msg.topic !== 'pilotRun.save')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.pilotRun.state !== 'RECIPE')\n{\n    node.error('unexpected')\n    return\n}\n\nreturn {}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 410,
        "y": 2200,
        "wires": [
            [
                "65b53e5e.d5d77"
            ]
        ]
    },
    {
        "id": "54fcaba5.9d18f4",
        "type": "function",
        "z": "976482dc.415df",
        "name": "query recipe",
        "func": "const model = global.get('model')\nconst workorder = model.pilotRun.input.workorder\n\nconst pn = model.pilotRun.workorder.pn\nconst stage = model.pilotRun.workorder.stage\n\nqueryString = pn + '|%|%|' + stage\n\nmsg.config = {\n    filter: [\n        {\n            id: {\n                like: queryString\n            }\n        }\n    ]\n}\n\nreturn msg\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 410,
        "y": 880,
        "wires": [
            [
                "271ce2d2.c3796e"
            ]
        ]
    },
    {
        "id": "271ce2d2.c3796e",
        "type": "recipe-query",
        "z": "976482dc.415df",
        "name": "",
        "category": "production",
        "filter": "[]",
        "filterType": "json",
        "sortBy": "[]",
        "sortByType": "json",
        "maxResults": "",
        "x": 650,
        "y": 880,
        "wires": [
            [
                "2a8f4e81.ac2f12"
            ]
        ]
    },
    {
        "id": "2a8f4e81.ac2f12",
        "type": "function",
        "z": "976482dc.415df",
        "name": "",
        "func": "const payload = msg.payload\n\nif (payload.length === 0)\n{\n    return [\n        null,\n        {}\n    ]\n}\n\nreturn [\n    msg,\n    null\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 860,
        "y": 880,
        "wires": [
            [
                "ee1d162d.837b08"
            ],
            [
                "b11c48c0.3c23d8"
            ]
        ]
    },
    {
        "id": "f2891dfd.e7b8a",
        "type": "function",
        "z": "976482dc.415df",
        "name": "recipe history path",
        "func": "const index = msg.readList[0]\n\nmsg.config = {\n    path: `/api/v1/categories/production/recipes/${index}/history`\n}\n\nreturn msg\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 430,
        "y": 980,
        "wires": [
            [
                "b3940fab.3708d"
            ]
        ]
    },
    {
        "id": "b3940fab.3708d",
        "type": "rms-api",
        "z": "976482dc.415df",
        "name": "",
        "method": "GET",
        "path": "",
        "x": 600,
        "y": 940,
        "wires": [
            [
                "3eae7538.66792a"
            ]
        ]
    },
    {
        "id": "e269e870.31dfa8",
        "type": "function",
        "z": "976482dc.415df",
        "name": "production history",
        "func": "const history = msg.history\n\nconst DATE_STRING = global.get('DATE_STRING')\nlet model = global.get('model')\nlet productionHistory = []\n\nconst length = history.length >= 10 ? 10 : history.length\nfor (let i = 0; i < length; ++i)\n{\n    const ingredients = history[i].ingredients\n    const updated = history[i].updated\n\n    productionHistory.push(\n        {\n            at: DATE_STRING(updated.at * 1000),\n            etchingSpeedSet: ingredients.etching_speed,\n            etching1UpSprayPressureSet: ingredients.etching_1_up_spray_pressure,\n            etching1DownSprayPressureSet: ingredients.etching_1_down_spray_pressure,\n            etching2SwitchSet: ingredients.etching_2_switch,\n            etching3SwitchSet: ingredients.etching_3_switch,\n            developSpeedSet: ingredients.develop_speed\n        }\n    )\n}\n\nconst changes = {\n    productionHistory\n}\n\nmodel.pilotRun = Object.assign(model.pilotRun, changes)\n\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.pilotRun',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 810,
        "y": 1000,
        "wires": [
            [
                "b11c48c0.3c23d8",
                "fe3b68d5.4d9bb8"
            ]
        ]
    },
    {
        "id": "b11c48c0.3c23d8",
        "type": "function",
        "z": "976482dc.415df",
        "name": "change state",
        "func": "let model = global.get('model')\n\nlet changes = {\n    state: 'MES'\n}\n\nconst workorder = model.pilotRun.workorder\nif (workorder.lotId === 'BYPASSBOARDS' || workorder.lotId === 'DUMMYBOARDS')\n{\n    changes.state = 'RECIPE'\n}\n\nmodel.pilotRun = Object.assign(model.pilotRun, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.pilotRun',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1010,
        "y": 1000,
        "wires": [
            [
                "fe3b68d5.4d9bb8"
            ]
        ]
    },
    {
        "id": "bf3c02f1.37f6f",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "if (msg.topic !== 'model.pilotRun')\n{\n    return\n}\n\nconst model = global.get('model')\n\nconst enabled = model.pilotRun.state === 'RECIPE'\n\nreturn {\n    enabled,\n    payload: model.pilotRun.productionHistory\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 320,
        "wires": [
            [
                "4d491436.aab4dc"
            ]
        ]
    },
    {
        "id": "ae422560.686178",
        "type": "link in",
        "z": "282939f0.8d3486",
        "name": "To View",
        "links": [
            "1c425765.6b2309",
            "489ba77a.50c808",
            "89789973.e5e468",
            "dd06c8ba.f3ede8",
            "fae00d5b.4d7cf",
            "fe3b68d5.4d9bb8",
            "5996a99f.a82ad8",
            "e603e132.0cbe1",
            "a6a2f658.b55fa8",
            "774a8f54.a250b",
            "5cc58842.141918",
            "680f0250.6e2a2c",
            "e0443fff.4e35f",
            "49ed37b1.523d68",
            "5b27ed13.a3c814",
            "4abf0a7b.536ba4",
            "f4ddf088.12237",
            "e075a031.de73d",
            "b577d158.09844",
            "aa9618e3.489e98",
            "a50ccc58.1f6dd",
            "9c6f34ec.44c938",
            "8ee38a81.6bdf38",
            "b1be3310.5727e"
        ],
        "x": 155,
        "y": 320,
        "wires": [
            [
                "bf3c02f1.37f6f"
            ]
        ]
    },
    {
        "id": "e6618bc.b92f578",
        "type": "link in",
        "z": "282939f0.8d3486",
        "name": "To view",
        "links": [
            "1c425765.6b2309",
            "489ba77a.50c808",
            "89789973.e5e468",
            "dd06c8ba.f3ede8",
            "fae00d5b.4d7cf",
            "fe3b68d5.4d9bb8",
            "5996a99f.a82ad8",
            "e603e132.0cbe1",
            "a6a2f658.b55fa8",
            "774a8f54.a250b",
            "5cc58842.141918",
            "680f0250.6e2a2c",
            "e0443fff.4e35f",
            "49ed37b1.523d68",
            "5b27ed13.a3c814",
            "4abf0a7b.536ba4",
            "f4ddf088.12237",
            "e075a031.de73d",
            "b577d158.09844",
            "aa9618e3.489e98",
            "a50ccc58.1f6dd",
            "9c6f34ec.44c938",
            "8ee38a81.6bdf38",
            "b1be3310.5727e"
        ],
        "x": 155,
        "y": 460,
        "wires": [
            [
                "dec1117d.ef4bd"
            ]
        ]
    },
    {
        "id": "dec1117d.ef4bd",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "if (msg.topic !== 'model.reading')\n{\n    return\n}\n\nconst model = global.get('model')\n\nreturn [\n    {\n        payload: model.reading.boardStatus\n    },\n    {\n        payload: model.reading.eSlot\n    }\n]",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 460,
        "wires": [
            [
                "50821772.d4b818"
            ],
            [
                "3bfec1c7.f26aae"
            ]
        ]
    },
    {
        "id": "5c92605f.2d78f",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "if (msg.topic !== 'model.reading')\n{\n    return\n}\n\nconst model = global.get('model')\n\nif (typeof msg.payload.reading === 'undefined')\n{\n    return\n}\n\nreturn {\n    topic: 'reading',\n    payload: model.reading\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 3160,
        "wires": [
            [
                "b5f7b64b.c7a248"
            ]
        ]
    },
    {
        "id": "b5f7b64b.c7a248",
        "type": "link out",
        "z": "282939f0.8d3486",
        "name": "To Control",
        "links": [
            "3541d990.925686",
            "3b97a635.15979a",
            "52efc3ab.55ab6c",
            "7418d21.45ad22c",
            "a7975a02.8a0c88",
            "bb7671b1.06e21",
            "b0dc5ccf.b1d62",
            "55b00947.ddc508",
            "abb166c.3e09798",
            "6d90df4e.6ef51",
            "61ea8d29.c6a4f4",
            "f45dd390.154fa",
            "d83de82b.db06e8",
            "6d610381.b62fac",
            "bc6010e1.7537c",
            "f99d52f2.f8f68",
            "d3dcc847.1cd478",
            "6b1721e5.459cc",
            "37ba1dd3.f5c012",
            "71a73452.ac13dc",
            "beee06f7.be6498",
            "a9a83c81.2306a",
            "79dbf37.1b4860c"
        ],
        "x": 975,
        "y": 3160,
        "wires": []
    },
    {
        "id": "bb7671b1.06e21",
        "type": "link in",
        "z": "e0b73c3e.34741",
        "name": "To Control",
        "links": [
            "44e76f83.bd737",
            "58e75c96.95b2b4",
            "b17c3083.dd0c8",
            "b20ba137.be08",
            "b5f7b64b.c7a248",
            "f9e43485.fec318",
            "b7b6c644.b328b8",
            "a8c2a30.58b5d6",
            "672a7a09.265094",
            "418f844b.671e2c",
            "8c4b9603.e1aee8",
            "4c11d973.d583d8",
            "73ad0302.9c13ac",
            "ca153323.175d",
            "9fb81c12.c17a1",
            "3d474729.48c3b8",
            "c362751b.9d6ec8",
            "b8efe10f.b23fd",
            "d84a2899.ed42d8",
            "a3a6fb04.90f508",
            "b3f2298f.3de718",
            "cb0d22ed.50e19"
        ],
        "x": 155,
        "y": 340,
        "wires": [
            [
                "58070182.e7536",
                "958ef28f.e20e",
                "12936faa.4558b",
                "bc4f14cc.f09938"
            ]
        ]
    },
    {
        "id": "5996a99f.a82ad8",
        "type": "link out",
        "z": "e0b73c3e.34741",
        "name": "To View",
        "links": [
            "1f11def9.bf34a1",
            "25c230cf.7d5c1",
            "5a694f49.a6dc1",
            "78dc8b8f.5838b4",
            "7b8c2c08.b563e4",
            "906e5b22.4989f8",
            "ae422560.686178",
            "e6618bc.b92f578",
            "6022ffbc.3bfec",
            "6e7d7659.49a0c8",
            "86c694dd.0d3b58",
            "b00a14bc.49c178",
            "72b20f0d.07717",
            "7201918.9d8ef7",
            "92f89b72.0dfc58",
            "2296d51b.bb473a",
            "fb3100ee.25d73",
            "563d78f.923fb88",
            "4ed6ea6c.5812f4",
            "79ce718d.22dbf",
            "54cc6ac1.ba3754",
            "9cd75563.219f28",
            "2c4b532c.3aee0c",
            "fa88555.452f3a8",
            "fcecc3e7.5eb01",
            "bb14064e.2c38e8"
        ],
        "x": 1055,
        "y": 300,
        "wires": []
    },
    {
        "id": "58070182.e7536",
        "type": "function",
        "z": "e0b73c3e.34741",
        "name": "Handle reading",
        "func": "if (msg.topic !== 'reading')\n{\n    return\n}\n\nlet model = global.get('model')\n\nconst pendingRecipe = model.pendingRecipe\n\nconst etchingSpeedSet = pendingRecipe.etchingSpeedSet\nconst etching1UpSprayPressureSet = pendingRecipe.etching1UpSprayPressureSet\nconst etching1DownSprayPressureSet = pendingRecipe.etching1DownSprayPressureSet\nconst etching2SwitchSet = pendingRecipe.etching2SwitchSet\nconst etching3SwitchSet = pendingRecipe.etching3SwitchSet\nconst developSpeedSet = pendingRecipe.developSpeedSet\n\nif (etchingSpeedSet &&\n    etching1UpSprayPressureSet &&\n    etching1DownSprayPressureSet &&\n    etching2SwitchSet &&\n    etching3SwitchSet &&\n    developSpeedSet)\n{\n    const changes = {\n        status: 'READY'\n    }\n\n    model.pendingRecipe = Object.assign(model.pendingRecipe, changes)\n    global.set('model', model)\n\n    return [\n        {\n            topic: 'model.pendingRecipe',\n            payload: changes\n        },\n        msg\n    ]\n}\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 360,
        "y": 460,
        "wires": [
            [
                "5996a99f.a82ad8"
            ],
            [
                "f7d901da.19ec6"
            ]
        ]
    },
    {
        "id": "f7d901da.19ec6",
        "type": "function",
        "z": "e0b73c3e.34741",
        "name": "write recipe",
        "func": "const model = global.get('model')\n\nconst eSlot = model.reading.eSlot\nif (eSlot !== '空線')\n{\n    return\n}\n\nconst pendingRecipe = model.pendingRecipe\n\nreturn {\n    payload: {\n        D122: pendingRecipe.developSpeedSet,\n        D152: pendingRecipe.etchingSpeedSet,\n        D162: pendingRecipe.etching1UpSprayPressureSet,\n        D172: pendingRecipe.etching1DownSprayPressureSet,\n        L1759: pendingRecipe.etching2SwitchSet === 'ON' ? 1 : 0,\n        L1758: pendingRecipe.etching3SwitchSet === 'ON' ? 1 : 0\n    }\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 350,
        "y": 540,
        "wires": [
            [
                "de56b3f7.ca59d"
            ]
        ]
    },
    {
        "id": "de56b3f7.ca59d",
        "type": "control-out",
        "z": "e0b73c3e.34741",
        "name": "",
        "equipmentId": "A21DFPDES001",
        "x": 350,
        "y": 600,
        "wires": [
            [
                "ebcf9dd5.ee6f6"
            ]
        ]
    },
    {
        "id": "ebcf9dd5.ee6f6",
        "type": "function",
        "z": "e0b73c3e.34741",
        "name": "OK",
        "func": "const DATE_STRING = global.get('DATE_STRING')\n\nif (msg.payload.code === 0)\n{\n    const changes = {\n        status: 'OK',\n        etchingSpeedSet: '',\n        etching1UpSprayPressureSet: '',\n        etching1DownSprayPressureSet: '',\n        etching2SwitchSet: '',\n        etching3SwitchSet: '',\n        developSpeedSet: '',\n        workorder: '',\n        recipeTimestamp: DATE_STRING(new Date())\n    }\n\n    let model = global.get('model')\n    model.pendingRecipe = Object.assign(model.pendingRecipe, changes)\n    global.set('model', model)\n\n    return [\n        {\n            topic: 'model.pendingRecipe',\n            payload: changes\n        },\n        null\n    ]\n}\n\nreturn [\n    null,\n    msg\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 550,
        "y": 600,
        "wires": [
            [
                "5996a99f.a82ad8",
                "2322f868.b24578"
            ],
            [
                "9ea3b4c3.d91458"
            ]
        ]
    },
    {
        "id": "e452059c.5e2388",
        "type": "delay",
        "z": "e0b73c3e.34741",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 360,
        "y": 700,
        "wires": [
            [
                "b0136630.a81248"
            ]
        ]
    },
    {
        "id": "b0136630.a81248",
        "type": "function",
        "z": "e0b73c3e.34741",
        "name": "dummy OK",
        "func": "const DATE_STRING = global.get('DATE_STRING')\n\nconst changes = {\n    status: 'OK',\n    etchingSpeedSet: '',\n    etching1UpSprayPressureSet: '',\n    etching1DownSprayPressureSet: '',\n    etching2SwitchSet: '',\n    etching3SwitchSet: '',\n    developSpeedSet: '',\n    workorder: '',\n    recipeTimestamp: DATE_STRING(new Date())\n}\n\nlet model = global.get('model')\nmodel.pendingRecipe = Object.assign(model.pendingRecipe, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.pendingRecipe',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 570,
        "y": 700,
        "wires": [
            [
                "5996a99f.a82ad8",
                "2322f868.b24578"
            ]
        ]
    },
    {
        "id": "a53cc28.a3f4c4",
        "type": "inject",
        "z": "c8d83dd6.129da",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 260,
        "y": 340,
        "wires": [
            [
                "20ccdca3.409e44"
            ]
        ]
    },
    {
        "id": "20ccdca3.409e44",
        "type": "function",
        "z": "c8d83dd6.129da",
        "name": "dummy reading 空線",
        "func": "let reading = {\n    at: new Date(),\n\n    etchingSpeedSet: 1.3,\n    etching1UpSprayPressureSet: 2.3,\n    etching1DownSprayPressureSet: 3.3,\n    etching2SwitchSet: 'ON',\n    etching3SwitchSet: 'OFF',\n    developSpeedSet: 6.3,\n\n    eSlot: '空線',\n    boardStatus: 'OK'\n}\n\nconst changes = {\n    reading\n}\n\nlet model = global.get('model')\nmodel = Object.assign(model, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.reading',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 480,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "738e1468.202aac",
        "type": "function",
        "z": "c8d83dd6.129da",
        "name": "dummy reading 送料中",
        "func": "let reading = {\n    at: new Date(),\n\n    etchingSpeedSet: 1.3,\n    etching1UpSprayPressureSet: 2.3,\n    etching1DownSprayPressureSet: 3.3,\n    etching2SwitchSet: 'ON',\n    etching3SwitchSet: 'OFF',\n    developSpeedSet: 6.3,\n\n    eSlot: '送料中',\n    boardStatus: '倒數 5 秒'\n}\n\nconst changes = {\n    reading\n}\n\nlet model = global.get('model')\nmodel = Object.assign(model, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.reading',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 480,
        "y": 380,
        "wires": [
            []
        ]
    },
    {
        "id": "9e9b7d92.8aefd",
        "type": "inject",
        "z": "c8d83dd6.129da",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "2",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 270,
        "y": 380,
        "wires": [
            [
                "738e1468.202aac"
            ]
        ]
    },
    {
        "id": "7c8fa0ae.4daa4",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "return {\n    topic: 'pilotRun.clear',\n    payload: {}\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 680,
        "y": 3100,
        "wires": [
            [
                "b5f7b64b.c7a248"
            ]
        ]
    },
    {
        "id": "958ef28f.e20e",
        "type": "function",
        "z": "e0b73c3e.34741",
        "name": "Handle pilotRun.clear",
        "func": "if (msg.topic !== 'pilotRun.clear') {\n    return\n}\n\nreturn {}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 380,
        "y": 280,
        "wires": [
            [
                "d23476e.7acef88"
            ]
        ]
    },
    {
        "id": "d2077db0.ae027",
        "type": "function",
        "z": "976482dc.415df",
        "name": "clean",
        "func": "const changes = {\n    state: 'INPUT',\n\n    input: {\n        operator: '',\n        workorder: '',\n        enableStage: false\n    },\n    workorder: {\n        lotId: '',\n        pn: '',\n        lot: '',\n        stage: ''\n    },\n    productionHistory: [],\n    stageResult: {\n        status: 'N/A',\n        recipeId: null,\n        // TODO 當前站別\n        // TODO 預期站別\n    },\n    rmsResult: {\n        status: 'N/A',\n        recipe: {\n            etchingSpeedUpper: '',\n            etchingSpeedSet: '',\n            etchingSpeedLower: '',\n            etching1UpSprayPressureUpper: '',\n            etching1UpSprayPressureSet: '',\n            etching1UpSprayPressureLower: '',\n            etching1DownSprayPressureUpper: '',\n            etching1DownSprayPressureSet: '',\n            etching1DownSprayPressureLower: '',\n            etching2SwitchUpper: '',\n            etching2SwitchSet: '',\n            etching2SwitchLower: '',\n            etching3SwitchUpper: '',\n            etching3SwitchSet: '',\n            etching3SwitchLower: '',\n            developSpeedUpper: '',\n            developSpeedSet: '',\n            developSpeedLower: ''\n        }\n    },\n    recipe: {\n        status: 'N/A',\n        etchingSpeedSet: '',\n        etching1UpSprayPressureSet: '',\n        etching1DownSprayPressureSet: '',\n        etching2SwitchSet: '',\n        etching3SwitchSet: '',\n        developSpeedSet: ''\n    }\n}\n\nlet model = global.get('model')\nmodel.pilotRun = Object.assign(model.pilotRun, changes)\nglobal.set('model', model)\n\nreturn [[\n    {\n        topic: 'model.pilotRun',\n        payload: model\n    }\n]]\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 890,
        "y": 2540,
        "wires": [
            [
                "489ba77a.50c808"
            ]
        ]
    },
    {
        "id": "464d7bc.af34d84",
        "type": "delay",
        "z": "976482dc.415df",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 900,
        "y": 2480,
        "wires": [
            [
                "d2077db0.ae027"
            ]
        ]
    },
    {
        "id": "b8d3bc24.52db1",
        "type": "ui_button",
        "z": "282939f0.8d3486",
        "name": "",
        "group": "4355f279.d7b5bc",
        "order": 15,
        "width": "2",
        "height": "1",
        "passthru": false,
        "label": "取消",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 510,
        "y": 2560,
        "wires": [
            [
                "4e28baf.04bf444"
            ]
        ]
    },
    {
        "id": "1799e9b6.a6f0c6",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "if (msg.topic !== 'model.pilotRun')\n{\n    return\n}\n\nconst model = global.get('model')\n\nconst enabled = model.pilotRun.state === 'RECIPE'\n\nreturn {\n    enabled\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 2560,
        "wires": [
            [
                "b8d3bc24.52db1"
            ]
        ]
    },
    {
        "id": "ca54c8.a4689b38",
        "type": "function",
        "z": "976482dc.415df",
        "name": "Handle cancel",
        "func": "if (msg.topic !== 'pilotRun.cancel')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.pilotRun.state !== 'RECIPE')\n{\n    node.error('unexpected')\n    return\n}\n\nreturn {}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 420,
        "y": 2540,
        "wires": [
            [
                "d2077db0.ae027"
            ]
        ]
    },
    {
        "id": "4e28baf.04bf444",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "return {\n    topic: 'pilotRun.cancel',\n    payload: {}\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 740,
        "y": 2560,
        "wires": [
            [
                "b17c3083.dd0c8"
            ]
        ]
    },
    {
        "id": "2322f868.b24578",
        "type": "delay",
        "z": "e0b73c3e.34741",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 780,
        "y": 600,
        "wires": [
            [
                "2b6f04ad.6ad51c"
            ]
        ]
    },
    {
        "id": "2b6f04ad.6ad51c",
        "type": "function",
        "z": "e0b73c3e.34741",
        "name": "clean",
        "func": "const changes = {\n    status: 'N/A',\n    etchingSpeedSet: '',\n    etching1UpSprayPressureSet: '',\n    etching1DownSprayPressureSet: '',\n    etching2SwitchSet: '',\n    etching3SwitchSet: '',\n    developSpeedSet: '',\n\n    workorder: ''\n}\n\nlet model = global.get('model')\nmodel.pendingRecipe = Object.assign(model.pendingRecipe, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.pendingRecipe',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 970,
        "y": 600,
        "wires": [
            [
                "5996a99f.a82ad8"
            ]
        ]
    },
    {
        "id": "9ea3b4c3.d91458",
        "type": "function",
        "z": "e0b73c3e.34741",
        "name": "KO",
        "func": "let changes = {\n    status: `KO, ${msg.payload.message}`\n}\n\nlet model = global.get('model')\nmodel.pendingRecipe = Object.assign(model.pendingRecipe, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.pendingRecipe',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 550,
        "y": 640,
        "wires": [
            [
                "5996a99f.a82ad8"
            ]
        ]
    },
    {
        "id": "e8e61891.d9afe8",
        "type": "function",
        "z": "e0b73c3e.34741",
        "name": "dummy KO",
        "func": "let changes = {\n    status: `KO, ${msg.payload.message}`\n}\n\nlet model = global.get('model')\nmodel.pendingRecipe = Object.assign(model.pendingRecipe, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.pendingRecipe',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 570,
        "y": 740,
        "wires": [
            [
                "5996a99f.a82ad8"
            ]
        ]
    },
    {
        "id": "ee1d162d.837b08",
        "type": "function",
        "z": "976482dc.415df",
        "name": "gen readList",
        "func": "const payload = msg.payload\nlet readList = []\n\npayload.forEach(item => {\n    readList.push(item.index)\n})\n\nmsg.readList = readList\n\nreturn msg\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 410,
        "y": 940,
        "wires": [
            [
                "f2891dfd.e7b8a"
            ]
        ]
    },
    {
        "id": "3eae7538.66792a",
        "type": "function",
        "z": "976482dc.415df",
        "name": "sort",
        "func": "const payload = msg.payload\n\nlet history = context.get('history')\nif (history === undefined)\n{\n    history = []\n}\n\nhistory = history.concat(payload)\ncontext.set('history', history)\n\nlet readList = msg.readList\nreadList.shift()\n\nif (readList.length !== 0)\n{\n    msg.readList = readList\n\n    return [\n        null,\n        msg\n    ]\n}\n\nhistory.sort((a, b) => (a.updated.at < b.updated.at) ? 1 : -1)\n\ncontext.set('history', undefined)\n\nmsg.history = history\n\nreturn [\n    msg,\n    null\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 770,
        "y": 940,
        "wires": [
            [
                "e269e870.31dfa8"
            ],
            [
                "f2891dfd.e7b8a"
            ]
        ]
    },
    {
        "id": "5c775b21.038174",
        "type": "comment",
        "z": "976482dc.415df",
        "name": "initialize",
        "info": "",
        "x": 210,
        "y": 80,
        "wires": []
    },
    {
        "id": "b0dc5ccf.b1d62",
        "type": "link in",
        "z": "976482dc.415df",
        "name": "To Control",
        "links": [
            "44e76f83.bd737",
            "58e75c96.95b2b4",
            "b17c3083.dd0c8",
            "b20ba137.be08",
            "b5f7b64b.c7a248",
            "b7b6c644.b328b8",
            "f9e43485.fec318",
            "a8c2a30.58b5d6",
            "672a7a09.265094",
            "418f844b.671e2c",
            "8c4b9603.e1aee8",
            "4c11d973.d583d8",
            "73ad0302.9c13ac",
            "ca153323.175d",
            "9fb81c12.c17a1",
            "3d474729.48c3b8",
            "c362751b.9d6ec8",
            "b8efe10f.b23fd",
            "d84a2899.ed42d8",
            "a3a6fb04.90f508",
            "b3f2298f.3de718",
            "cb0d22ed.50e19"
        ],
        "x": 175,
        "y": 160,
        "wires": [
            [
                "ce1359ba.47a078"
            ]
        ]
    },
    {
        "id": "ce1359ba.47a078",
        "type": "function",
        "z": "976482dc.415df",
        "name": "Handle initialize",
        "func": "if (msg.topic !== 'initialize')\n{\n    return\n}\n\nconst changes = {\n    state: 'INPUT',\n\n    input: {\n        operator: '',\n        workorder: '',\n        enableStage: false\n    },\n    workorder: {\n        lotId: '',\n        pn: '',\n        lot: '',\n        stage: ''\n    },\n    productionHistory: [],\n    stageResult: {\n        status: 'N/A',\n        recipeId: null,\n        // TODO 當前站別\n        // TODO 預期站別\n    },\n    rmsResult: {\n        status: 'N/A',\n        recipe: {\n            etchingSpeedUpper: '',\n            etchingSpeedSet: '',\n            etchingSpeedLower: '',\n            etching1UpSprayPressureUpper: '',\n            etching1UpSprayPressureSet: '',\n            etching1UpSprayPressureLower: '',\n            etching1DownSprayPressureUpper: '',\n            etching1DownSprayPressureSet: '',\n            etching1DownSprayPressureLower: '',\n            etching2SwitchUpper: '',\n            etching2SwitchSet: '',\n            etching2SwitchLower: '',\n            etching3SwitchUpper: '',\n            etching3SwitchSet: '',\n            etching3SwitchLower: '',\n            developSpeedUpper: '',\n            developSpeedSet: '',\n            developSpeedLower: ''\n        }\n    },\n    recipe: {\n        status: 'N/A',\n        etchingSpeedSet: '',\n        etching1UpSprayPressureSet: '',\n        etching1DownSprayPressureSet: '',\n        etching2SwitchSet: '',\n        etching3SwitchSet: '',\n        developSpeedSet: ''\n    }\n}\n\nlet model = global.get('model')\nmodel.pilotRun = Object.assign(model.pilotRun, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.pilotRun',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 420,
        "y": 160,
        "wires": [
            [
                "e603e132.0cbe1"
            ]
        ]
    },
    {
        "id": "e603e132.0cbe1",
        "type": "link out",
        "z": "976482dc.415df",
        "name": "To View",
        "links": [
            "1f11def9.bf34a1",
            "25c230cf.7d5c1",
            "5a694f49.a6dc1",
            "6022ffbc.3bfec",
            "78dc8b8f.5838b4",
            "7b8c2c08.b563e4",
            "906e5b22.4989f8",
            "ae422560.686178",
            "e6618bc.b92f578",
            "6e7d7659.49a0c8",
            "86c694dd.0d3b58",
            "b00a14bc.49c178",
            "72b20f0d.07717",
            "7201918.9d8ef7",
            "92f89b72.0dfc58",
            "2296d51b.bb473a",
            "fb3100ee.25d73",
            "563d78f.923fb88",
            "4ed6ea6c.5812f4",
            "79ce718d.22dbf",
            "54cc6ac1.ba3754",
            "9cd75563.219f28",
            "2c4b532c.3aee0c",
            "fa88555.452f3a8",
            "fcecc3e7.5eb01",
            "bb14064e.2c38e8"
        ],
        "x": 1015,
        "y": 160,
        "wires": []
    },
    {
        "id": "167b53c4.6c0acc",
        "type": "ui_text_input",
        "z": "e7333943.c4bbc8",
        "name": "",
        "label": "生產人員編號",
        "tooltip": "",
        "group": "ac37d3a3.8412",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "mode": "text",
        "delay": 300,
        "topic": "topic",
        "topicType": "msg",
        "x": 540,
        "y": 220,
        "wires": [
            [
                "b2cf4bb9.5ad4c8"
            ]
        ]
    },
    {
        "id": "32addf5d.a56de",
        "type": "ui_text_input",
        "z": "e7333943.c4bbc8",
        "name": "",
        "label": "工單碼",
        "tooltip": "",
        "group": "ac37d3a3.8412",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": true,
        "mode": "text",
        "delay": 300,
        "topic": "topic",
        "topicType": "msg",
        "x": 510,
        "y": 260,
        "wires": [
            [
                "2086b4ae.be1c4c"
            ]
        ]
    },
    {
        "id": "1ec332ed.a038ad",
        "type": "ui_text_input",
        "z": "e7333943.c4bbc8",
        "name": "",
        "label": "層別",
        "tooltip": "",
        "group": "ac37d3a3.8412",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": true,
        "mode": "text",
        "delay": 300,
        "topic": "topic",
        "topicType": "msg",
        "x": 510,
        "y": 300,
        "wires": [
            [
                "963d49e.95100b8"
            ]
        ]
    },
    {
        "id": "c3916ba9.724b08",
        "type": "comment",
        "z": "e7333943.c4bbc8",
        "name": "輸入",
        "info": "",
        "x": 190,
        "y": 160,
        "wires": []
    },
    {
        "id": "8e0f968b.62fa18",
        "type": "comment",
        "z": "e7333943.c4bbc8",
        "name": "工單內容",
        "info": "",
        "x": 200,
        "y": 460,
        "wires": []
    },
    {
        "id": "d60525d.78f28d8",
        "type": "ui_text",
        "z": "e7333943.c4bbc8",
        "group": "7f5cf29a.43516c",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "料號 (PN)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 520,
        "y": 520,
        "wires": []
    },
    {
        "id": "8366a1c3.dcb2c",
        "type": "ui_text",
        "z": "e7333943.c4bbc8",
        "group": "7f5cf29a.43516c",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "批號 (Lot)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 520,
        "y": 560,
        "wires": []
    },
    {
        "id": "a14a2a5e.f7f398",
        "type": "ui_text",
        "z": "e7333943.c4bbc8",
        "group": "7f5cf29a.43516c",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "工令 (Lot ID)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 530,
        "y": 600,
        "wires": []
    },
    {
        "id": "81f96548.2a0658",
        "type": "ui_text",
        "z": "e7333943.c4bbc8",
        "group": "7f5cf29a.43516c",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "層別 (Stage)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 530,
        "y": 640,
        "wires": []
    },
    {
        "id": "98380cc0.23e71",
        "type": "ui_button",
        "z": "e7333943.c4bbc8",
        "name": "",
        "group": "7f5cf29a.43516c",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "確定",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 510,
        "y": 680,
        "wires": [
            [
                "849b2882.51e958"
            ]
        ]
    },
    {
        "id": "33488412.cede3c",
        "type": "comment",
        "z": "e7333943.c4bbc8",
        "name": "首件配方",
        "info": "",
        "x": 200,
        "y": 780,
        "wires": []
    },
    {
        "id": "d84c886a.b86d48",
        "type": "ui_text",
        "z": "e7333943.c4bbc8",
        "group": "631fbc7b.c62c04",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "蝕刻速度",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 520,
        "y": 900,
        "wires": []
    },
    {
        "id": "16cf0fed.c969",
        "type": "ui_text",
        "z": "e7333943.c4bbc8",
        "group": "631fbc7b.c62c04",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "蝕刻1上噴",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 530,
        "y": 940,
        "wires": []
    },
    {
        "id": "66f2f151.7b303",
        "type": "ui_text",
        "z": "e7333943.c4bbc8",
        "group": "631fbc7b.c62c04",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "蝕刻1下噴",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 530,
        "y": 980,
        "wires": []
    },
    {
        "id": "1d5d7dcb.81b952",
        "type": "ui_text",
        "z": "e7333943.c4bbc8",
        "group": "631fbc7b.c62c04",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "蝕刻2開關",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 530,
        "y": 1020,
        "wires": []
    },
    {
        "id": "6597adcc.f03c54",
        "type": "ui_text",
        "z": "e7333943.c4bbc8",
        "group": "631fbc7b.c62c04",
        "order": 6,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "蝕刻3開關",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 530,
        "y": 1060,
        "wires": []
    },
    {
        "id": "7781a61f.1f1318",
        "type": "ui_text",
        "z": "e7333943.c4bbc8",
        "group": "631fbc7b.c62c04",
        "order": 7,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "顯影速度",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 520,
        "y": 1100,
        "wires": []
    },
    {
        "id": "be6d4233.45627",
        "type": "ui_text",
        "z": "e7333943.c4bbc8",
        "group": "631fbc7b.c62c04",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "狀態",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "x": 510,
        "y": 860,
        "wires": []
    },
    {
        "id": "67be85c8.478b3c",
        "type": "comment",
        "z": "e0b73c3e.34741",
        "name": "initialize",
        "info": "",
        "x": 190,
        "y": 60,
        "wires": []
    },
    {
        "id": "1be220dd.8d5adf",
        "type": "function",
        "z": "e0b73c3e.34741",
        "name": "Handle initialize",
        "func": "if (msg.topic !== 'initialize')\n{\n    return\n}\n\nconst changes = {\n    status: 'N/A',\n    etchingSpeedSet: '',\n    etching1UpSprayPressureSet: '',\n    etching1DownSprayPressureSet: '',\n    etching2SwitchSet: '',\n    etching3SwitchSet: '',\n    developSpeedSet: '',\n    workorder: '',\n    lotId: '',\n    pn: '',\n    lot: '',\n    stage: '',\n    recipeTimestamp: '',\n    workorderTimestamp: ''\n}\n\nlet model = global.get('model')\nmodel.pendingRecipe = Object.assign(model.pendingRecipe, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.pendingRecipe',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 360,
        "y": 120,
        "wires": [
            [
                "a6a2f658.b55fa8"
            ]
        ]
    },
    {
        "id": "59e0b76c.0b8018",
        "type": "inject",
        "z": "f941175c.d563d8",
        "name": "Bootstrap",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "0.1",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 180,
        "y": 240,
        "wires": [
            [
                "7e127447.064eac"
            ]
        ]
    },
    {
        "id": "6a37cc80.543114",
        "type": "function",
        "z": "f941175c.d563d8",
        "name": "Bootstrap",
        "func": "let model = {\n    env: {\n        machineNo: '21DFPDES001',\n        epl: {\n            userId: 'w37104',\n            pwd: '37104'\n        },\n        qrcodeBasePath: '/node-red-1'\n    },\n    reading: {\n        at: null,\n\n        etchingSpeedSet: null,\n        etching1UpSprayPressureSet: null,\n        etching1DownSprayPressureSet: null,\n        etching2SwitchSet: null,\n        etching3SwitchSet: null,\n        developSpeedSet: null,\n\n        eSlot: null,\n        boardStatus: null\n    },\n    pendingRecipe: {},\n    pilotRun: {\n        exceeded: function(channel)\n        {\n            const recipe = this.rmsResult.recipe\n            const setValue = this.recipe[channel + 'Set']\n\n            const upper = recipe[channel + 'Upper']\n            const lower = recipe[channel + 'Lower']\n\n            if (!upper || !lower) // BYPASS or DUMMY\n            {\n                return false\n            }\n\n            return setValue > upper || setValue < lower\n        },\n\n        isSwitchSetValue: function(value)\n        {\n            return value === 'ON' || value === 'OFF'\n        }\n    },\n    productionWorkorder: {},\n    production: {},\n    loader: {}\n}\n\nglobal.set('model', model)\n\nreturn {\n    topic: 'model',\n    payload: model\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 500,
        "y": 240,
        "wires": [
            [
                "3767a60a.2a222a"
            ]
        ]
    },
    {
        "id": "3767a60a.2a222a",
        "type": "function",
        "z": "f941175c.d563d8",
        "name": "Initialize",
        "func": "return {\n    topic: 'initialize',\n    payload: {}\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 680,
        "y": 240,
        "wires": [
            [
                "a8c2a30.58b5d6"
            ]
        ]
    },
    {
        "id": "7e127447.064eac",
        "type": "function",
        "z": "f941175c.d563d8",
        "name": "utility",
        "func": "global.set('DATE_STRING', date_string)\n\nreturn msg\n\n\nfunction date_string(from)\n{\n    const date = new Date(from)\n\n    let y = date.getFullYear()\n    let m = date.getMonth() + 1\n    let d = date.getDate()\n    let h = date.getHours()\n    let min = date.getMinutes()\n    let s = date.getSeconds()\n\n    const z = (num, places) => String(num).padStart(places, '0')\n\n    return `${y}-${z(m, 2)}-${z(d, 2)} ${z(h, 2)}:${z(min, 2)}:${z(s, 2)}`\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 330,
        "y": 240,
        "wires": [
            [
                "6a37cc80.543114"
            ]
        ]
    },
    {
        "id": "a8c2a30.58b5d6",
        "type": "link out",
        "z": "f941175c.d563d8",
        "name": "To Control",
        "links": [
            "3541d990.925686",
            "3b97a635.15979a",
            "52efc3ab.55ab6c",
            "7418d21.45ad22c",
            "a7975a02.8a0c88",
            "abb166c.3e09798",
            "b0dc5ccf.b1d62",
            "bb7671b1.06e21",
            "55b00947.ddc508",
            "6d90df4e.6ef51",
            "61ea8d29.c6a4f4",
            "f45dd390.154fa",
            "d83de82b.db06e8",
            "6d610381.b62fac",
            "bc6010e1.7537c",
            "f99d52f2.f8f68",
            "d3dcc847.1cd478",
            "6b1721e5.459cc",
            "37ba1dd3.f5c012",
            "71a73452.ac13dc",
            "beee06f7.be6498",
            "a9a83c81.2306a",
            "79dbf37.1b4860c"
        ],
        "x": 835,
        "y": 240,
        "wires": []
    },
    {
        "id": "abb166c.3e09798",
        "type": "link in",
        "z": "e0b73c3e.34741",
        "name": "To Control",
        "links": [
            "44e76f83.bd737",
            "58e75c96.95b2b4",
            "672a7a09.265094",
            "a8c2a30.58b5d6",
            "b17c3083.dd0c8",
            "b20ba137.be08",
            "b5f7b64b.c7a248",
            "f9e43485.fec318",
            "418f844b.671e2c",
            "8c4b9603.e1aee8",
            "4c11d973.d583d8",
            "73ad0302.9c13ac",
            "ca153323.175d",
            "9fb81c12.c17a1",
            "3d474729.48c3b8",
            "c362751b.9d6ec8",
            "b8efe10f.b23fd",
            "d84a2899.ed42d8",
            "a3a6fb04.90f508",
            "b3f2298f.3de718",
            "cb0d22ed.50e19"
        ],
        "x": 155,
        "y": 120,
        "wires": [
            [
                "1be220dd.8d5adf"
            ]
        ]
    },
    {
        "id": "a6a2f658.b55fa8",
        "type": "link out",
        "z": "e0b73c3e.34741",
        "name": "To View",
        "links": [
            "1f11def9.bf34a1",
            "25c230cf.7d5c1",
            "5a694f49.a6dc1",
            "6022ffbc.3bfec",
            "78dc8b8f.5838b4",
            "7b8c2c08.b563e4",
            "906e5b22.4989f8",
            "ae422560.686178",
            "e6618bc.b92f578",
            "6e7d7659.49a0c8",
            "86c694dd.0d3b58",
            "b00a14bc.49c178",
            "72b20f0d.07717",
            "7201918.9d8ef7",
            "92f89b72.0dfc58",
            "2296d51b.bb473a",
            "fb3100ee.25d73",
            "563d78f.923fb88",
            "4ed6ea6c.5812f4",
            "79ce718d.22dbf",
            "54cc6ac1.ba3754",
            "9cd75563.219f28",
            "2c4b532c.3aee0c",
            "fa88555.452f3a8",
            "fcecc3e7.5eb01",
            "bb14064e.2c38e8"
        ],
        "x": 615,
        "y": 120,
        "wires": []
    },
    {
        "id": "c727c595.a56698",
        "type": "function",
        "z": "282939f0.8d3486",
        "name": "",
        "func": "if (msg.topic !== 'model.pendingRecipe')\n{\n    return\n}\n\nconst model = global.get('model')\n\nreturn {\n    payload: model.pendingRecipe.recipeTimestamp\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 3060,
        "wires": [
            [
                "56f55ca2.0599b4"
            ]
        ]
    },
    {
        "id": "735c0754.e7a878",
        "type": "ui_text",
        "z": "e7333943.c4bbc8",
        "group": "631fbc7b.c62c04",
        "order": 8,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "時間",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 510,
        "y": 1140,
        "wires": []
    },
    {
        "id": "a34bb66d.d4e2d8",
        "type": "comment",
        "z": "e7333943.c4bbc8",
        "name": "量產條碼",
        "info": "",
        "x": 200,
        "y": 1880,
        "wires": []
    },
    {
        "id": "cbebfe22.4fbf1",
        "type": "ui_text",
        "z": "e7333943.c4bbc8",
        "group": "6ac1c94a.e8c9c8",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "量產工單碼",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "x": 530,
        "y": 1960,
        "wires": []
    },
    {
        "id": "8259bc74.45f58",
        "type": "ui_button",
        "z": "e7333943.c4bbc8",
        "name": "",
        "group": "6ac1c94a.e8c9c8",
        "order": 2,
        "width": "3",
        "height": "1",
        "passthru": false,
        "label": "儲存",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 510,
        "y": 2000,
        "wires": [
            [
                "4e1647c0.bd4c98"
            ]
        ]
    },
    {
        "id": "28d9ad2b.3a2b42",
        "type": "ui_text",
        "z": "e7333943.c4bbc8",
        "group": "6ac1c94a.e8c9c8",
        "order": 3,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "狀態",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "x": 510,
        "y": 2040,
        "wires": []
    },
    {
        "id": "483af3ef.f3940c",
        "type": "ui_button",
        "z": "e7333943.c4bbc8",
        "name": "",
        "group": "6ac1c94a.e8c9c8",
        "order": 4,
        "width": "3",
        "height": "1",
        "passthru": false,
        "label": "列印條碼",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 520,
        "y": 2080,
        "wires": [
            [
                "d3191417.9cb048"
            ]
        ]
    },
    {
        "id": "e999053f.6ebb38",
        "type": "ui_text",
        "z": "e7333943.c4bbc8",
        "group": "6ac1c94a.e8c9c8",
        "order": 5,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "狀態",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "x": 510,
        "y": 2120,
        "wires": []
    },
    {
        "id": "4bafd6de.35834",
        "type": "ui_template",
        "z": "e7333943.c4bbc8",
        "group": "6ac1c94a.e8c9c8",
        "name": "QR條碼",
        "order": 6,
        "width": "4",
        "height": "5",
        "format": "<p>量產條碼</p>\n<img src= {{msg.payload}} alt='Not Available'/>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "x": 520,
        "y": 2160,
        "wires": [
            []
        ]
    },
    {
        "id": "454e2a1a.7d22d4",
        "type": "comment",
        "z": "e2d46b65.8c3d28",
        "name": "initialize",
        "info": "",
        "x": 190,
        "y": 100,
        "wires": []
    },
    {
        "id": "55b00947.ddc508",
        "type": "link in",
        "z": "e2d46b65.8c3d28",
        "name": "To Control",
        "links": [
            "44e76f83.bd737",
            "58e75c96.95b2b4",
            "b17c3083.dd0c8",
            "b20ba137.be08",
            "b5f7b64b.c7a248",
            "b7b6c644.b328b8",
            "f9e43485.fec318",
            "a8c2a30.58b5d6",
            "672a7a09.265094",
            "418f844b.671e2c",
            "8c4b9603.e1aee8",
            "4c11d973.d583d8",
            "73ad0302.9c13ac",
            "ca153323.175d",
            "9fb81c12.c17a1",
            "3d474729.48c3b8",
            "c362751b.9d6ec8",
            "b8efe10f.b23fd",
            "d84a2899.ed42d8",
            "a3a6fb04.90f508",
            "b3f2298f.3de718",
            "cb0d22ed.50e19"
        ],
        "x": 155,
        "y": 180,
        "wires": [
            [
                "88f62530.8725d8"
            ]
        ]
    },
    {
        "id": "88f62530.8725d8",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "Handle initialize",
        "func": "if (msg.topic !== 'initialize')\n{\n    return\n}\n\nconst changes = {\n    state: 'INPUT',\n    isOperating: false,\n\n    input: {\n        operator: '',\n        workorder: '',\n        enableStage: false\n    },\n    workorder: {\n        lotId: '',\n        pn: '',\n        lot: '',\n        stage: ''\n    },\n    preProductionRecipe: {\n        status: 'N/A',\n        etchingSpeedSet: '',\n        etching1UpSprayPressureSet: '',\n        etching1DownSprayPressureSet: '',\n        etching2SwitchSet: '',\n        etching3SwitchSet: '',\n        developSpeedSet: '',\n        timestamp: ''\n    },\n    productionRecipe: {\n        status: 'N/A',\n        etchingSpeedSet: '',\n        etching1UpSprayPressureSet: '',\n        etching1DownSprayPressureSet: '',\n        etching2SwitchSet: '',\n        etching3SwitchSet: '',\n        developSpeedSet: '',\n        timestamp: ''\n    },\n    productionCode: {\n        storeStatus: 'N/A',\n        printStatus: 'N/A'\n    }\n}\n\nlet model = global.get('model')\nmodel.productionWorkorder = Object.assign(model.productionWorkorder, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.productionWorkorder',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 400,
        "y": 180,
        "wires": [
            [
                "774a8f54.a250b"
            ]
        ]
    },
    {
        "id": "774a8f54.a250b",
        "type": "link out",
        "z": "e2d46b65.8c3d28",
        "name": "To View",
        "links": [
            "1f11def9.bf34a1",
            "25c230cf.7d5c1",
            "5a694f49.a6dc1",
            "6022ffbc.3bfec",
            "78dc8b8f.5838b4",
            "7b8c2c08.b563e4",
            "906e5b22.4989f8",
            "ae422560.686178",
            "e6618bc.b92f578",
            "6e7d7659.49a0c8",
            "86c694dd.0d3b58",
            "b00a14bc.49c178",
            "72b20f0d.07717",
            "7201918.9d8ef7",
            "92f89b72.0dfc58",
            "2296d51b.bb473a",
            "fb3100ee.25d73",
            "563d78f.923fb88",
            "4ed6ea6c.5812f4",
            "79ce718d.22dbf",
            "54cc6ac1.ba3754",
            "9cd75563.219f28",
            "2c4b532c.3aee0c",
            "fa88555.452f3a8",
            "fcecc3e7.5eb01",
            "bb14064e.2c38e8"
        ],
        "x": 975,
        "y": 180,
        "wires": []
    },
    {
        "id": "6e7d7659.49a0c8",
        "type": "link in",
        "z": "e7333943.c4bbc8",
        "name": "To View",
        "links": [
            "1c425765.6b2309",
            "fae00d5b.4d7cf",
            "fe3b68d5.4d9bb8",
            "dd06c8ba.f3ede8",
            "89789973.e5e468",
            "489ba77a.50c808",
            "5996a99f.a82ad8",
            "e603e132.0cbe1",
            "a6a2f658.b55fa8",
            "774a8f54.a250b",
            "5cc58842.141918",
            "680f0250.6e2a2c",
            "e0443fff.4e35f",
            "49ed37b1.523d68",
            "5b27ed13.a3c814",
            "4abf0a7b.536ba4",
            "f4ddf088.12237",
            "e075a031.de73d",
            "b577d158.09844",
            "aa9618e3.489e98",
            "a50ccc58.1f6dd",
            "9c6f34ec.44c938",
            "8ee38a81.6bdf38",
            "b1be3310.5727e"
        ],
        "x": 155,
        "y": 240,
        "wires": [
            [
                "3f688a2f.2f6ed6",
                "bd859dd9.630cb"
            ]
        ]
    },
    {
        "id": "3f688a2f.2f6ed6",
        "type": "function",
        "z": "e7333943.c4bbc8",
        "name": "",
        "func": "if (msg.topic !== 'model.productionWorkorder')\n{\n    return\n}\n\nconst model = global.get('model')\n\nconst enabled = model.productionWorkorder.state === 'INPUT'\n\nreturn [\n    {\n        enabled,\n        payload: model.productionWorkorder.input.operator\n    },\n    {\n        enabled,\n        payload: model.productionWorkorder.input.workorder\n    }\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 240,
        "wires": [
            [
                "167b53c4.6c0acc"
            ],
            [
                "32addf5d.a56de"
            ]
        ]
    },
    {
        "id": "bd859dd9.630cb",
        "type": "function",
        "z": "e7333943.c4bbc8",
        "name": "",
        "func": "if (msg.topic !== 'model.productionWorkorder')\n{\n    return\n}\n\nconst model = global.get('model')\n\nconst enabled = model.productionWorkorder.state === 'INPUT'\n && !!model.productionWorkorder.workorder.lotId\n && !!model.productionWorkorder.workorder.pn\n && !!model.productionWorkorder.workorder.lot\n && model.productionWorkorder.input.enableStage\n\nreturn {\n    enabled,\n    payload: model.productionWorkorder.workorder.stage\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 300,
        "wires": [
            [
                "1ec332ed.a038ad"
            ]
        ]
    },
    {
        "id": "2086b4ae.be1c4c",
        "type": "function",
        "z": "e7333943.c4bbc8",
        "name": "",
        "func": "const workorder = msg.payload\n\nreturn {\n    topic: 'productionWorkorder.workorder',\n    payload: {\n        workorder: workorder\n    }\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 740,
        "y": 260,
        "wires": [
            [
                "672a7a09.265094"
            ]
        ]
    },
    {
        "id": "672a7a09.265094",
        "type": "link out",
        "z": "e7333943.c4bbc8",
        "name": "To Control",
        "links": [
            "3541d990.925686",
            "52efc3ab.55ab6c",
            "7418d21.45ad22c",
            "a7975a02.8a0c88",
            "3b97a635.15979a",
            "bb7671b1.06e21",
            "b0dc5ccf.b1d62",
            "55b00947.ddc508",
            "abb166c.3e09798",
            "6d90df4e.6ef51",
            "61ea8d29.c6a4f4",
            "f45dd390.154fa",
            "d83de82b.db06e8",
            "6d610381.b62fac",
            "bc6010e1.7537c",
            "f99d52f2.f8f68",
            "d3dcc847.1cd478",
            "6b1721e5.459cc",
            "37ba1dd3.f5c012",
            "71a73452.ac13dc",
            "beee06f7.be6498",
            "a9a83c81.2306a",
            "79dbf37.1b4860c"
        ],
        "x": 915,
        "y": 260,
        "wires": []
    },
    {
        "id": "963d49e.95100b8",
        "type": "function",
        "z": "e7333943.c4bbc8",
        "name": "",
        "func": "const stage = msg.payload\n\nreturn {\n    topic: 'productionWorkorder.stage',\n    payload: {\n        stage: stage\n    }\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 740,
        "y": 300,
        "wires": [
            [
                "672a7a09.265094"
            ]
        ]
    },
    {
        "id": "b2cf4bb9.5ad4c8",
        "type": "function",
        "z": "e7333943.c4bbc8",
        "name": "",
        "func": "const operator = msg.payload\n\nreturn {\n    topic: 'productionWorkorder.operator',\n    payload: {\n        operator: operator\n    }\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 740,
        "y": 220,
        "wires": [
            [
                "672a7a09.265094"
            ]
        ]
    },
    {
        "id": "6d90df4e.6ef51",
        "type": "link in",
        "z": "e2d46b65.8c3d28",
        "name": "To Control",
        "links": [
            "58e75c96.95b2b4",
            "f9e43485.fec318",
            "44e76f83.bd737",
            "b20ba137.be08",
            "b17c3083.dd0c8",
            "b5f7b64b.c7a248",
            "b7b6c644.b328b8",
            "a8c2a30.58b5d6",
            "672a7a09.265094",
            "418f844b.671e2c",
            "8c4b9603.e1aee8",
            "4c11d973.d583d8",
            "73ad0302.9c13ac",
            "ca153323.175d",
            "9fb81c12.c17a1",
            "3d474729.48c3b8",
            "c362751b.9d6ec8",
            "b8efe10f.b23fd",
            "d84a2899.ed42d8",
            "a3a6fb04.90f508",
            "b3f2298f.3de718",
            "cb0d22ed.50e19"
        ],
        "x": 155,
        "y": 400,
        "wires": [
            [
                "f2abc687.890c88",
                "436747c1.853d18",
                "ffc6cc23.db1c"
            ]
        ]
    },
    {
        "id": "83bb1535.28c928",
        "type": "comment",
        "z": "e2d46b65.8c3d28",
        "name": "輸入",
        "info": "",
        "x": 190,
        "y": 320,
        "wires": []
    },
    {
        "id": "ffc6cc23.db1c",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "Handle workorder (LC2 工單碼 3+1 段)",
        "func": "if (msg.topic !== 'productionWorkorder.workorder')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.productionWorkorder.state !== 'INPUT')\n{\n    node.error('unexpected')\n    return\n}\n\nconst workorder = msg.payload.workorder\n\nlet exp = /^[0-9A-Z]+;[0-9A-Z.]+;[0-9.]+$/ig\n\nif (!exp.test(workorder))\n{\n    return [null, msg]\n}\n\nlet splitted = workorder.split(';')\nlet pn = splitted[0]\nlet lotId = splitted[1]\nlet lot = splitted[2]\n\nlet input = model.productionWorkorder.input\ninput.workorder = workorder\ninput.enableStage = true\n\nconst changes = {\n    input,\n    workorder: {\n        lotId: lotId,\n        pn: pn,\n        lot: lot,\n        stage: ''\n    }\n}\n\nmodel.productionWorkorder = Object.assign(model.productionWorkorder, changes)\nglobal.set('model', model)\n\nreturn [\n    {\n        topic: 'model.productionWorkorder',\n        payload: changes\n    },\n    null\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 470,
        "y": 500,
        "wires": [
            [
                "5cc58842.141918"
            ],
            [
                "94dfa128.75e4a"
            ]
        ]
    },
    {
        "id": "5cc58842.141918",
        "type": "link out",
        "z": "e2d46b65.8c3d28",
        "name": "To View",
        "links": [
            "1f11def9.bf34a1",
            "25c230cf.7d5c1",
            "906e5b22.4989f8",
            "7b8c2c08.b563e4",
            "78dc8b8f.5838b4",
            "5a694f49.a6dc1",
            "9c023a.051afdc8",
            "ae422560.686178",
            "e6618bc.b92f578",
            "6022ffbc.3bfec",
            "6e7d7659.49a0c8",
            "86c694dd.0d3b58",
            "b00a14bc.49c178",
            "72b20f0d.07717",
            "7201918.9d8ef7",
            "92f89b72.0dfc58",
            "2296d51b.bb473a",
            "fb3100ee.25d73",
            "563d78f.923fb88",
            "4ed6ea6c.5812f4",
            "79ce718d.22dbf",
            "54cc6ac1.ba3754",
            "9cd75563.219f28",
            "2c4b532c.3aee0c",
            "fa88555.452f3a8",
            "fcecc3e7.5eb01",
            "bb14064e.2c38e8"
        ],
        "x": 975,
        "y": 560,
        "wires": []
    },
    {
        "id": "436747c1.853d18",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "Handle stage",
        "func": "if (msg.topic !== 'productionWorkorder.stage')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.productionWorkorder.state !== 'INPUT')\n{\n    node.error('unexpected')\n    return\n}\n\nconst stage = msg.payload.stage\n\nlet workorder = model.productionWorkorder.workorder\nworkorder.stage = stage\n\nconst changes = {\n    workorder\n}\n\nmodel.productionWorkorder = Object.assign(model.productionWorkorder, changes)\n\nreturn {\n    topic: 'model.productionWorkorder',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 390,
        "y": 720,
        "wires": [
            [
                "5cc58842.141918"
            ]
        ]
    },
    {
        "id": "f27105db.b51a28",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "Handle workorder (parse error)",
        "func": "if (msg.topic !== 'productionWorkorder.workorder')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.productionWorkorder.state !== 'INPUT')\n{\n    node.error('unexpected')\n    return\n}\n\nlet input = model.productionWorkorder.input\ninput.workorder = msg.payload.workorder\ninput.enableStage = false\n\nconst changes = {\n    input,\n    workorder: {\n        lotId: '',\n        pn: '',\n        lot: '',\n        stage: ''\n    }\n}\n\nmodel.productionWorkorder = Object.assign(model.productionWorkorder, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.productionWorkorder',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 450,
        "y": 660,
        "wires": [
            [
                "5cc58842.141918"
            ]
        ]
    },
    {
        "id": "f2abc687.890c88",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "Handle operator",
        "func": "if (msg.topic !== 'productionWorkorder.operator')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.productionWorkorder.state !== 'INPUT')\n{\n    node.error('unexpected')\n    return\n}\n\nconst operator = msg.payload.operator\nlet input = model.productionWorkorder.input\n\ninput.operator = operator\n\nconst changes = {\n    input\n}\n\nmodel.productionWorkorder = Object.assign(model.productionWorkorder, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.productionWorkorder',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 400,
        "y": 400,
        "wires": [
            [
                "5cc58842.141918"
            ]
        ]
    },
    {
        "id": "94dfa128.75e4a",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "Handle workorder (LC2 工單碼 4 段)",
        "func": "if (msg.topic !== 'productionWorkorder.workorder')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.productionWorkorder.state !== 'INPUT')\n{\n    node.error('unexpected')\n    return\n}\n\nconst workorder = msg.payload.workorder\n\nlet exp = /^[0-9A-Z]+;[0-9A-Z.]+;[0-9.]+&[0-9A-Z]+$/ig\n\nif (!exp.test(workorder))\n{\n    return [null, msg]\n}\n\nlet splitted = workorder.split(';')\nlet pn = splitted[0]\nlet lotId = splitted[1]\n\nsplitted = splitted[2].split('&')\nlet lot = splitted[0]\nlet stage = splitted[1]\n\nlet input = model.productionWorkorder.input\ninput.workorder = workorder\ninput.enableStage = false\n\nconst changes = {\n    input,\n    workorder: {\n        lotId: lotId,\n        pn: pn,\n        lot: lot,\n        stage: stage\n    }\n}\n\nmodel.productionWorkorder = Object.assign(model.productionWorkorder, changes)\nglobal.set('model', model)\n\nreturn [\n    {\n        topic: 'model.productionWorkorder',\n        payload: changes\n    },\n    null\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 470,
        "y": 540,
        "wires": [
            [
                "5cc58842.141918"
            ],
            [
                "26173281.a0b52e"
            ]
        ]
    },
    {
        "id": "26173281.a0b52e",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "Handle workorder (工單碼 3+1 段)",
        "func": "if (msg.topic !== 'productionWorkorder.workorder')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.productionWorkorder.state !== 'INPUT')\n{\n    node.error('unexpected')\n    return\n}\n\nconst workorder = msg.payload.workorder\n\nlet exp = /^[0-9A-Z.]+\\|[0-9A-Z]+\\|[0-9]+$/ig\n\nif (!exp.test(workorder))\n{\n    return [null, msg]\n}\n\nlet splitted = workorder.split('|')\nlet lotId = splitted[0]\nlet pn = splitted[1]\nlet lot = splitted[2]\n\nlet input = model.productionWorkorder.input\ninput.workorder = workorder\ninput.enableStage = true\n\nconst changes = {\n    input,\n    workorder: {\n        lotId: lotId,\n        pn: pn,\n        lot: lot,\n        stage: ''\n    }\n}\n\nmodel.productionWorkorder = Object.assign(model.productionWorkorder, changes)\nglobal.set('model', model)\n\nreturn [\n    {\n        topic: 'model.productionWorkorder',\n        payload: changes\n    },\n    null\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 460,
        "y": 580,
        "wires": [
            [
                "5cc58842.141918"
            ],
            [
                "571dd9cc.530838"
            ]
        ]
    },
    {
        "id": "571dd9cc.530838",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "Handle workorder (工單碼 4 段)",
        "func": "if (msg.topic !== 'productionWorkorder.workorder')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.productionWorkorder.state !== 'INPUT')\n{\n    node.error('unexpected')\n    return\n}\n\nconst workorder = msg.payload.workorder\n\nlet exp = /^[0-9A-Z.]+\\|[0-9A-Z]+\\|[0-9]+\\|[0-9A-Z]+$/ig\n\nif (!exp.test(workorder))\n{\n    return [null, msg]\n}\n\nlet splitted = workorder.split('|')\nlet lotId = splitted[0]\nlet pn = splitted[1]\nlet lot = splitted[2]\nlet stage = splitted[3]\n\nlet input = model.productionWorkorder.input\ninput.workorder = workorder\ninput.enableStage = false\n\nconst changes = {\n    input,\n    workorder: {\n        lotId: lotId,\n        pn: pn,\n        lot: lot,\n        stage: stage\n    }\n}\n\nmodel.productionWorkorder = Object.assign(model.productionWorkorder, changes)\nglobal.set('model', model)\n\nreturn [\n    {\n        topic: 'model.productionWorkorder',\n        payload: changes\n    },\n    null\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 450,
        "y": 620,
        "wires": [
            [
                "5cc58842.141918"
            ],
            [
                "f27105db.b51a28"
            ]
        ]
    },
    {
        "id": "722bc757.31b658",
        "type": "function",
        "z": "e7333943.c4bbc8",
        "name": "",
        "func": "if (msg.topic !== 'model.productionWorkorder')\n{\n    return\n}\n\nconst model = global.get('model')\n\nconst enabled = model.productionWorkorder.state === 'INPUT'\n\nreturn [\n    {\n        enabled,\n        payload: model.productionWorkorder.workorder.pn\n    },\n    {\n        enabled,\n        payload: model.productionWorkorder.workorder.lot\n    },\n    {\n        enabled,\n        payload: model.productionWorkorder.workorder.lotId\n    },\n    {\n        enabled,\n        payload: model.productionWorkorder.workorder.stage\n    }\n]\n",
        "outputs": 4,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 540,
        "wires": [
            [
                "d60525d.78f28d8"
            ],
            [
                "8366a1c3.dcb2c"
            ],
            [
                "a14a2a5e.f7f398"
            ],
            [
                "81f96548.2a0658"
            ]
        ]
    },
    {
        "id": "86c694dd.0d3b58",
        "type": "link in",
        "z": "e7333943.c4bbc8",
        "name": "To View",
        "links": [
            "1c425765.6b2309",
            "fae00d5b.4d7cf",
            "fe3b68d5.4d9bb8",
            "dd06c8ba.f3ede8",
            "89789973.e5e468",
            "489ba77a.50c808",
            "5996a99f.a82ad8",
            "e603e132.0cbe1",
            "a6a2f658.b55fa8",
            "774a8f54.a250b",
            "5cc58842.141918",
            "680f0250.6e2a2c",
            "e0443fff.4e35f",
            "49ed37b1.523d68",
            "5b27ed13.a3c814",
            "4abf0a7b.536ba4",
            "f4ddf088.12237",
            "e075a031.de73d",
            "b577d158.09844",
            "aa9618e3.489e98",
            "a50ccc58.1f6dd",
            "9c6f34ec.44c938",
            "8ee38a81.6bdf38",
            "b1be3310.5727e"
        ],
        "x": 155,
        "y": 540,
        "wires": [
            [
                "722bc757.31b658",
                "60ae888b.6484e8"
            ]
        ]
    },
    {
        "id": "60ae888b.6484e8",
        "type": "function",
        "z": "e7333943.c4bbc8",
        "name": "",
        "func": "if (msg.topic !== 'model.productionWorkorder')\n{\n    return\n}\n\nconst model = global.get('model')\n\nconst enabled = model.productionWorkorder.state === 'INPUT'\n && model.productionWorkorder.workorder.lotId\n && model.productionWorkorder.workorder.pn\n && model.productionWorkorder.workorder.lot\n && model.productionWorkorder.workorder.stage\n\nreturn {\n    enabled\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 680,
        "wires": [
            [
                "98380cc0.23e71"
            ]
        ]
    },
    {
        "id": "849b2882.51e958",
        "type": "function",
        "z": "e7333943.c4bbc8",
        "name": "",
        "func": "return {\n    topic: 'productionWorkorder.confirmWorkorder',\n    payload: {}\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 740,
        "y": 680,
        "wires": [
            [
                "418f844b.671e2c"
            ]
        ]
    },
    {
        "id": "418f844b.671e2c",
        "type": "link out",
        "z": "e7333943.c4bbc8",
        "name": "To Control",
        "links": [
            "3541d990.925686",
            "52efc3ab.55ab6c",
            "7418d21.45ad22c",
            "a7975a02.8a0c88",
            "3b97a635.15979a",
            "bb7671b1.06e21",
            "b0dc5ccf.b1d62",
            "55b00947.ddc508",
            "abb166c.3e09798",
            "6d90df4e.6ef51",
            "61ea8d29.c6a4f4",
            "f45dd390.154fa",
            "d83de82b.db06e8",
            "6d610381.b62fac",
            "bc6010e1.7537c",
            "f99d52f2.f8f68",
            "d3dcc847.1cd478",
            "6b1721e5.459cc",
            "37ba1dd3.f5c012",
            "71a73452.ac13dc",
            "beee06f7.be6498",
            "a9a83c81.2306a",
            "79dbf37.1b4860c"
        ],
        "x": 915,
        "y": 680,
        "wires": []
    },
    {
        "id": "4efc17c1.cce798",
        "type": "comment",
        "z": "e2d46b65.8c3d28",
        "name": "工單內容",
        "info": "",
        "x": 200,
        "y": 860,
        "wires": []
    },
    {
        "id": "61ea8d29.c6a4f4",
        "type": "link in",
        "z": "e2d46b65.8c3d28",
        "name": "To Control",
        "links": [
            "44e76f83.bd737",
            "58e75c96.95b2b4",
            "f9e43485.fec318",
            "b20ba137.be08",
            "b17c3083.dd0c8",
            "b5f7b64b.c7a248",
            "b7b6c644.b328b8",
            "a8c2a30.58b5d6",
            "672a7a09.265094",
            "418f844b.671e2c",
            "8c4b9603.e1aee8",
            "4c11d973.d583d8",
            "73ad0302.9c13ac",
            "ca153323.175d",
            "9fb81c12.c17a1",
            "3d474729.48c3b8",
            "c362751b.9d6ec8",
            "b8efe10f.b23fd",
            "d84a2899.ed42d8",
            "a3a6fb04.90f508",
            "b3f2298f.3de718",
            "cb0d22ed.50e19"
        ],
        "x": 155,
        "y": 940,
        "wires": [
            [
                "2e0eb403.02643c"
            ]
        ]
    },
    {
        "id": "2e0eb403.02643c",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "Handle confirmWorkorder",
        "func": "if (msg.topic !== 'productionWorkorder.confirmWorkorder')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.productionWorkorder.state !== 'INPUT')\n{\n    node.error('unexpected')\n    return\n}\n\nlet changes = {\n    state: 'PRE_PRODUCTION_RECIPE'\n}\n\nmodel.productionWorkorder = Object.assign(model.productionWorkorder, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.productionWorkorder',\n    payload: changes\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 430,
        "y": 940,
        "wires": [
            [
                "680f0250.6e2a2c"
            ]
        ]
    },
    {
        "id": "680f0250.6e2a2c",
        "type": "link out",
        "z": "e2d46b65.8c3d28",
        "name": "To View",
        "links": [
            "1f11def9.bf34a1",
            "25c230cf.7d5c1",
            "906e5b22.4989f8",
            "7b8c2c08.b563e4",
            "78dc8b8f.5838b4",
            "5a694f49.a6dc1",
            "9c023a.051afdc8",
            "ae422560.686178",
            "e6618bc.b92f578",
            "6022ffbc.3bfec",
            "6e7d7659.49a0c8",
            "86c694dd.0d3b58",
            "b00a14bc.49c178",
            "72b20f0d.07717",
            "7201918.9d8ef7",
            "92f89b72.0dfc58",
            "2296d51b.bb473a",
            "fb3100ee.25d73",
            "563d78f.923fb88",
            "4ed6ea6c.5812f4",
            "79ce718d.22dbf",
            "54cc6ac1.ba3754",
            "9cd75563.219f28",
            "2c4b532c.3aee0c",
            "fa88555.452f3a8",
            "fcecc3e7.5eb01",
            "bb14064e.2c38e8"
        ],
        "x": 975,
        "y": 940,
        "wires": []
    },
    {
        "id": "b00a14bc.49c178",
        "type": "link in",
        "z": "e7333943.c4bbc8",
        "name": "To View",
        "links": [
            "1c425765.6b2309",
            "fae00d5b.4d7cf",
            "fe3b68d5.4d9bb8",
            "dd06c8ba.f3ede8",
            "89789973.e5e468",
            "489ba77a.50c808",
            "5996a99f.a82ad8",
            "e603e132.0cbe1",
            "a6a2f658.b55fa8",
            "774a8f54.a250b",
            "5cc58842.141918",
            "680f0250.6e2a2c",
            "e0443fff.4e35f",
            "49ed37b1.523d68",
            "5b27ed13.a3c814",
            "4abf0a7b.536ba4",
            "f4ddf088.12237",
            "e075a031.de73d",
            "b577d158.09844",
            "aa9618e3.489e98",
            "a50ccc58.1f6dd",
            "9c6f34ec.44c938",
            "8ee38a81.6bdf38",
            "b1be3310.5727e"
        ],
        "x": 155,
        "y": 920,
        "wires": [
            [
                "aea30f1d.e2786",
                "f1a61852.710ed8"
            ]
        ]
    },
    {
        "id": "aea30f1d.e2786",
        "type": "function",
        "z": "e7333943.c4bbc8",
        "name": "",
        "func": "if (msg.topic !== 'model.productionWorkorder')\n{\n    return\n}\n\nif (msg.payload.state !== 'PRE_PRODUCTION_RECIPE')\n{\n    return\n}\n\nreturn {\n    topic: 'productionWorkorder.preProductionRms',\n    payload: {}\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 1200,
        "wires": [
            [
                "8c4b9603.e1aee8"
            ]
        ]
    },
    {
        "id": "8c4b9603.e1aee8",
        "type": "link out",
        "z": "e7333943.c4bbc8",
        "name": "To Control",
        "links": [
            "3541d990.925686",
            "52efc3ab.55ab6c",
            "7418d21.45ad22c",
            "a7975a02.8a0c88",
            "3b97a635.15979a",
            "bb7671b1.06e21",
            "b0dc5ccf.b1d62",
            "55b00947.ddc508",
            "abb166c.3e09798",
            "6d90df4e.6ef51",
            "61ea8d29.c6a4f4",
            "f45dd390.154fa",
            "d83de82b.db06e8",
            "6d610381.b62fac",
            "bc6010e1.7537c",
            "f99d52f2.f8f68",
            "d3dcc847.1cd478",
            "6b1721e5.459cc",
            "37ba1dd3.f5c012",
            "71a73452.ac13dc",
            "beee06f7.be6498",
            "a9a83c81.2306a",
            "79dbf37.1b4860c"
        ],
        "x": 915,
        "y": 1200,
        "wires": []
    },
    {
        "id": "f1a61852.710ed8",
        "type": "function",
        "z": "e7333943.c4bbc8",
        "name": "",
        "func": "if (msg.topic !== 'model.productionWorkorder')\n{\n    return\n}\n\nconst model = global.get('model')\n\nconst enabled = model.productionWorkorder.state === 'PRE_PRODUCTION_RECIPE'\nconst preProductionRecipe = model.productionWorkorder.preProductionRecipe\n\nreturn [\n    {\n        enabled,\n        payload: preProductionRecipe.status\n    },\n    {\n        enabled,\n        payload: preProductionRecipe.etchingSpeedSet\n    },\n    {\n        enabled,\n        payload: preProductionRecipe.etching1UpSprayPressureSet\n    },\n    {\n        enabled,\n        payload: preProductionRecipe.etching1DownSprayPressureSet\n    },\n    {\n        enabled,\n        payload: preProductionRecipe.etching2SwitchSet\n    },\n    {\n        enabled,\n        payload: preProductionRecipe.etching3SwitchSet\n    },\n    {\n        enabled,\n        payload: preProductionRecipe.developSpeedSet\n    },\n    {\n        enabled,\n        payload: preProductionRecipe.timestamp\n    }\n]\n",
        "outputs": 8,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 920,
        "wires": [
            [
                "be6d4233.45627"
            ],
            [
                "d84c886a.b86d48"
            ],
            [
                "16cf0fed.c969"
            ],
            [
                "66f2f151.7b303"
            ],
            [
                "1d5d7dcb.81b952"
            ],
            [
                "6597adcc.f03c54"
            ],
            [
                "7781a61f.1f1318"
            ],
            [
                "735c0754.e7a878"
            ]
        ]
    },
    {
        "id": "fb2efd9.3a0f3",
        "type": "comment",
        "z": "e2d46b65.8c3d28",
        "name": "首件配方",
        "info": "",
        "x": 200,
        "y": 1120,
        "wires": []
    },
    {
        "id": "4473ad95.a5a984",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "Handle preProductionRms",
        "func": "if (msg.topic !== 'productionWorkorder.preProductionRms')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.productionWorkorder.state !== 'PRE_PRODUCTION_RECIPE')\n{\n    node.error('unexpected')\n    return\n}\n\nreturn {}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 440,
        "y": 1200,
        "wires": [
            [
                "148fa74a.4bf309"
            ]
        ]
    },
    {
        "id": "f45dd390.154fa",
        "type": "link in",
        "z": "e2d46b65.8c3d28",
        "name": "To Control",
        "links": [
            "44e76f83.bd737",
            "58e75c96.95b2b4",
            "f9e43485.fec318",
            "b20ba137.be08",
            "b17c3083.dd0c8",
            "b5f7b64b.c7a248",
            "b7b6c644.b328b8",
            "a8c2a30.58b5d6",
            "672a7a09.265094",
            "418f844b.671e2c",
            "8c4b9603.e1aee8",
            "4c11d973.d583d8",
            "73ad0302.9c13ac",
            "ca153323.175d",
            "9fb81c12.c17a1",
            "3d474729.48c3b8",
            "c362751b.9d6ec8",
            "b8efe10f.b23fd",
            "d84a2899.ed42d8",
            "a3a6fb04.90f508",
            "b3f2298f.3de718",
            "cb0d22ed.50e19"
        ],
        "x": 155,
        "y": 1200,
        "wires": [
            [
                "4473ad95.a5a984"
            ]
        ]
    },
    {
        "id": "148fa74a.4bf309",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "query recipe",
        "func": "const model = global.get('model')\n\nconst pn = model.productionWorkorder.workorder.pn\nconst lot = model.productionWorkorder.workorder.lot\nconst lotId = model.productionWorkorder.workorder.lotId\nconst stage = model.productionWorkorder.workorder.stage\n\nmsg.config = {\n    filter: [\n        {\n            id: {\n                eq: `${pn}|${lot}|${lotId}|${stage}`\n            }\n        }\n    ]\n}\n\nreturn msg\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 390,
        "y": 1260,
        "wires": [
            [
                "309fb5f2.04931a"
            ]
        ]
    },
    {
        "id": "309fb5f2.04931a",
        "type": "recipe-query",
        "z": "e2d46b65.8c3d28",
        "name": "",
        "category": "pre_production",
        "filter": "[]",
        "filterType": "json",
        "sortBy": "[]",
        "sortByType": "json",
        "maxResults": "",
        "x": 470,
        "y": 1300,
        "wires": [
            [
                "f83c53ae.1ec48"
            ]
        ]
    },
    {
        "id": "13cb361f.dfaeda",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "extract",
        "func": "const recipe = msg.payload[0]\nconst DATE_STRING = global.get('DATE_STRING')\n\nconst changes = {\n    state: 'PRODUCTION_RECIPE',\n    preProductionRecipe: {\n        status: 'OK',\n        etchingSpeedSet: recipe.ingredients.etching_speed,\n        etching1UpSprayPressureSet: recipe.ingredients.etching_1_up_spray_pressure,\n        etching1DownSprayPressureSet: recipe.ingredients.etching_1_down_spray_pressure,\n        etching2SwitchSet: recipe.ingredients.etching_2_switch,\n        etching3SwitchSet: recipe.ingredients.etching_3_switch,\n        developSpeedSet: recipe.ingredients.develop_speed,\n        timestamp: DATE_STRING(recipe.updated.at)\n    }\n}\n\nlet model = global.get('model')\nmodel.productionWorkorder = Object.assign(model.productionWorkorder, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.productionWorkorder',\n    payload: changes\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 410,
        "y": 1380,
        "wires": [
            [
                "e0443fff.4e35f"
            ]
        ]
    },
    {
        "id": "e0443fff.4e35f",
        "type": "link out",
        "z": "e2d46b65.8c3d28",
        "name": "To View",
        "links": [
            "1f11def9.bf34a1",
            "25c230cf.7d5c1",
            "906e5b22.4989f8",
            "7b8c2c08.b563e4",
            "78dc8b8f.5838b4",
            "5a694f49.a6dc1",
            "9c023a.051afdc8",
            "ae422560.686178",
            "e6618bc.b92f578",
            "6022ffbc.3bfec",
            "6e7d7659.49a0c8",
            "86c694dd.0d3b58",
            "b00a14bc.49c178",
            "72b20f0d.07717",
            "7201918.9d8ef7",
            "92f89b72.0dfc58",
            "2296d51b.bb473a",
            "fb3100ee.25d73",
            "563d78f.923fb88",
            "4ed6ea6c.5812f4",
            "79ce718d.22dbf",
            "54cc6ac1.ba3754",
            "9cd75563.219f28",
            "2c4b532c.3aee0c",
            "fa88555.452f3a8",
            "fcecc3e7.5eb01",
            "bb14064e.2c38e8"
        ],
        "x": 975,
        "y": 1340,
        "wires": []
    },
    {
        "id": "f83c53ae.1ec48",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "validate",
        "func": "const payload = msg.payload\n\nif (payload.length === 0)\n{\n    let model = global.get('model')\n    let preProductionRecipe = model.productionWorkorder.preProductionRecipe\n\n    preProductionRecipe.status = 'KO, 配方不存在'\n\n    const changes = {\n        preProductionRecipe\n    }\n\n    model.productionWorkorder = Object.assign(model.productionWorkorder, changes)\n    global.set('model', model)\n\n    return [\n        {\n            topic: 'model.productionWorkorder',\n            payload: changes\n        },\n        null\n    ]\n}\n\nreturn [\n    null,\n    msg\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 420,
        "y": 1340,
        "wires": [
            [
                "e0443fff.4e35f",
                "e41cf9b5.76e0a8"
            ],
            [
                "13cb361f.dfaeda"
            ]
        ]
    },
    {
        "id": "e3b5c9f4.8a0688",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "query recipe",
        "func": "const model = global.get('model')\n\nconst pn = model.productionWorkorder.workorder.pn\nconst lot = model.productionWorkorder.workorder.lot\nconst lotId = model.productionWorkorder.workorder.lotId\nconst stage = model.productionWorkorder.workorder.stage\n\nmsg.config = {\n    filter: [\n        {\n            id: {\n                eq: `${pn}|${lot}|${lotId}|${stage}`\n            }\n        }\n    ]\n}\n\nreturn msg\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 390,
        "y": 1700,
        "wires": [
            [
                "a91afaef.8cd6f8"
            ]
        ]
    },
    {
        "id": "a91afaef.8cd6f8",
        "type": "recipe-query",
        "z": "e2d46b65.8c3d28",
        "name": "",
        "category": "production",
        "filter": "[]",
        "filterType": "json",
        "sortBy": "[]",
        "sortByType": "json",
        "maxResults": "",
        "x": 450,
        "y": 1740,
        "wires": [
            [
                "466bd124.13981"
            ]
        ]
    },
    {
        "id": "80b04cad.14412",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "extract",
        "func": "const recipe = msg.payload[0]\n\nconst DATE_STRING = global.get('DATE_STRING')\nlet model = global.get('model')\n\nconst changes = {\n    state: 'PRODUCTION_CODE',\n    productionRecipe: {\n        status: 'OK',\n        etchingSpeedSet: recipe.ingredients.etching_speed,\n        etching1UpSprayPressureSet: recipe.ingredients.etching_1_up_spray_pressure,\n        etching1DownSprayPressureSet: recipe.ingredients.etching_1_down_spray_pressure,\n        etching2SwitchSet: recipe.ingredients.etching_2_switch,\n        etching3SwitchSet: recipe.ingredients.etching_3_switch,\n        developSpeedSet: recipe.ingredients.develop_speed,\n        timestamp: DATE_STRING(recipe.updated.at)\n    }\n}\n\nmodel.productionWorkorder = Object.assign(model.productionWorkorder, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.productionWorkorder',\n    payload: changes\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 410,
        "y": 1820,
        "wires": [
            [
                "5b27ed13.a3c814"
            ]
        ]
    },
    {
        "id": "72b20f0d.07717",
        "type": "link in",
        "z": "e7333943.c4bbc8",
        "name": "To View",
        "links": [
            "1c425765.6b2309",
            "fae00d5b.4d7cf",
            "fe3b68d5.4d9bb8",
            "dd06c8ba.f3ede8",
            "89789973.e5e468",
            "489ba77a.50c808",
            "5996a99f.a82ad8",
            "e603e132.0cbe1",
            "a6a2f658.b55fa8",
            "774a8f54.a250b",
            "5cc58842.141918",
            "680f0250.6e2a2c",
            "e0443fff.4e35f",
            "49ed37b1.523d68",
            "5b27ed13.a3c814",
            "4abf0a7b.536ba4",
            "f4ddf088.12237",
            "e075a031.de73d",
            "b577d158.09844",
            "aa9618e3.489e98",
            "a50ccc58.1f6dd",
            "9c6f34ec.44c938",
            "8ee38a81.6bdf38",
            "b1be3310.5727e"
        ],
        "x": 155,
        "y": 1980,
        "wires": [
            [
                "77460958.6548b8",
                "d542625c.7ad6e",
                "c29fb7f7.10ff58",
                "47764829.d057b8"
            ]
        ]
    },
    {
        "id": "77460958.6548b8",
        "type": "function",
        "z": "e7333943.c4bbc8",
        "name": "",
        "func": "if (msg.topic !== 'model.productionWorkorder')\n{\n    return\n}\n\nconst model = global.get('model')\n\nconst enabled = model.productionWorkorder.state === 'PRODUCTION_CODE'\n && model.productionWorkorder.productionRecipe.status === 'OK'\n && !model.productionWorkorder.isOperating\n\nreturn {\n    enabled\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 2100,
        "wires": [
            [
                "483af3ef.f3940c"
            ]
        ]
    },
    {
        "id": "805e60f.67075a",
        "type": "ui_button",
        "z": "e7333943.c4bbc8",
        "name": "",
        "group": "6ac1c94a.e8c9c8",
        "order": 6,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "取消",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 510,
        "y": 2260,
        "wires": [
            [
                "5b49f9e2.c25838"
            ]
        ]
    },
    {
        "id": "d542625c.7ad6e",
        "type": "function",
        "z": "e7333943.c4bbc8",
        "name": "",
        "func": "if (msg.topic !== 'model.productionWorkorder')\n{\n    return\n}\n\nconst model = global.get('model')\n\nconst enabled = model.productionWorkorder.state === 'PRODUCTION_CODE'\n && !model.productionWorkorder.isOperating\n\nreturn {\n    enabled\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 2260,
        "wires": [
            [
                "805e60f.67075a"
            ]
        ]
    },
    {
        "id": "5b49f9e2.c25838",
        "type": "function",
        "z": "e7333943.c4bbc8",
        "name": "",
        "func": "return {\n    topic: 'productionWorkorder.cancel',\n    payload: {}\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 720,
        "y": 2260,
        "wires": [
            [
                "4c11d973.d583d8"
            ]
        ]
    },
    {
        "id": "4c11d973.d583d8",
        "type": "link out",
        "z": "e7333943.c4bbc8",
        "name": "To Control",
        "links": [
            "3541d990.925686",
            "52efc3ab.55ab6c",
            "7418d21.45ad22c",
            "a7975a02.8a0c88",
            "3b97a635.15979a",
            "bb7671b1.06e21",
            "b0dc5ccf.b1d62",
            "55b00947.ddc508",
            "abb166c.3e09798",
            "6d90df4e.6ef51",
            "61ea8d29.c6a4f4",
            "f45dd390.154fa",
            "d83de82b.db06e8",
            "6d610381.b62fac",
            "bc6010e1.7537c",
            "f99d52f2.f8f68",
            "d3dcc847.1cd478",
            "6b1721e5.459cc",
            "37ba1dd3.f5c012",
            "71a73452.ac13dc",
            "beee06f7.be6498",
            "a9a83c81.2306a",
            "79dbf37.1b4860c"
        ],
        "x": 915,
        "y": 2000,
        "wires": []
    },
    {
        "id": "46731870.ae64c8",
        "type": "comment",
        "z": "e2d46b65.8c3d28",
        "name": "量產條碼",
        "info": "",
        "x": 200,
        "y": 1980,
        "wires": []
    },
    {
        "id": "c29fb7f7.10ff58",
        "type": "function",
        "z": "e7333943.c4bbc8",
        "name": "",
        "func": "if (msg.topic !== 'model.productionWorkorder')\n{\n    return\n}\n\nconst model = global.get('model')\n\nconst enabled = model.productionWorkorder.state === 'PRODUCTION_CODE'\n && !model.productionWorkorder.isOperating\n\nreturn {\n    enabled\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 2060,
        "wires": [
            [
                "8259bc74.45f58"
            ]
        ]
    },
    {
        "id": "7dd44d2d.e2abb4",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "Handle cancel",
        "func": "if (msg.topic !== 'productionWorkorder.cancel')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.productionWorkorder.state !== 'PRODUCTION_CODE')\n{\n    node.error('unexpected')\n    return\n}\n\nreturn {}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 400,
        "y": 2820,
        "wires": [
            [
                "d811d4bd.e556b8"
            ]
        ]
    },
    {
        "id": "d811d4bd.e556b8",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "clean",
        "func": "const changes = {\n    state: 'INPUT',\n    isOperating: false,\n\n    input: {\n        operator: '',\n        workorder: '',\n        enableStage: false\n    },\n    workorder: {\n        lotId: '',\n        pn: '',\n        lot: '',\n        stage: ''\n    },\n    preProductionRecipe: {\n        status: 'N/A',\n        etchingSpeedSet: '',\n        etching1UpSprayPressureSet: '',\n        etching1DownSprayPressureSet: '',\n        etching2SwitchSet: '',\n        etching3SwitchSet: '',\n        developSpeedSet: '',\n        timestamp: ''\n    },\n    productionRecipe: {\n        status: 'N/A',\n        etchingSpeedSet: '',\n        etching1UpSprayPressureSet: '',\n        etching1DownSprayPressureSet: '',\n        etching2SwitchSet: '',\n        etching3SwitchSet: '',\n        developSpeedSet: '',\n        timestamp: ''\n    },\n    productionCode: {\n        storeStatus: 'N/A',\n        printStatus: 'N/A'\n    }\n}\n\nlet model = global.get('model')\nmodel.productionWorkorder = Object.assign(model.productionWorkorder, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.productionWorkorder',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 770,
        "y": 2820,
        "wires": [
            [
                "49ed37b1.523d68"
            ]
        ]
    },
    {
        "id": "d83de82b.db06e8",
        "type": "link in",
        "z": "e2d46b65.8c3d28",
        "name": "To Control",
        "links": [
            "44e76f83.bd737",
            "58e75c96.95b2b4",
            "f9e43485.fec318",
            "b20ba137.be08",
            "b17c3083.dd0c8",
            "b5f7b64b.c7a248",
            "b7b6c644.b328b8",
            "a8c2a30.58b5d6",
            "672a7a09.265094",
            "418f844b.671e2c",
            "8c4b9603.e1aee8",
            "4c11d973.d583d8",
            "73ad0302.9c13ac",
            "ca153323.175d",
            "9fb81c12.c17a1",
            "3d474729.48c3b8",
            "c362751b.9d6ec8",
            "b8efe10f.b23fd",
            "d84a2899.ed42d8",
            "a3a6fb04.90f508",
            "b3f2298f.3de718",
            "cb0d22ed.50e19"
        ],
        "x": 155,
        "y": 2180,
        "wires": [
            [
                "7dd44d2d.e2abb4",
                "ed284fc7.41fe",
                "9e7c0cdc.86c95"
            ]
        ]
    },
    {
        "id": "49ed37b1.523d68",
        "type": "link out",
        "z": "e2d46b65.8c3d28",
        "name": "To View",
        "links": [
            "1f11def9.bf34a1",
            "25c230cf.7d5c1",
            "906e5b22.4989f8",
            "7b8c2c08.b563e4",
            "78dc8b8f.5838b4",
            "5a694f49.a6dc1",
            "9c023a.051afdc8",
            "ae422560.686178",
            "e6618bc.b92f578",
            "6022ffbc.3bfec",
            "6e7d7659.49a0c8",
            "86c694dd.0d3b58",
            "b00a14bc.49c178",
            "72b20f0d.07717",
            "7201918.9d8ef7",
            "92f89b72.0dfc58",
            "2296d51b.bb473a",
            "fb3100ee.25d73",
            "563d78f.923fb88",
            "4ed6ea6c.5812f4",
            "79ce718d.22dbf",
            "54cc6ac1.ba3754",
            "9cd75563.219f28",
            "2c4b532c.3aee0c",
            "fa88555.452f3a8",
            "fcecc3e7.5eb01",
            "bb14064e.2c38e8"
        ],
        "x": 995,
        "y": 2520,
        "wires": []
    },
    {
        "id": "32874e30.4102a2",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "clean",
        "func": "const changes = {\n    state: 'INPUT',\n    isOperating: false,\n\n    input: {\n        operator: '',\n        workorder: '',\n        enableStage: false\n    },\n    workorder: {\n        lotId: '',\n        pn: '',\n        lot: '',\n        stage: ''\n    },\n    preProductionRecipe: {\n        status: 'N/A',\n        etchingSpeedSet: '',\n        etching1UpSprayPressureSet: '',\n        etching1DownSprayPressureSet: '',\n        etching2SwitchSet: '',\n        etching3SwitchSet: '',\n        developSpeedSet: '',\n        timestamp: ''\n    },\n    productionRecipe: {\n        status: 'N/A',\n        etchingSpeedSet: '',\n        etching1UpSprayPressureSet: '',\n        etching1DownSprayPressureSet: '',\n        etching2SwitchSet: '',\n        etching3SwitchSet: '',\n        developSpeedSet: '',\n        timestamp: ''\n    },\n    productionCode: {\n        storeStatus: 'N/A',\n        printStatus: 'N/A'\n    }\n}\n\nlet model = global.get('model')\nmodel.productionWorkorder = Object.assign(model.productionWorkorder, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.productionWorkorder',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 850,
        "y": 1300,
        "wires": [
            [
                "e0443fff.4e35f"
            ]
        ]
    },
    {
        "id": "e41cf9b5.76e0a8",
        "type": "delay",
        "z": "e2d46b65.8c3d28",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 720,
        "y": 1300,
        "wires": [
            [
                "32874e30.4102a2"
            ]
        ]
    },
    {
        "id": "47764829.d057b8",
        "type": "function",
        "z": "e7333943.c4bbc8",
        "name": "",
        "func": "if (msg.topic !== 'model.productionWorkorder')\n{\n    return\n}\n\nconst model = global.get('model')\n\nlet workorder = ''\nlet qrcodeUrl = ''\nif (model.productionWorkorder.state === 'PRODUCTION_CODE' &&\n        model.productionWorkorder.productionRecipe.status === 'OK')\n{\n    const qrcodeBasePath = model.env.qrcodeBasePath\n    const pn = model.productionWorkorder.workorder.pn\n    const lot = model.productionWorkorder.workorder.lot\n    const lotId = model.productionWorkorder.workorder.lotId\n    const stage = model.productionWorkorder.workorder.stage\n\n    workorder = `${pn}|${lot}|${lotId}|${stage}`\n    qrcodeUrl = `${qrcodeBasePath}/qrcode/image.png?message=${workorder}`\n}\n\nconst enabled = model.productionWorkorder.state === 'PRODUCTION_CODE'\nconst productionCode = model.productionWorkorder.productionCode\n\nreturn [\n    {\n        enabled,\n        payload: workorder\n    },\n    {\n        enabled,\n        payload: productionCode.storeStatus\n    },\n    {\n        enabled,\n        payload: productionCode.printStatus\n    },\n    {\n        enabled,\n        payload: qrcodeUrl\n    }\n]\n",
        "outputs": 4,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 1980,
        "wires": [
            [
                "cbebfe22.4fbf1"
            ],
            [
                "28d9ad2b.3a2b42"
            ],
            [
                "e999053f.6ebb38"
            ],
            [
                "4bafd6de.35834"
            ]
        ]
    },
    {
        "id": "4e1647c0.bd4c98",
        "type": "function",
        "z": "e7333943.c4bbc8",
        "name": "",
        "func": "return {\n    topic: 'productionWorkorder.store',\n    payload: {}\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 720,
        "y": 2000,
        "wires": [
            [
                "4c11d973.d583d8"
            ]
        ]
    },
    {
        "id": "ed284fc7.41fe",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "Handle store",
        "func": "if (msg.topic !== 'productionWorkorder.store')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.productionWorkorder.state !== 'PRODUCTION_CODE')\n{\n    node.error('unexpected')\n    return\n}\n\nconst changes = {\n    isOperating: true\n}\n\nmodel.productionWorkorder = Object.assign(model.productionWorkorder, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.productionWorkorder',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 370,
        "y": 2180,
        "wires": [
            [
                "49ed37b1.523d68",
                "2e666996.5b4e76"
            ]
        ]
    },
    {
        "id": "2e666996.5b4e76",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "update recipe",
        "func": "const model = global.get('model')\n\nconst pn = model.productionWorkorder.workorder.pn\nconst lot = model.productionWorkorder.workorder.lot\nconst lotId = model.productionWorkorder.workorder.lotId\nconst stage = model.productionWorkorder.workorder.stage\n\nconst recipeId = `${pn}|${lot}|${lotId}|${stage}`\nconst preProductionRecipe = model.productionWorkorder.preProductionRecipe\n\nreturn {\n    payload: {\n        id: recipeId,\n        ingredients: {\n            etching_speed: preProductionRecipe.etchingSpeedSet,\n            etching_1_up_spray_pressure: preProductionRecipe.etching1UpSprayPressureSet,\n            etching_1_down_spray_pressure: preProductionRecipe.etching1DownSprayPressureSet,\n            etching_2_switch: preProductionRecipe.etching2SwitchSet,\n            etching_3_switch: preProductionRecipe.etching3SwitchSet,\n            develop_speed: preProductionRecipe.developSpeedSet\n        }\n    }\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 400,
        "y": 2220,
        "wires": [
            [
                "d835d66.2943728"
            ]
        ]
    },
    {
        "id": "d835d66.2943728",
        "type": "recipe-update",
        "z": "e2d46b65.8c3d28",
        "name": "",
        "category": "production",
        "x": 460,
        "y": 2260,
        "wires": [
            [
                "f07c6090.c162c"
            ]
        ]
    },
    {
        "id": "f07c6090.c162c",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "validate",
        "func": "const payload = msg.payload\nlet model = global.get('model')\n\nlet productionCode = model.productionWorkorder.productionCode\n\nif (payload.code)\n{\n    productionCode.storeStatus = `KO, ${payload.message}`\n\n    const changes = {\n        isOperating: false,\n        productionCode\n    }\n\n    model.productionWorkorder = Object.assign(model.productionWorkorder, changes)\n    global.set('model', model)\n\n    return [\n        {\n            topic: 'model.productionWorkorder',\n            payload: changes\n        },\n        null\n    ]\n}\n\nreturn [\n    null,\n    {}\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 420,
        "y": 2300,
        "wires": [
            [
                "49ed37b1.523d68"
            ],
            [
                "d4ff0cbf.dbe53"
            ]
        ]
    },
    {
        "id": "927ab721.fcc7d8",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "",
        "func": "const recipe = msg.payload[0]\n\nlet model = global.get('model')\nconst DATE_STRING = global.get('DATE_STRING')\n\nlet productionCode = model.productionWorkorder.productionCode\n\nproductionCode.storeStatus = 'OK'\n\nconst changes = {\n    isOperating: false,\n    productionCode,\n    productionRecipe: {\n        status: 'OK',\n        etchingSpeedSet: recipe.ingredients.etching_speed,\n        etching1UpSprayPressureSet: recipe.ingredients.etching_1_up_spray_pressure,\n        etching1DownSprayPressureSet: recipe.ingredients.etching_1_down_spray_pressure,\n        etching2SwitchSet: recipe.ingredients.etching_2_switch,\n        etching3SwitchSet: recipe.ingredients.etching_3_switch,\n        developSpeedSet: recipe.ingredients.develop_speed,\n        timestamp: DATE_STRING(recipe.updated.at)\n    }\n}\n\nmodel.productionWorkorder = Object.assign(model.productionWorkorder, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.productionWorkorder',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 420,
        "y": 2440,
        "wires": [
            [
                "49ed37b1.523d68"
            ]
        ]
    },
    {
        "id": "8e498210.648c6",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "dummy KO",
        "func": "return {\n    payload: {\n        code: 1,\n        message: 'Update failure'\n    }\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 130,
        "y": 2300,
        "wires": [
            [
                "f07c6090.c162c"
            ]
        ]
    },
    {
        "id": "d3191417.9cb048",
        "type": "function",
        "z": "e7333943.c4bbc8",
        "name": "",
        "func": "return {\n    topic: 'productionWorkorder.print',\n    payload: {}\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 720,
        "y": 2080,
        "wires": [
            [
                "4c11d973.d583d8"
            ]
        ]
    },
    {
        "id": "9e7c0cdc.86c95",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "Handle print",
        "func": "if (msg.topic !== 'productionWorkorder.print')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.productionWorkorder.state !== 'PRODUCTION_CODE')\n{\n    node.error('unexpected')\n    return\n}\n\nconst changes = {\n    isOperating: true\n}\n\nmodel.productionWorkorder = Object.assign(model.productionWorkorder, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.productionWorkorder',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 370,
        "y": 2520,
        "wires": [
            [
                "49ed37b1.523d68",
                "4f6a050e.b59edc"
            ]
        ]
    },
    {
        "id": "4f6a050e.b59edc",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "print",
        "func": "const model = global.get('model')\n\nconst pn = model.productionWorkorder.workorder.pn\nconst lot = model.productionWorkorder.workorder.lot\nconst lotId = model.productionWorkorder.workorder.lotId\nconst stage = model.productionWorkorder.workorder.stage\nconst workorder = `${pn}|${lot}|${lotId}|${stage}`\n\nreturn {\n    url: `http://bullseye/api/v1/qrcode/print`,\n    payload: {\n        message: workorder\n    }\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 370,
        "y": 2560,
        "wires": [
            [
                "e8a10bf1.c7a7d8"
            ]
        ]
    },
    {
        "id": "e8a10bf1.c7a7d8",
        "type": "http request",
        "z": "e2d46b65.8c3d28",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "basic",
        "x": 410,
        "y": 2600,
        "wires": [
            [
                "dde66271.269d"
            ]
        ]
    },
    {
        "id": "dde66271.269d",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "validate",
        "func": "const statusCode = msg.statusCode\nlet model = global.get('model')\n\nlet productionCode = model.productionWorkorder.productionCode\n\nif (statusCode !== 204)\n{\n    productionCode.printStatus = `KO`\n\n    const changes = {\n        isOperating: false,\n        productionCode\n    }\n\n    model.productionWorkorder = Object.assign(model.productionWorkorder, changes)\n    global.set('model', model)\n\n    return [\n        {\n            topic: 'model.productionWorkorder',\n            payload: changes\n        },\n        null\n    ]\n}\n\nreturn [\n    null,\n    {}\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 420,
        "y": 2640,
        "wires": [
            [
                "49ed37b1.523d68"
            ],
            [
                "6b458fb5.40233"
            ]
        ]
    },
    {
        "id": "6b458fb5.40233",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "",
        "func": "let model = global.get('model')\n\nlet productionCode = model.productionWorkorder.productionCode\n\nproductionCode.printStatus = 'OK'\n\nconst changes = {\n    isOperating: false,\n    productionCode\n}\n\nmodel.productionWorkorder = Object.assign(model.productionWorkorder, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.productionWorkorder',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 420,
        "y": 2680,
        "wires": [
            [
                "49ed37b1.523d68"
            ]
        ]
    },
    {
        "id": "ca77df3d.d7ac7",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "dummy KO",
        "func": "return {\n    statusCode: 500,\n    payload: {\n        code: 1,\n        message: 'print failure'\n    }\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 130,
        "y": 2640,
        "wires": [
            [
                "dde66271.269d"
            ]
        ]
    },
    {
        "id": "772c5dd8.e803f4",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "dummy OK",
        "func": "return {\n    statusCode: 204\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 130,
        "y": 2600,
        "wires": [
            [
                "dde66271.269d"
            ]
        ]
    },
    {
        "id": "21807103.e1131e",
        "type": "comment",
        "z": "e7333943.c4bbc8",
        "name": "量產配方",
        "info": "",
        "x": 200,
        "y": 1320,
        "wires": []
    },
    {
        "id": "7201918.9d8ef7",
        "type": "link in",
        "z": "e7333943.c4bbc8",
        "name": "To View",
        "links": [
            "1c425765.6b2309",
            "fae00d5b.4d7cf",
            "fe3b68d5.4d9bb8",
            "dd06c8ba.f3ede8",
            "89789973.e5e468",
            "489ba77a.50c808",
            "5996a99f.a82ad8",
            "e603e132.0cbe1",
            "a6a2f658.b55fa8",
            "774a8f54.a250b",
            "5cc58842.141918",
            "680f0250.6e2a2c",
            "e0443fff.4e35f",
            "49ed37b1.523d68",
            "5b27ed13.a3c814",
            "4abf0a7b.536ba4",
            "f4ddf088.12237",
            "e075a031.de73d",
            "b577d158.09844",
            "aa9618e3.489e98",
            "a50ccc58.1f6dd",
            "9c6f34ec.44c938",
            "8ee38a81.6bdf38",
            "b1be3310.5727e"
        ],
        "x": 155,
        "y": 1480,
        "wires": [
            [
                "33a1812c.b3e8be",
                "c7f867b6.06fd58"
            ]
        ]
    },
    {
        "id": "e581551.ec46ca8",
        "type": "ui_text",
        "z": "e7333943.c4bbc8",
        "group": "7c98d06e.b62ed",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "蝕刻速度",
        "format": "<font color= {{msg.color}} >{{msg.payload}}</font>",
        "layout": "row-spread",
        "x": 520,
        "y": 1460,
        "wires": []
    },
    {
        "id": "5674a392.c024bc",
        "type": "ui_text",
        "z": "e7333943.c4bbc8",
        "group": "7c98d06e.b62ed",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "蝕刻1上噴",
        "format": "<font color= {{msg.color}} >{{msg.payload}}</font>",
        "layout": "row-spread",
        "x": 530,
        "y": 1500,
        "wires": []
    },
    {
        "id": "c7933d3f.b7bcb",
        "type": "ui_text",
        "z": "e7333943.c4bbc8",
        "group": "7c98d06e.b62ed",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "蝕刻1下噴",
        "format": "<font color= {{msg.color}} >{{msg.payload}}</font>",
        "layout": "row-spread",
        "x": 530,
        "y": 1540,
        "wires": []
    },
    {
        "id": "3f7f015d.f22f5e",
        "type": "ui_text",
        "z": "e7333943.c4bbc8",
        "group": "7c98d06e.b62ed",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "蝕刻2開關",
        "format": "<font color= {{msg.color}} >{{msg.payload}}</font>",
        "layout": "row-spread",
        "x": 530,
        "y": 1580,
        "wires": []
    },
    {
        "id": "f0c81610.57e3f8",
        "type": "ui_text",
        "z": "e7333943.c4bbc8",
        "group": "7c98d06e.b62ed",
        "order": 6,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "蝕刻3開關",
        "format": "<font color= {{msg.color}} >{{msg.payload}}</font>",
        "layout": "row-spread",
        "x": 530,
        "y": 1620,
        "wires": []
    },
    {
        "id": "397719ee.475b66",
        "type": "ui_text",
        "z": "e7333943.c4bbc8",
        "group": "7c98d06e.b62ed",
        "order": 7,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "顯影速度",
        "format": "<font color= {{msg.color}} >{{msg.payload}}</font>",
        "layout": "row-spread",
        "x": 520,
        "y": 1660,
        "wires": []
    },
    {
        "id": "e337bc55.2e773",
        "type": "ui_text",
        "z": "e7333943.c4bbc8",
        "group": "7c98d06e.b62ed",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "狀態",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "x": 510,
        "y": 1420,
        "wires": []
    },
    {
        "id": "5734e91b.910e88",
        "type": "ui_text",
        "z": "e7333943.c4bbc8",
        "group": "7c98d06e.b62ed",
        "order": 8,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "時間",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 510,
        "y": 1700,
        "wires": []
    },
    {
        "id": "33a1812c.b3e8be",
        "type": "function",
        "z": "e7333943.c4bbc8",
        "name": "",
        "func": "if (msg.topic !== 'model.productionWorkorder')\n{\n    return\n}\n\nconst model = global.get('model')\n\nconst enabled = model.productionWorkorder.state === 'PRODUCTION_RECIPE'\n  || model.productionWorkorder.state === 'PRODUCTION_CODE'\n\nconst productionRecipe = model.productionWorkorder.productionRecipe\n\nreturn [\n    {\n        enabled,\n        payload: productionRecipe.status\n    },\n    {\n        enabled,\n        color: _is_equal_recipe('etchingSpeedSet') ? 'black': 'red',\n        payload: productionRecipe.etchingSpeedSet\n    },\n    {\n        enabled,\n        color: _is_equal_recipe('etching1UpSprayPressureSet') ? 'black': 'red',\n        payload: productionRecipe.etching1UpSprayPressureSet\n    },\n    {\n        enabled,\n        color: _is_equal_recipe('etching1DownSprayPressureSet') ? 'black': 'red',\n        payload: productionRecipe.etching1DownSprayPressureSet\n    },\n    {\n        enabled,\n        color: _is_equal_recipe('etching2SwitchSet') ? 'black': 'red',\n        payload: productionRecipe.etching2SwitchSet\n    },\n    {\n        enabled,\n        color: _is_equal_recipe('etching3SwitchSet') ? 'black': 'red',\n        payload: productionRecipe.etching3SwitchSet\n    },\n    {\n        enabled,\n        color: _is_equal_recipe('developSpeedSet') ? 'black': 'red',\n        payload: productionRecipe.developSpeedSet\n    },\n    {\n        enabled,\n        payload: productionRecipe.timestamp\n    }\n]\n\n\nfunction _is_equal_recipe(recipe)\n{\n    const preProductionRecipe = model.productionWorkorder.preProductionRecipe\n    const productionRecipe = model.productionWorkorder.productionRecipe\n\n    return preProductionRecipe[recipe] === productionRecipe[recipe]\n}\n",
        "outputs": 8,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 1480,
        "wires": [
            [
                "e337bc55.2e773"
            ],
            [
                "e581551.ec46ca8"
            ],
            [
                "5674a392.c024bc"
            ],
            [
                "c7933d3f.b7bcb"
            ],
            [
                "3f7f015d.f22f5e"
            ],
            [
                "f0c81610.57e3f8"
            ],
            [
                "397719ee.475b66"
            ],
            [
                "5734e91b.910e88"
            ]
        ]
    },
    {
        "id": "61e7872a.8b86c8",
        "type": "comment",
        "z": "e2d46b65.8c3d28",
        "name": "量產配方",
        "info": "",
        "x": 200,
        "y": 1540,
        "wires": []
    },
    {
        "id": "e7fb0dab.36452",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "Handle productionRms",
        "func": "if (msg.topic !== 'productionWorkorder.productionRms')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.productionWorkorder.state !== 'PRODUCTION_RECIPE')\n{\n    node.error('unexpected')\n    return\n}\n\nreturn {}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 420,
        "y": 1620,
        "wires": [
            [
                "e3b5c9f4.8a0688"
            ]
        ]
    },
    {
        "id": "6d610381.b62fac",
        "type": "link in",
        "z": "e2d46b65.8c3d28",
        "name": "To Control",
        "links": [
            "44e76f83.bd737",
            "58e75c96.95b2b4",
            "f9e43485.fec318",
            "b20ba137.be08",
            "b17c3083.dd0c8",
            "b5f7b64b.c7a248",
            "b7b6c644.b328b8",
            "a8c2a30.58b5d6",
            "672a7a09.265094",
            "418f844b.671e2c",
            "8c4b9603.e1aee8",
            "4c11d973.d583d8",
            "73ad0302.9c13ac",
            "ca153323.175d",
            "9fb81c12.c17a1",
            "3d474729.48c3b8",
            "c362751b.9d6ec8",
            "b8efe10f.b23fd",
            "d84a2899.ed42d8",
            "a3a6fb04.90f508",
            "b3f2298f.3de718",
            "cb0d22ed.50e19"
        ],
        "x": 155,
        "y": 1620,
        "wires": [
            [
                "e7fb0dab.36452"
            ]
        ]
    },
    {
        "id": "c7f867b6.06fd58",
        "type": "function",
        "z": "e7333943.c4bbc8",
        "name": "",
        "func": "if (msg.topic !== 'model.productionWorkorder')\n{\n    return\n}\n\nif (msg.payload.state !== 'PRODUCTION_RECIPE')\n{\n    return\n}\n\nreturn {\n    topic: 'productionWorkorder.productionRms',\n    payload: {}\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 300,
        "y": 1760,
        "wires": [
            [
                "73ad0302.9c13ac"
            ]
        ]
    },
    {
        "id": "73ad0302.9c13ac",
        "type": "link out",
        "z": "e7333943.c4bbc8",
        "name": "To Control",
        "links": [
            "3541d990.925686",
            "52efc3ab.55ab6c",
            "7418d21.45ad22c",
            "a7975a02.8a0c88",
            "3b97a635.15979a",
            "bb7671b1.06e21",
            "b0dc5ccf.b1d62",
            "55b00947.ddc508",
            "abb166c.3e09798",
            "6d90df4e.6ef51",
            "61ea8d29.c6a4f4",
            "f45dd390.154fa",
            "d83de82b.db06e8",
            "6d610381.b62fac",
            "bc6010e1.7537c",
            "f99d52f2.f8f68",
            "d3dcc847.1cd478",
            "6b1721e5.459cc",
            "37ba1dd3.f5c012",
            "71a73452.ac13dc",
            "beee06f7.be6498",
            "a9a83c81.2306a",
            "79dbf37.1b4860c"
        ],
        "x": 915,
        "y": 1760,
        "wires": []
    },
    {
        "id": "5b27ed13.a3c814",
        "type": "link out",
        "z": "e2d46b65.8c3d28",
        "name": "To View",
        "links": [
            "1f11def9.bf34a1",
            "25c230cf.7d5c1",
            "906e5b22.4989f8",
            "7b8c2c08.b563e4",
            "78dc8b8f.5838b4",
            "5a694f49.a6dc1",
            "9c023a.051afdc8",
            "ae422560.686178",
            "e6618bc.b92f578",
            "6022ffbc.3bfec",
            "6e7d7659.49a0c8",
            "86c694dd.0d3b58",
            "b00a14bc.49c178",
            "72b20f0d.07717",
            "7201918.9d8ef7",
            "92f89b72.0dfc58",
            "2296d51b.bb473a",
            "fb3100ee.25d73",
            "563d78f.923fb88",
            "4ed6ea6c.5812f4",
            "79ce718d.22dbf",
            "54cc6ac1.ba3754",
            "9cd75563.219f28",
            "2c4b532c.3aee0c",
            "fa88555.452f3a8",
            "fcecc3e7.5eb01",
            "bb14064e.2c38e8"
        ],
        "x": 975,
        "y": 1740,
        "wires": []
    },
    {
        "id": "466bd124.13981",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "validate",
        "func": "const payload = msg.payload\n\nif (payload.length === 0)\n{\n    let model = global.get('model')\n\n    let productionRecipe = model.productionWorkorder.productionRecipe\n    productionRecipe.status = '配方不存在'\n\n    const changes = {\n        state: 'PRODUCTION_CODE',\n        productionRecipe\n    }\n\n    model.productionWorkorder = Object.assign(model.productionWorkorder, changes)\n    global.set('model', model)\n\n    return [\n        {\n            topic: 'model.productionWorkorder',\n            payload: changes\n        },\n        null\n    ]\n}\n\nreturn [\n    null,\n    msg\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 420,
        "y": 1780,
        "wires": [
            [
                "5b27ed13.a3c814"
            ],
            [
                "80b04cad.14412"
            ]
        ]
    },
    {
        "id": "d4ff0cbf.dbe53",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "query recipe",
        "func": "const model = global.get('model')\n\nconst pn = model.productionWorkorder.workorder.pn\nconst lot = model.productionWorkorder.workorder.lot\nconst lotId = model.productionWorkorder.workorder.lotId\nconst stage = model.productionWorkorder.workorder.stage\n\nmsg.config = {\n    filter: [\n        {\n            id: {\n                eq: `${pn}|${lot}|${lotId}|${stage}`\n            }\n        }\n    ]\n}\n\nreturn msg\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 390,
        "y": 2360,
        "wires": [
            [
                "f9c679e2.ec6198"
            ]
        ]
    },
    {
        "id": "f9c679e2.ec6198",
        "type": "recipe-query",
        "z": "e2d46b65.8c3d28",
        "name": "",
        "category": "production",
        "filter": "[]",
        "filterType": "json",
        "sortBy": "[]",
        "sortByType": "json",
        "maxResults": "",
        "x": 450,
        "y": 2400,
        "wires": [
            [
                "927ab721.fcc7d8"
            ]
        ]
    },
    {
        "id": "20416083.2843a",
        "type": "ui_text",
        "z": "833a454f.52ebf8",
        "group": "d3a4a9ae.62a9e8",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "可投料",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 530,
        "y": 180,
        "wires": []
    },
    {
        "id": "3c62660c.87ff9a",
        "type": "ui_text",
        "z": "833a454f.52ebf8",
        "group": "d3a4a9ae.62a9e8",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "E槽",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 530,
        "y": 220,
        "wires": []
    },
    {
        "id": "164a9215.bcea6e",
        "type": "comment",
        "z": "833a454f.52ebf8",
        "name": "投料狀態",
        "info": "",
        "x": 220,
        "y": 120,
        "wires": []
    },
    {
        "id": "92f89b72.0dfc58",
        "type": "link in",
        "z": "833a454f.52ebf8",
        "name": "To view",
        "links": [
            "1c425765.6b2309",
            "489ba77a.50c808",
            "89789973.e5e468",
            "dd06c8ba.f3ede8",
            "fae00d5b.4d7cf",
            "fe3b68d5.4d9bb8",
            "5996a99f.a82ad8",
            "e603e132.0cbe1",
            "a6a2f658.b55fa8",
            "774a8f54.a250b",
            "5cc58842.141918",
            "680f0250.6e2a2c",
            "e0443fff.4e35f",
            "49ed37b1.523d68",
            "5b27ed13.a3c814",
            "4abf0a7b.536ba4",
            "f4ddf088.12237",
            "e075a031.de73d",
            "b577d158.09844",
            "aa9618e3.489e98",
            "a50ccc58.1f6dd",
            "9c6f34ec.44c938",
            "8ee38a81.6bdf38",
            "b1be3310.5727e"
        ],
        "x": 175,
        "y": 200,
        "wires": [
            [
                "dc9a7eb0.73d0d"
            ]
        ]
    },
    {
        "id": "dc9a7eb0.73d0d",
        "type": "function",
        "z": "833a454f.52ebf8",
        "name": "",
        "func": "if (msg.topic !== 'model.reading')\n{\n    return\n}\n\nconst model = global.get('model')\n\nreturn [\n    {\n        payload: model.reading.boardStatus\n    },\n    {\n        payload: model.reading.eSlot\n    }\n]",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 320,
        "y": 200,
        "wires": [
            [
                "20416083.2843a"
            ],
            [
                "3c62660c.87ff9a"
            ]
        ]
    },
    {
        "id": "6611fa09.4334a4",
        "type": "ui_text_input",
        "z": "833a454f.52ebf8",
        "name": "",
        "label": "生產人員編號",
        "tooltip": "",
        "group": "9bf62832.832ea8",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "mode": "text",
        "delay": 300,
        "topic": "topic",
        "topicType": "msg",
        "x": 560,
        "y": 440,
        "wires": [
            [
                "51193f96.8a32a"
            ]
        ]
    },
    {
        "id": "51f5cfe9.0536c",
        "type": "ui_text_input",
        "z": "833a454f.52ebf8",
        "name": "",
        "label": "量產工單碼",
        "tooltip": "",
        "group": "9bf62832.832ea8",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": true,
        "mode": "text",
        "delay": 300,
        "topic": "topic",
        "topicType": "msg",
        "x": 550,
        "y": 480,
        "wires": [
            [
                "c791f1ec.d271e"
            ]
        ]
    },
    {
        "id": "5406c321.31144c",
        "type": "comment",
        "z": "833a454f.52ebf8",
        "name": "輸入",
        "info": "",
        "x": 210,
        "y": 380,
        "wires": []
    },
    {
        "id": "9597e70c.925268",
        "type": "ui_text",
        "z": "833a454f.52ebf8",
        "group": "5fa6bd42.a3e104",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "料號 (PN)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 540,
        "y": 700,
        "wires": []
    },
    {
        "id": "28a4402c.18a5e",
        "type": "ui_text",
        "z": "833a454f.52ebf8",
        "group": "5fa6bd42.a3e104",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "批號 (Lot)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 540,
        "y": 740,
        "wires": []
    },
    {
        "id": "ee124ca6.5557d",
        "type": "ui_text",
        "z": "833a454f.52ebf8",
        "group": "5fa6bd42.a3e104",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "工令 (Lot ID)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 550,
        "y": 780,
        "wires": []
    },
    {
        "id": "4da60d16.d31fe4",
        "type": "ui_text",
        "z": "833a454f.52ebf8",
        "group": "5fa6bd42.a3e104",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "層別 (Stage)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 550,
        "y": 820,
        "wires": []
    },
    {
        "id": "9aa5d872.88ea38",
        "type": "ui_button",
        "z": "833a454f.52ebf8",
        "name": "",
        "group": "5fa6bd42.a3e104",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "確定",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 530,
        "y": 860,
        "wires": [
            [
                "70e297b.1b16f68"
            ]
        ]
    },
    {
        "id": "276b5fe1.aa56e",
        "type": "comment",
        "z": "833a454f.52ebf8",
        "name": "工單內容",
        "info": "",
        "x": 220,
        "y": 640,
        "wires": []
    },
    {
        "id": "49e611cb.f8d17",
        "type": "comment",
        "z": "833a454f.52ebf8",
        "name": "確認站別",
        "info": "",
        "x": 220,
        "y": 1000,
        "wires": []
    },
    {
        "id": "4e325fe.836d5a",
        "type": "ui_text",
        "z": "833a454f.52ebf8",
        "group": "1d217389.2e440c",
        "order": 0,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "狀態",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "x": 530,
        "y": 1060,
        "wires": []
    },
    {
        "id": "25ed68d2.ab0758",
        "type": "ui_text",
        "z": "833a454f.52ebf8",
        "group": "1d217389.2e440c",
        "order": 0,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "當前站別",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 540,
        "y": 1100,
        "wires": []
    },
    {
        "id": "2e30ca1f.4efea6",
        "type": "ui_text",
        "z": "833a454f.52ebf8",
        "group": "1d217389.2e440c",
        "order": 0,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "預期站別",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 540,
        "y": 1140,
        "wires": []
    },
    {
        "id": "1730f19a.4b49be",
        "type": "ui_text",
        "z": "833a454f.52ebf8",
        "group": "19b39d08.770233",
        "order": 1,
        "width": "2",
        "height": "1",
        "name": "",
        "label": "狀態",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "x": 530,
        "y": 1440,
        "wires": []
    },
    {
        "id": "1d88ddd.8191722",
        "type": "ui_button",
        "z": "833a454f.52ebf8",
        "name": "",
        "group": "19b39d08.770233",
        "order": 2,
        "width": "2",
        "height": "1",
        "passthru": false,
        "label": "清除",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 530,
        "y": 1800,
        "wires": [
            [
                "d1645d3a.d003b"
            ]
        ]
    },
    {
        "id": "4bd222bb.28d8ec",
        "type": "ui_text",
        "z": "833a454f.52ebf8",
        "group": "19b39d08.770233",
        "order": 3,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "蝕刻速度",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 540,
        "y": 1480,
        "wires": []
    },
    {
        "id": "7b41cea0.29a71",
        "type": "ui_text",
        "z": "833a454f.52ebf8",
        "group": "19b39d08.770233",
        "order": 4,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "蝕刻1上噴",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 550,
        "y": 1520,
        "wires": []
    },
    {
        "id": "239c16d4.4232aa",
        "type": "ui_text",
        "z": "833a454f.52ebf8",
        "group": "19b39d08.770233",
        "order": 5,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "蝕刻1下噴",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 550,
        "y": 1560,
        "wires": []
    },
    {
        "id": "f1d6af52.24e04",
        "type": "ui_text",
        "z": "833a454f.52ebf8",
        "group": "19b39d08.770233",
        "order": 6,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "蝕刻2開關",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 550,
        "y": 1600,
        "wires": []
    },
    {
        "id": "6b891f74.1c16b",
        "type": "ui_text",
        "z": "833a454f.52ebf8",
        "group": "19b39d08.770233",
        "order": 7,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "蝕刻3開關",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 550,
        "y": 1640,
        "wires": []
    },
    {
        "id": "3f0c0f4b.68d8a",
        "type": "ui_text",
        "z": "833a454f.52ebf8",
        "group": "19b39d08.770233",
        "order": 8,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "顯影速度",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 540,
        "y": 1680,
        "wires": []
    },
    {
        "id": "cf399b37.aa08e8",
        "type": "ui_text",
        "z": "833a454f.52ebf8",
        "group": "19b39d08.770233",
        "order": 10,
        "width": "4",
        "height": "1",
        "name": "",
        "label": "工單碼/量產工單碼",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "x": 570,
        "y": 1720,
        "wires": []
    },
    {
        "id": "7b7ad917.22efa8",
        "type": "ui_text",
        "z": "833a454f.52ebf8",
        "group": "19b39d08.770233",
        "order": 12,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "時間",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "x": 530,
        "y": 1760,
        "wires": []
    },
    {
        "id": "fc7dd090.81134",
        "type": "comment",
        "z": "833a454f.52ebf8",
        "name": "待寫入配方",
        "info": "",
        "x": 220,
        "y": 1380,
        "wires": []
    },
    {
        "id": "665fadd4.bd7404",
        "type": "function",
        "z": "833a454f.52ebf8",
        "name": "",
        "func": "if (msg.topic !== 'model.pendingRecipe')\n{\n    return\n}\n\nconst model = global.get('model')\n\nreturn {\n    payload: model.pendingRecipe.status\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 320,
        "y": 1440,
        "wires": [
            [
                "1730f19a.4b49be"
            ]
        ]
    },
    {
        "id": "2296d51b.bb473a",
        "type": "link in",
        "z": "833a454f.52ebf8",
        "name": "To View",
        "links": [
            "1c425765.6b2309",
            "489ba77a.50c808",
            "5996a99f.a82ad8",
            "89789973.e5e468",
            "dd06c8ba.f3ede8",
            "fae00d5b.4d7cf",
            "fe3b68d5.4d9bb8",
            "e603e132.0cbe1",
            "a6a2f658.b55fa8",
            "774a8f54.a250b",
            "5cc58842.141918",
            "680f0250.6e2a2c",
            "e0443fff.4e35f",
            "49ed37b1.523d68",
            "5b27ed13.a3c814",
            "4abf0a7b.536ba4",
            "f4ddf088.12237",
            "e075a031.de73d",
            "b577d158.09844",
            "aa9618e3.489e98",
            "a50ccc58.1f6dd",
            "9c6f34ec.44c938",
            "8ee38a81.6bdf38",
            "b1be3310.5727e"
        ],
        "x": 175,
        "y": 1440,
        "wires": [
            [
                "665fadd4.bd7404",
                "70d12e68.c0186",
                "d69dbf09.de3cc",
                "5624cac0.ee1824"
            ]
        ]
    },
    {
        "id": "70d12e68.c0186",
        "type": "function",
        "z": "833a454f.52ebf8",
        "name": "",
        "func": "if (msg.topic !== 'model.pendingRecipe')\n{\n    return\n}\n\nconst model = global.get('model')\nconst pendingRecipe = model.pendingRecipe\n\nif (pendingRecipe.status === 'OK')\n{\n    return\n}\n\nreturn [\n    {\n        payload: pendingRecipe.etchingSpeedSet\n    },\n    {\n        payload: pendingRecipe.etching1UpSprayPressureSet\n    },\n    {\n        payload: pendingRecipe.etching1DownSprayPressureSet\n    },\n    {\n        payload: pendingRecipe.etching2SwitchSet\n    },\n    {\n        payload: pendingRecipe.etching3SwitchSet\n    },\n    {\n        payload: pendingRecipe.developSpeedSet\n    },\n    {\n        payload: pendingRecipe.workorder\n    }\n]\n",
        "outputs": 7,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 320,
        "y": 1520,
        "wires": [
            [
                "4bd222bb.28d8ec"
            ],
            [
                "7b41cea0.29a71"
            ],
            [
                "239c16d4.4232aa"
            ],
            [
                "f1d6af52.24e04"
            ],
            [
                "6b891f74.1c16b"
            ],
            [
                "3f0c0f4b.68d8a"
            ],
            [
                "cf399b37.aa08e8"
            ]
        ]
    },
    {
        "id": "d69dbf09.de3cc",
        "type": "function",
        "z": "833a454f.52ebf8",
        "name": "",
        "func": "if (msg.topic !== 'model.pendingRecipe')\n{\n    return\n}\n\nconst model = global.get('model')\nconst pendingRecipe = model.pendingRecipe\n\nconst enabled = pendingRecipe.status === 'READY'\n  && pendingRecipe.etchingSpeedSet\n  && pendingRecipe.etching1UpSprayPressureSet\n  && pendingRecipe.etching1DownSprayPressureSet\n  && pendingRecipe.etching2SwitchSet\n  && pendingRecipe.etching3SwitchSet\n  && pendingRecipe.developSpeedSet\n\nreturn {\n    enabled\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 320,
        "y": 1800,
        "wires": [
            [
                "1d88ddd.8191722"
            ]
        ]
    },
    {
        "id": "5624cac0.ee1824",
        "type": "function",
        "z": "833a454f.52ebf8",
        "name": "",
        "func": "if (msg.topic !== 'model.pendingRecipe')\n{\n    return\n}\n\nconst model = global.get('model')\n\nreturn {\n    payload: model.pendingRecipe.recipeTimestamp\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 320,
        "y": 1760,
        "wires": [
            [
                "7b7ad917.22efa8"
            ]
        ]
    },
    {
        "id": "d1645d3a.d003b",
        "type": "function",
        "z": "833a454f.52ebf8",
        "name": "",
        "func": "return {\n    topic: 'production.clear',\n    payload: {}\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 720,
        "y": 1800,
        "wires": [
            [
                "ca153323.175d"
            ]
        ]
    },
    {
        "id": "ca153323.175d",
        "type": "link out",
        "z": "833a454f.52ebf8",
        "name": "To Control",
        "links": [
            "3541d990.925686",
            "3b97a635.15979a",
            "52efc3ab.55ab6c",
            "7418d21.45ad22c",
            "a7975a02.8a0c88",
            "bb7671b1.06e21",
            "b0dc5ccf.b1d62",
            "55b00947.ddc508",
            "abb166c.3e09798",
            "6d90df4e.6ef51",
            "61ea8d29.c6a4f4",
            "f45dd390.154fa",
            "d83de82b.db06e8",
            "6d610381.b62fac",
            "bc6010e1.7537c",
            "f99d52f2.f8f68",
            "d3dcc847.1cd478",
            "6b1721e5.459cc",
            "37ba1dd3.f5c012",
            "71a73452.ac13dc",
            "beee06f7.be6498",
            "a9a83c81.2306a",
            "79dbf37.1b4860c"
        ],
        "x": 935,
        "y": 1800,
        "wires": []
    },
    {
        "id": "721993d0.8d137c",
        "type": "comment",
        "z": "91f6d9cd.bc6648",
        "name": "initialize",
        "info": "",
        "x": 190,
        "y": 120,
        "wires": []
    },
    {
        "id": "bc6010e1.7537c",
        "type": "link in",
        "z": "91f6d9cd.bc6648",
        "name": "To Control",
        "links": [
            "44e76f83.bd737",
            "58e75c96.95b2b4",
            "b17c3083.dd0c8",
            "b20ba137.be08",
            "b5f7b64b.c7a248",
            "b7b6c644.b328b8",
            "f9e43485.fec318",
            "a8c2a30.58b5d6",
            "672a7a09.265094",
            "418f844b.671e2c",
            "8c4b9603.e1aee8",
            "4c11d973.d583d8",
            "73ad0302.9c13ac",
            "ca153323.175d",
            "9fb81c12.c17a1",
            "3d474729.48c3b8",
            "c362751b.9d6ec8",
            "b8efe10f.b23fd",
            "d84a2899.ed42d8",
            "a3a6fb04.90f508",
            "b3f2298f.3de718",
            "cb0d22ed.50e19"
        ],
        "x": 155,
        "y": 200,
        "wires": [
            [
                "cb90340c.081028"
            ]
        ]
    },
    {
        "id": "cb90340c.081028",
        "type": "function",
        "z": "91f6d9cd.bc6648",
        "name": "Handle initialize",
        "func": "if (msg.topic !== 'initialize')\n{\n    return\n}\n\nconst changes = {\n    state: 'INPUT',\n\n    input: {\n        operator: '',\n        workorder: ''\n    },\n    workorder: {\n        lotId: '',\n        pn: '',\n        lot: '',\n        stage: ''\n    },\n    stageResult: {\n        status: 'N/A',\n        // TODO 當前站別\n        // TODO 預期站別\n    }\n}\n\nlet model = global.get('model')\nmodel.production = Object.assign(model.production, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.production',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 400,
        "y": 200,
        "wires": [
            [
                "4abf0a7b.536ba4"
            ]
        ]
    },
    {
        "id": "4abf0a7b.536ba4",
        "type": "link out",
        "z": "91f6d9cd.bc6648",
        "name": "To View",
        "links": [
            "1f11def9.bf34a1",
            "25c230cf.7d5c1",
            "5a694f49.a6dc1",
            "6022ffbc.3bfec",
            "78dc8b8f.5838b4",
            "7b8c2c08.b563e4",
            "906e5b22.4989f8",
            "ae422560.686178",
            "e6618bc.b92f578",
            "6e7d7659.49a0c8",
            "86c694dd.0d3b58",
            "b00a14bc.49c178",
            "72b20f0d.07717",
            "7201918.9d8ef7",
            "92f89b72.0dfc58",
            "2296d51b.bb473a",
            "fb3100ee.25d73",
            "563d78f.923fb88",
            "4ed6ea6c.5812f4",
            "79ce718d.22dbf",
            "54cc6ac1.ba3754",
            "9cd75563.219f28",
            "2c4b532c.3aee0c",
            "fa88555.452f3a8",
            "fcecc3e7.5eb01",
            "bb14064e.2c38e8"
        ],
        "x": 975,
        "y": 200,
        "wires": []
    },
    {
        "id": "fb3100ee.25d73",
        "type": "link in",
        "z": "833a454f.52ebf8",
        "name": "To View",
        "links": [
            "1c425765.6b2309",
            "fae00d5b.4d7cf",
            "fe3b68d5.4d9bb8",
            "dd06c8ba.f3ede8",
            "89789973.e5e468",
            "489ba77a.50c808",
            "5996a99f.a82ad8",
            "e603e132.0cbe1",
            "a6a2f658.b55fa8",
            "774a8f54.a250b",
            "5cc58842.141918",
            "680f0250.6e2a2c",
            "e0443fff.4e35f",
            "49ed37b1.523d68",
            "5b27ed13.a3c814",
            "4abf0a7b.536ba4",
            "f4ddf088.12237",
            "e075a031.de73d",
            "b577d158.09844",
            "aa9618e3.489e98",
            "a50ccc58.1f6dd",
            "9c6f34ec.44c938",
            "8ee38a81.6bdf38",
            "b1be3310.5727e"
        ],
        "x": 175,
        "y": 460,
        "wires": [
            [
                "60c5d76d.c6c0d8"
            ]
        ]
    },
    {
        "id": "60c5d76d.c6c0d8",
        "type": "function",
        "z": "833a454f.52ebf8",
        "name": "",
        "func": "if (msg.topic !== 'model.production')\n{\n    return\n}\n\nconst model = global.get('model')\n\nconst enabled = model.production.state === 'INPUT'\n\nreturn [\n    {\n        enabled,\n        payload: model.production.input.operator\n    },\n    {\n        enabled,\n        payload: model.production.input.workorder\n    }\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 320,
        "y": 460,
        "wires": [
            [
                "6611fa09.4334a4"
            ],
            [
                "51f5cfe9.0536c"
            ]
        ]
    },
    {
        "id": "51193f96.8a32a",
        "type": "function",
        "z": "833a454f.52ebf8",
        "name": "",
        "func": "const operator = msg.payload\n\nreturn {\n    topic: 'production.operator',\n    payload: {\n        operator: operator\n    }\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 760,
        "y": 440,
        "wires": [
            [
                "9fb81c12.c17a1"
            ]
        ]
    },
    {
        "id": "c791f1ec.d271e",
        "type": "function",
        "z": "833a454f.52ebf8",
        "name": "",
        "func": "const workorder = msg.payload\n\nreturn {\n    topic: 'production.workorder',\n    payload: {\n        workorder: workorder\n    }\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 760,
        "y": 480,
        "wires": [
            [
                "9fb81c12.c17a1"
            ]
        ]
    },
    {
        "id": "9fb81c12.c17a1",
        "type": "link out",
        "z": "833a454f.52ebf8",
        "name": "To Control",
        "links": [
            "3541d990.925686",
            "52efc3ab.55ab6c",
            "7418d21.45ad22c",
            "a7975a02.8a0c88",
            "3b97a635.15979a",
            "bb7671b1.06e21",
            "b0dc5ccf.b1d62",
            "55b00947.ddc508",
            "abb166c.3e09798",
            "6d90df4e.6ef51",
            "61ea8d29.c6a4f4",
            "f45dd390.154fa",
            "d83de82b.db06e8",
            "6d610381.b62fac",
            "bc6010e1.7537c",
            "f99d52f2.f8f68",
            "d3dcc847.1cd478",
            "6b1721e5.459cc",
            "37ba1dd3.f5c012",
            "71a73452.ac13dc",
            "beee06f7.be6498",
            "a9a83c81.2306a",
            "79dbf37.1b4860c"
        ],
        "x": 935,
        "y": 480,
        "wires": []
    },
    {
        "id": "e8720936.7ea0a8",
        "type": "comment",
        "z": "91f6d9cd.bc6648",
        "name": "輸入",
        "info": "",
        "x": 190,
        "y": 360,
        "wires": []
    },
    {
        "id": "f99d52f2.f8f68",
        "type": "link in",
        "z": "91f6d9cd.bc6648",
        "name": "To Control",
        "links": [
            "58e75c96.95b2b4",
            "f9e43485.fec318",
            "44e76f83.bd737",
            "b20ba137.be08",
            "b17c3083.dd0c8",
            "b5f7b64b.c7a248",
            "b7b6c644.b328b8",
            "a8c2a30.58b5d6",
            "672a7a09.265094",
            "418f844b.671e2c",
            "8c4b9603.e1aee8",
            "4c11d973.d583d8",
            "73ad0302.9c13ac",
            "ca153323.175d",
            "9fb81c12.c17a1",
            "3d474729.48c3b8",
            "c362751b.9d6ec8",
            "b8efe10f.b23fd",
            "d84a2899.ed42d8",
            "a3a6fb04.90f508",
            "b3f2298f.3de718",
            "cb0d22ed.50e19"
        ],
        "x": 155,
        "y": 440,
        "wires": [
            [
                "49437ab2.0f0ff4",
                "525504d5.37334c"
            ]
        ]
    },
    {
        "id": "49437ab2.0f0ff4",
        "type": "function",
        "z": "91f6d9cd.bc6648",
        "name": "Handle operator",
        "func": "if (msg.topic !== 'production.operator')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.production.state !== 'INPUT')\n{\n    node.error('unexpected')\n    return\n}\n\nconst operator = msg.payload.operator\nlet input = model.production.input\n\ninput.operator = operator\n\nconst changes = {\n    input\n}\n\nmodel.production = Object.assign(model.production, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.production',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 400,
        "y": 440,
        "wires": [
            [
                "f4ddf088.12237"
            ]
        ]
    },
    {
        "id": "f4ddf088.12237",
        "type": "link out",
        "z": "91f6d9cd.bc6648",
        "name": "To View",
        "links": [
            "1f11def9.bf34a1",
            "25c230cf.7d5c1",
            "906e5b22.4989f8",
            "7b8c2c08.b563e4",
            "78dc8b8f.5838b4",
            "5a694f49.a6dc1",
            "9c023a.051afdc8",
            "ae422560.686178",
            "e6618bc.b92f578",
            "6022ffbc.3bfec",
            "6e7d7659.49a0c8",
            "86c694dd.0d3b58",
            "b00a14bc.49c178",
            "72b20f0d.07717",
            "7201918.9d8ef7",
            "92f89b72.0dfc58",
            "2296d51b.bb473a",
            "fb3100ee.25d73",
            "563d78f.923fb88",
            "4ed6ea6c.5812f4",
            "79ce718d.22dbf",
            "54cc6ac1.ba3754",
            "9cd75563.219f28",
            "2c4b532c.3aee0c",
            "fa88555.452f3a8",
            "fcecc3e7.5eb01",
            "bb14064e.2c38e8"
        ],
        "x": 975,
        "y": 500,
        "wires": []
    },
    {
        "id": "525504d5.37334c",
        "type": "function",
        "z": "91f6d9cd.bc6648",
        "name": "Handle workorder (量產工單碼)",
        "func": "if (msg.topic !== 'production.workorder')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.production.state !== 'INPUT')\n{\n    node.error('unexpected')\n    return\n}\n\nconst workorder = msg.payload.workorder\n\nlet exp = /^[0-9A-Z]+\\|[0-9]+\\|[0-9A-Z.]+\\|[0-9A-Z]+$/ig\n\nif (!exp.test(workorder))\n{\n    return [null, msg]\n}\n\nlet splitted = workorder.split('|')\nlet pn = splitted[0]\nlet lot = splitted[1]\nlet lotId = splitted[2]\nlet stage = splitted[3]\n\nlet input = model.production.input\ninput.workorder = workorder\n\nconst changes = {\n    input,\n    workorder: {\n        lotId: lotId,\n        pn: pn,\n        lot: lot,\n        stage: stage\n    }\n}\n\nmodel.production = Object.assign(model.production, changes)\nglobal.set('model', model)\n\nreturn [\n    {\n        topic: 'model.production',\n        payload: changes\n    },\n    null\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 450,
        "y": 540,
        "wires": [
            [
                "f4ddf088.12237"
            ],
            [
                "6d81743e.20b63c"
            ]
        ]
    },
    {
        "id": "563d78f.923fb88",
        "type": "link in",
        "z": "833a454f.52ebf8",
        "name": "To View",
        "links": [
            "1c425765.6b2309",
            "fae00d5b.4d7cf",
            "fe3b68d5.4d9bb8",
            "dd06c8ba.f3ede8",
            "89789973.e5e468",
            "489ba77a.50c808",
            "5996a99f.a82ad8",
            "e603e132.0cbe1",
            "a6a2f658.b55fa8",
            "774a8f54.a250b",
            "5cc58842.141918",
            "680f0250.6e2a2c",
            "e0443fff.4e35f",
            "49ed37b1.523d68",
            "5b27ed13.a3c814",
            "4abf0a7b.536ba4",
            "f4ddf088.12237",
            "e075a031.de73d",
            "b577d158.09844",
            "aa9618e3.489e98",
            "a50ccc58.1f6dd",
            "9c6f34ec.44c938",
            "8ee38a81.6bdf38",
            "b1be3310.5727e"
        ],
        "x": 175,
        "y": 720,
        "wires": [
            [
                "aef0ddb5.d4058",
                "6eb85bb.4d582a4"
            ]
        ]
    },
    {
        "id": "aef0ddb5.d4058",
        "type": "function",
        "z": "833a454f.52ebf8",
        "name": "",
        "func": "if (msg.topic !== 'model.production')\n{\n    return\n}\n\nconst model = global.get('model')\n\nconst enabled = model.production.state === 'INPUT'\n\nreturn [\n    {\n        enabled,\n        payload: model.production.workorder.pn\n    },\n    {\n        enabled,\n        payload: model.production.workorder.lot\n    },\n    {\n        enabled,\n        payload: model.production.workorder.lotId\n    },\n    {\n        enabled,\n        payload: model.production.workorder.stage\n    }\n]\n",
        "outputs": 4,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 320,
        "y": 720,
        "wires": [
            [
                "9597e70c.925268"
            ],
            [
                "28a4402c.18a5e"
            ],
            [
                "ee124ca6.5557d"
            ],
            [
                "4da60d16.d31fe4"
            ]
        ]
    },
    {
        "id": "6d81743e.20b63c",
        "type": "function",
        "z": "91f6d9cd.bc6648",
        "name": "Handle workorder (parse error)",
        "func": "if (msg.topic !== 'production.workorder')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.production.state !== 'INPUT')\n{\n    node.error('unexpected')\n    return\n}\n\nlet input = model.production.input\ninput.workorder = msg.payload.workorder\n\nconst changes = {\n    input,\n    workorder: {\n        lotId: '',\n        pn: '',\n        lot: '',\n        stage: ''\n    }\n}\n\nmodel.production = Object.assign(model.production, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.production',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 450,
        "y": 580,
        "wires": [
            [
                "f4ddf088.12237"
            ]
        ]
    },
    {
        "id": "6eb85bb.4d582a4",
        "type": "function",
        "z": "833a454f.52ebf8",
        "name": "",
        "func": "if (msg.topic !== 'model.production' && msg.topic !== 'model.pendingRecipe')\n{\n    return\n}\n\nconst model = global.get('model')\n\nconst enabled = model.production.state === 'INPUT'\n && model.production.workorder.lotId\n && model.production.workorder.pn\n && model.production.workorder.lot\n && model.production.workorder.stage\n && !model.pendingRecipe.etchingSpeedSet\n && !model.pendingRecipe.etching1UpSprayPressureSet\n && !model.pendingRecipe.etching1DownSprayPressureSet\n && !model.pendingRecipe.etching2SwitchSet\n && !model.pendingRecipe.etching3SwitchSet\n && !model.pendingRecipe.developSpeedSet\n\nreturn {\n    enabled\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 320,
        "y": 860,
        "wires": [
            [
                "9aa5d872.88ea38"
            ]
        ]
    },
    {
        "id": "70e297b.1b16f68",
        "type": "function",
        "z": "833a454f.52ebf8",
        "name": "",
        "func": "return {\n    topic: 'production.confirmWorkorder',\n    payload: {}\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 760,
        "y": 860,
        "wires": [
            [
                "3d474729.48c3b8"
            ]
        ]
    },
    {
        "id": "3d474729.48c3b8",
        "type": "link out",
        "z": "833a454f.52ebf8",
        "name": "To Control",
        "links": [
            "3541d990.925686",
            "52efc3ab.55ab6c",
            "7418d21.45ad22c",
            "a7975a02.8a0c88",
            "3b97a635.15979a",
            "bb7671b1.06e21",
            "b0dc5ccf.b1d62",
            "55b00947.ddc508",
            "abb166c.3e09798",
            "6d90df4e.6ef51",
            "61ea8d29.c6a4f4",
            "f45dd390.154fa",
            "d83de82b.db06e8",
            "6d610381.b62fac",
            "bc6010e1.7537c",
            "f99d52f2.f8f68",
            "d3dcc847.1cd478",
            "6b1721e5.459cc",
            "37ba1dd3.f5c012",
            "71a73452.ac13dc",
            "beee06f7.be6498",
            "a9a83c81.2306a",
            "79dbf37.1b4860c"
        ],
        "x": 935,
        "y": 860,
        "wires": []
    },
    {
        "id": "b2cbdb02.d72c28",
        "type": "comment",
        "z": "91f6d9cd.bc6648",
        "name": "工單內容",
        "info": "",
        "x": 200,
        "y": 720,
        "wires": []
    },
    {
        "id": "d3dcc847.1cd478",
        "type": "link in",
        "z": "91f6d9cd.bc6648",
        "name": "To Control",
        "links": [
            "44e76f83.bd737",
            "58e75c96.95b2b4",
            "f9e43485.fec318",
            "b20ba137.be08",
            "b17c3083.dd0c8",
            "b5f7b64b.c7a248",
            "b7b6c644.b328b8",
            "a8c2a30.58b5d6",
            "672a7a09.265094",
            "418f844b.671e2c",
            "8c4b9603.e1aee8",
            "4c11d973.d583d8",
            "73ad0302.9c13ac",
            "ca153323.175d",
            "9fb81c12.c17a1",
            "3d474729.48c3b8",
            "c362751b.9d6ec8",
            "b8efe10f.b23fd",
            "d84a2899.ed42d8",
            "a3a6fb04.90f508",
            "b3f2298f.3de718",
            "cb0d22ed.50e19"
        ],
        "x": 155,
        "y": 800,
        "wires": [
            [
                "2b766095.97107"
            ]
        ]
    },
    {
        "id": "2b766095.97107",
        "type": "function",
        "z": "91f6d9cd.bc6648",
        "name": "Handle confirmWorkorder",
        "func": "if (msg.topic !== 'production.confirmWorkorder')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.production.state !== 'INPUT')\n{\n    node.error('unexpected')\n    return\n}\n\nlet changes = {\n    state: 'MES'\n}\n\nmodel.production = Object.assign(model.production, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.production',\n    payload: changes\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 430,
        "y": 800,
        "wires": [
            [
                "e075a031.de73d"
            ]
        ]
    },
    {
        "id": "e075a031.de73d",
        "type": "link out",
        "z": "91f6d9cd.bc6648",
        "name": "To View",
        "links": [
            "1f11def9.bf34a1",
            "25c230cf.7d5c1",
            "906e5b22.4989f8",
            "7b8c2c08.b563e4",
            "78dc8b8f.5838b4",
            "5a694f49.a6dc1",
            "9c023a.051afdc8",
            "ae422560.686178",
            "e6618bc.b92f578",
            "6022ffbc.3bfec",
            "6e7d7659.49a0c8",
            "86c694dd.0d3b58",
            "b00a14bc.49c178",
            "72b20f0d.07717",
            "7201918.9d8ef7",
            "92f89b72.0dfc58",
            "2296d51b.bb473a",
            "fb3100ee.25d73",
            "563d78f.923fb88",
            "4ed6ea6c.5812f4",
            "79ce718d.22dbf",
            "54cc6ac1.ba3754",
            "9cd75563.219f28",
            "2c4b532c.3aee0c",
            "fa88555.452f3a8",
            "fcecc3e7.5eb01",
            "bb14064e.2c38e8"
        ],
        "x": 975,
        "y": 800,
        "wires": []
    },
    {
        "id": "79ce718d.22dbf",
        "type": "link in",
        "z": "833a454f.52ebf8",
        "name": "To View",
        "links": [
            "1c425765.6b2309",
            "fae00d5b.4d7cf",
            "fe3b68d5.4d9bb8",
            "dd06c8ba.f3ede8",
            "89789973.e5e468",
            "489ba77a.50c808",
            "5996a99f.a82ad8",
            "e603e132.0cbe1",
            "a6a2f658.b55fa8",
            "774a8f54.a250b",
            "5cc58842.141918",
            "680f0250.6e2a2c",
            "e0443fff.4e35f",
            "49ed37b1.523d68",
            "5b27ed13.a3c814",
            "4abf0a7b.536ba4",
            "f4ddf088.12237",
            "e075a031.de73d",
            "b577d158.09844",
            "aa9618e3.489e98",
            "a50ccc58.1f6dd",
            "9c6f34ec.44c938",
            "8ee38a81.6bdf38",
            "b1be3310.5727e"
        ],
        "x": 175,
        "y": 1080,
        "wires": [
            [
                "eaf691c3.76e1c",
                "d5acf88d.52f5c8"
            ]
        ]
    },
    {
        "id": "eaf691c3.76e1c",
        "type": "function",
        "z": "833a454f.52ebf8",
        "name": "",
        "func": "if (msg.topic !== 'model.production')\n{\n    return\n}\n\nconst model = global.get('model')\n\nconst enabled = model.production.state === 'MES'\n\nreturn [\n    {\n        enabled,\n        payload: model.production.stageResult.status\n    },\n    {\n        enabled,\n        // payload: model.production.stageResult. // TODO\n    },\n    {\n        enabled,\n        // payload: model.production.stageResult. // TODO\n    }\n]\n",
        "outputs": 3,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 320,
        "y": 1080,
        "wires": [
            [
                "4e325fe.836d5a"
            ],
            [
                "25ed68d2.ab0758"
            ],
            [
                "2e30ca1f.4efea6"
            ]
        ]
    },
    {
        "id": "d5acf88d.52f5c8",
        "type": "function",
        "z": "833a454f.52ebf8",
        "name": "",
        "func": "if (msg.topic !== 'model.production')\n{\n    return\n}\n\nif (msg.payload.state !== 'MES')\n{\n    return\n}\n\nreturn {\n    topic: 'production.mes',\n    payload: {}\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 320,
        "y": 1220,
        "wires": [
            [
                "b8efe10f.b23fd"
            ]
        ]
    },
    {
        "id": "b8efe10f.b23fd",
        "type": "link out",
        "z": "833a454f.52ebf8",
        "name": "To Control",
        "links": [
            "3541d990.925686",
            "52efc3ab.55ab6c",
            "7418d21.45ad22c",
            "a7975a02.8a0c88",
            "3b97a635.15979a",
            "bb7671b1.06e21",
            "b0dc5ccf.b1d62",
            "55b00947.ddc508",
            "abb166c.3e09798",
            "6d90df4e.6ef51",
            "61ea8d29.c6a4f4",
            "f45dd390.154fa",
            "d83de82b.db06e8",
            "6d610381.b62fac",
            "bc6010e1.7537c",
            "f99d52f2.f8f68",
            "d3dcc847.1cd478",
            "6b1721e5.459cc",
            "37ba1dd3.f5c012",
            "71a73452.ac13dc",
            "beee06f7.be6498",
            "a9a83c81.2306a",
            "79dbf37.1b4860c"
        ],
        "x": 935,
        "y": 1220,
        "wires": []
    },
    {
        "id": "fb047c4d.47b3",
        "type": "comment",
        "z": "91f6d9cd.bc6648",
        "name": "確認站別",
        "info": "",
        "x": 200,
        "y": 960,
        "wires": []
    },
    {
        "id": "6b1721e5.459cc",
        "type": "link in",
        "z": "91f6d9cd.bc6648",
        "name": "To Control",
        "links": [
            "44e76f83.bd737",
            "58e75c96.95b2b4",
            "b20ba137.be08",
            "f9e43485.fec318",
            "b17c3083.dd0c8",
            "b5f7b64b.c7a248",
            "b7b6c644.b328b8",
            "a8c2a30.58b5d6",
            "672a7a09.265094",
            "418f844b.671e2c",
            "8c4b9603.e1aee8",
            "4c11d973.d583d8",
            "73ad0302.9c13ac",
            "ca153323.175d",
            "9fb81c12.c17a1",
            "3d474729.48c3b8",
            "c362751b.9d6ec8",
            "b8efe10f.b23fd",
            "d84a2899.ed42d8",
            "a3a6fb04.90f508",
            "b3f2298f.3de718",
            "cb0d22ed.50e19"
        ],
        "x": 155,
        "y": 1040,
        "wires": [
            [
                "1cf91d1a.b71823"
            ]
        ]
    },
    {
        "id": "1cf91d1a.b71823",
        "type": "function",
        "z": "91f6d9cd.bc6648",
        "name": "Handle mes",
        "func": "if (msg.topic !== 'production.mes')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.production.state !== 'MES')\n{\n    node.error('unexpected')\n    return\n}\n\nlet stageResult = model.production.stageResult\nstageResult.status = 'REQUESTING'\n\nlet changes = {\n    stageResult\n}\n\nmodel.production = Object.assign(model.production, changes)\nglobal.set('model', model)\n\nreturn [\n    {\n        topic: 'model.production',\n        payload: changes\n    },\n    {}\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 390,
        "y": 1040,
        "wires": [
            [
                "b577d158.09844"
            ],
            [
                "21ccb6ad.23968a"
            ]
        ]
    },
    {
        "id": "21ccb6ad.23968a",
        "type": "function",
        "z": "91f6d9cd.bc6648",
        "name": "",
        "func": "// TODO visit unimicron to test\n\nconst model = global.get('model')\n\nreturn {\n    payload: {\n        method: 'EPL_Check',\n\n        args: {\n            pLotid: model.production.workorder.lotId,\n            pUserID: model.env.epl.userId,\n            pPWD: model.env.epl.pwd,\n            pStage: model.production.workorder.stage,\n            pEMS_EQID: model.env.machineNo\n        }\n    }\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 380,
        "y": 1120,
        "wires": [
            [
                "a24e933f.53fda"
            ]
        ]
    },
    {
        "id": "a24e933f.53fda",
        "type": "soap",
        "z": "91f6d9cd.bc6648",
        "name": "",
        "wsdlUrl": "http://10.13.66.33/ws_promis/Service.asmx?WSDL",
        "username": "",
        "password": "",
        "x": 550,
        "y": 1120,
        "wires": [
            [
                "33dbff61.7f5a3"
            ]
        ]
    },
    {
        "id": "33dbff61.7f5a3",
        "type": "function",
        "z": "91f6d9cd.bc6648",
        "name": "",
        "func": "// TODO visit unimicron to test\n\nlet changes = {}\ndo {\n    if (msg.payload.code) {\n        changes = {\n            state: 'INPUT',\n            stageResult: {\n                status: `KO ${msg.payload.code}`\n            }\n        }\n        break\n    }\n\n    const result = msg.payload.result\n\n    const arrived = !!result.EPL_CheckResult.PRO_EQPID\n\n    if (!arrived) {\n        changes = {\n            state: 'INPUT',\n            stageResult: {\n                status: `未到站`\n            }\n        }\n        break\n    }\n\n    changes = {\n        stageResult: {\n            status: 'OK'\n        }\n    }\n} while (false);\n\nlet model = global.get('model')\nmodel.production = Object.assign(model.production, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.production',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 720,
        "y": 1120,
        "wires": [
            [
                "b577d158.09844",
                "fc988fe7.eb42e"
            ]
        ]
    },
    {
        "id": "ae80407e.7c498",
        "type": "delay",
        "z": "91f6d9cd.bc6648",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 380,
        "y": 1180,
        "wires": [
            [
                "b028e05b.35faa"
            ]
        ]
    },
    {
        "id": "b028e05b.35faa",
        "type": "function",
        "z": "91f6d9cd.bc6648",
        "name": "dummy OK",
        "func": "const changes = {\n    stageResult: {\n        status: 'OK'\n    }\n}\n\nlet model = global.get('model')\n\nmodel.production = Object.assign(model.production, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.production',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 590,
        "y": 1180,
        "wires": [
            [
                "b577d158.09844",
                "fc988fe7.eb42e"
            ]
        ]
    },
    {
        "id": "b577d158.09844",
        "type": "link out",
        "z": "91f6d9cd.bc6648",
        "name": "To View",
        "links": [
            "1f11def9.bf34a1",
            "25c230cf.7d5c1",
            "906e5b22.4989f8",
            "7b8c2c08.b563e4",
            "78dc8b8f.5838b4",
            "5a694f49.a6dc1",
            "9c023a.051afdc8",
            "ae422560.686178",
            "e6618bc.b92f578",
            "6022ffbc.3bfec",
            "6e7d7659.49a0c8",
            "86c694dd.0d3b58",
            "b00a14bc.49c178",
            "72b20f0d.07717",
            "7201918.9d8ef7",
            "92f89b72.0dfc58",
            "2296d51b.bb473a",
            "fb3100ee.25d73",
            "563d78f.923fb88",
            "4ed6ea6c.5812f4",
            "79ce718d.22dbf",
            "54cc6ac1.ba3754",
            "9cd75563.219f28",
            "2c4b532c.3aee0c",
            "fa88555.452f3a8",
            "fcecc3e7.5eb01",
            "bb14064e.2c38e8"
        ],
        "x": 975,
        "y": 1040,
        "wires": []
    },
    {
        "id": "c0f3458b.97f8b8",
        "type": "delay",
        "z": "91f6d9cd.bc6648",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 380,
        "y": 1220,
        "wires": [
            [
                "ec38c533.8c9d68"
            ]
        ]
    },
    {
        "id": "ec38c533.8c9d68",
        "type": "function",
        "z": "91f6d9cd.bc6648",
        "name": "dummy KO",
        "func": "const changes = {\n    state: 'INPUT',\n    stageResult: {\n        status: 'KO'\n    }\n}\n\nlet model = global.get('model')\n\nmodel.production = Object.assign(model.production, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.production',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 590,
        "y": 1220,
        "wires": [
            [
                "b577d158.09844"
            ]
        ]
    },
    {
        "id": "fc988fe7.eb42e",
        "type": "function",
        "z": "91f6d9cd.bc6648",
        "name": "query recipe",
        "func": "const model = global.get('model')\n\nif (model.production.stageResult.status !== 'OK')\n{\n    return\n}\n\nconst pn = model.production.workorder.pn\nconst lot = model.production.workorder.lot\nconst lotId = model.production.workorder.lotId\nconst stage = model.production.workorder.stage\n\nmsg.config = {\n    filter: [\n        {\n            id: {\n                eq: `${pn}|${lot}|${lotId}|${stage}`\n            }\n        }\n    ]\n}\n\nreturn msg\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 390,
        "y": 1340,
        "wires": [
            [
                "4fd96759.0ab858"
            ]
        ]
    },
    {
        "id": "4fd96759.0ab858",
        "type": "recipe-query",
        "z": "91f6d9cd.bc6648",
        "name": "",
        "category": "production",
        "filter": "[]",
        "filterType": "json",
        "sortBy": "[]",
        "sortByType": "json",
        "maxResults": "",
        "x": 450,
        "y": 1380,
        "wires": [
            [
                "d7112211.9112b"
            ]
        ]
    },
    {
        "id": "d7112211.9112b",
        "type": "function",
        "z": "91f6d9cd.bc6648",
        "name": "ready to write",
        "func": "const DATE_STRING = global.get('DATE_STRING')\nlet model = global.get('model')\n\nconst recipe = msg.payload[0]\nconst input = model.production.input\nconst workorder = model.production.workorder\n\nlet changes = {\n    status: 'READY',\n    etchingSpeedSet: recipe.ingredients.etching_speed,\n    etching1UpSprayPressureSet: recipe.ingredients.etching_1_up_spray_pressure,\n    etching1DownSprayPressureSet: recipe.ingredients.etching_1_down_spray_pressure,\n    etching2SwitchSet: recipe.ingredients.etching_2_switch,\n    etching3SwitchSet: recipe.ingredients.etching_3_switch,\n    developSpeedSet: recipe.ingredients.develop_speed,\n    workorder: input.workorder,\n    lotId: workorder.lotId,\n    pn: workorder.pn,\n    lot: workorder.lot,\n    stage: workorder.stage,\n    recipeTimestamp: DATE_STRING(new Date()),\n    workorderTimestamp: DATE_STRING(new Date())\n}\n\nmodel.pendingRecipe = Object.assign(model.pendingRecipe, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.pendingRecipe',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 400,
        "y": 1460,
        "wires": [
            [
                "b577d158.09844",
                "dfea4e19.4201d"
            ]
        ]
    },
    {
        "id": "12936faa.4558b",
        "type": "function",
        "z": "e0b73c3e.34741",
        "name": "Handle production.clear",
        "func": "if (msg.topic !== 'production.clear') {\n    return\n}\n\nreturn {}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 390,
        "y": 320,
        "wires": [
            [
                "d23476e.7acef88"
            ]
        ]
    },
    {
        "id": "dfea4e19.4201d",
        "type": "delay",
        "z": "91f6d9cd.bc6648",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 640,
        "y": 1460,
        "wires": [
            [
                "270af04b.e0ab4"
            ]
        ]
    },
    {
        "id": "270af04b.e0ab4",
        "type": "function",
        "z": "91f6d9cd.bc6648",
        "name": "clean",
        "func": "const changes = {\n    state: 'INPUT',\n\n    input: {\n        operator: '',\n        workorder: ''\n    },\n    workorder: {\n        lotId: '',\n        pn: '',\n        lot: '',\n        stage: ''\n    },\n    stageResult: {\n        status: 'N/A',\n        // TODO 當前站別\n        // TODO 預期站別\n    }\n}\n\nlet model = global.get('model')\nmodel.production = Object.assign(model.production, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.production',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 810,
        "y": 1460,
        "wires": [
            [
                "b577d158.09844"
            ]
        ]
    },
    {
        "id": "8bccc7ba.fbf268",
        "type": "comment",
        "z": "a8fedd5f.a9ed3",
        "name": "initialize",
        "info": "",
        "x": 190,
        "y": 120,
        "wires": []
    },
    {
        "id": "37ba1dd3.f5c012",
        "type": "link in",
        "z": "a8fedd5f.a9ed3",
        "name": "To Control",
        "links": [
            "44e76f83.bd737",
            "58e75c96.95b2b4",
            "b17c3083.dd0c8",
            "b20ba137.be08",
            "b5f7b64b.c7a248",
            "b7b6c644.b328b8",
            "f9e43485.fec318",
            "a8c2a30.58b5d6",
            "672a7a09.265094",
            "418f844b.671e2c",
            "8c4b9603.e1aee8",
            "4c11d973.d583d8",
            "73ad0302.9c13ac",
            "ca153323.175d",
            "9fb81c12.c17a1",
            "3d474729.48c3b8",
            "c362751b.9d6ec8",
            "b8efe10f.b23fd",
            "d84a2899.ed42d8",
            "a3a6fb04.90f508",
            "b3f2298f.3de718",
            "cb0d22ed.50e19"
        ],
        "x": 155,
        "y": 200,
        "wires": [
            [
                "ec55f2a0.5a98"
            ]
        ]
    },
    {
        "id": "ec55f2a0.5a98",
        "type": "function",
        "z": "a8fedd5f.a9ed3",
        "name": "Handle initialize",
        "func": "if (msg.topic !== 'initialize')\n{\n    return\n}\n\nconst changes = {\n    state: 'INPUT',\n\n    input: {\n        operator: '',\n        workorder: '',\n        enableStage: false\n    },\n    workorder: {\n        lotId: '',\n        pn: '',\n        lot: '',\n        stage: ''\n    },\n    lastWorkorder: {\n        timestamp: ''\n    }\n}\n\nlet model = global.get('model')\nmodel.loader = Object.assign(model.loader, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.loader',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 400,
        "y": 200,
        "wires": [
            [
                "aa9618e3.489e98"
            ]
        ]
    },
    {
        "id": "aa9618e3.489e98",
        "type": "link out",
        "z": "a8fedd5f.a9ed3",
        "name": "To View",
        "links": [
            "1f11def9.bf34a1",
            "25c230cf.7d5c1",
            "5a694f49.a6dc1",
            "6022ffbc.3bfec",
            "78dc8b8f.5838b4",
            "7b8c2c08.b563e4",
            "906e5b22.4989f8",
            "ae422560.686178",
            "e6618bc.b92f578",
            "6e7d7659.49a0c8",
            "86c694dd.0d3b58",
            "b00a14bc.49c178",
            "72b20f0d.07717",
            "7201918.9d8ef7",
            "92f89b72.0dfc58",
            "2296d51b.bb473a",
            "fb3100ee.25d73",
            "563d78f.923fb88",
            "4ed6ea6c.5812f4",
            "79ce718d.22dbf",
            "54cc6ac1.ba3754",
            "9cd75563.219f28",
            "2c4b532c.3aee0c",
            "fa88555.452f3a8",
            "fcecc3e7.5eb01",
            "bb14064e.2c38e8"
        ],
        "x": 975,
        "y": 200,
        "wires": []
    },
    {
        "id": "dbecd390.2b908",
        "type": "ui_text",
        "z": "68e17fbd.b18c8",
        "group": "f9fdaf2.a529a5",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "可投料",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 530,
        "y": 180,
        "wires": []
    },
    {
        "id": "cd28fee6.87599",
        "type": "ui_text",
        "z": "68e17fbd.b18c8",
        "group": "f9fdaf2.a529a5",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "E槽",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 530,
        "y": 220,
        "wires": []
    },
    {
        "id": "f9630fdf.54f0e",
        "type": "comment",
        "z": "68e17fbd.b18c8",
        "name": "投料狀態",
        "info": "",
        "x": 220,
        "y": 120,
        "wires": []
    },
    {
        "id": "54cc6ac1.ba3754",
        "type": "link in",
        "z": "68e17fbd.b18c8",
        "name": "To view",
        "links": [
            "1c425765.6b2309",
            "489ba77a.50c808",
            "89789973.e5e468",
            "dd06c8ba.f3ede8",
            "fae00d5b.4d7cf",
            "fe3b68d5.4d9bb8",
            "5996a99f.a82ad8",
            "e603e132.0cbe1",
            "a6a2f658.b55fa8",
            "774a8f54.a250b",
            "5cc58842.141918",
            "680f0250.6e2a2c",
            "e0443fff.4e35f",
            "49ed37b1.523d68",
            "5b27ed13.a3c814",
            "4abf0a7b.536ba4",
            "f4ddf088.12237",
            "e075a031.de73d",
            "b577d158.09844",
            "aa9618e3.489e98",
            "a50ccc58.1f6dd",
            "9c6f34ec.44c938",
            "8ee38a81.6bdf38",
            "b1be3310.5727e"
        ],
        "x": 175,
        "y": 200,
        "wires": [
            [
                "7f40a1a6.5fe45"
            ]
        ]
    },
    {
        "id": "7f40a1a6.5fe45",
        "type": "function",
        "z": "68e17fbd.b18c8",
        "name": "",
        "func": "if (msg.topic !== 'model.reading')\n{\n    return\n}\n\nconst model = global.get('model')\n\nreturn [\n    {\n        payload: model.reading.boardStatus\n    },\n    {\n        payload: model.reading.eSlot\n    }\n]",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 320,
        "y": 200,
        "wires": [
            [
                "dbecd390.2b908"
            ],
            [
                "cd28fee6.87599"
            ]
        ]
    },
    {
        "id": "73824f5.ad25ab",
        "type": "comment",
        "z": "68e17fbd.b18c8",
        "name": "輸入",
        "info": "",
        "x": 210,
        "y": 380,
        "wires": []
    },
    {
        "id": "908b0ef4.71ecf",
        "type": "ui_text_input",
        "z": "68e17fbd.b18c8",
        "name": "",
        "label": "生產人員編號",
        "tooltip": "",
        "group": "f78a35ed.5b0018",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "mode": "text",
        "delay": 300,
        "topic": "topic",
        "topicType": "msg",
        "x": 560,
        "y": 440,
        "wires": [
            [
                "7872dcf4.2f77e4"
            ]
        ]
    },
    {
        "id": "544b2d88.9c4dc4",
        "type": "ui_text_input",
        "z": "68e17fbd.b18c8",
        "name": "",
        "label": "工單碼/量產工單碼",
        "tooltip": "",
        "group": "f78a35ed.5b0018",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": true,
        "mode": "text",
        "delay": 300,
        "topic": "topic",
        "topicType": "msg",
        "x": 570,
        "y": 480,
        "wires": [
            [
                "5733be11.a8899"
            ]
        ]
    },
    {
        "id": "79c3557a.8c659c",
        "type": "ui_text_input",
        "z": "68e17fbd.b18c8",
        "name": "",
        "label": "層別",
        "tooltip": "",
        "group": "f78a35ed.5b0018",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": true,
        "mode": "text",
        "delay": 300,
        "topic": "topic",
        "topicType": "msg",
        "x": 530,
        "y": 520,
        "wires": [
            [
                "e8a8a5b3.ed8a48"
            ]
        ]
    },
    {
        "id": "9cd75563.219f28",
        "type": "link in",
        "z": "68e17fbd.b18c8",
        "name": "To View",
        "links": [
            "1c425765.6b2309",
            "fae00d5b.4d7cf",
            "fe3b68d5.4d9bb8",
            "dd06c8ba.f3ede8",
            "89789973.e5e468",
            "489ba77a.50c808",
            "5996a99f.a82ad8",
            "e603e132.0cbe1",
            "a6a2f658.b55fa8",
            "774a8f54.a250b",
            "5cc58842.141918",
            "680f0250.6e2a2c",
            "e0443fff.4e35f",
            "49ed37b1.523d68",
            "5b27ed13.a3c814",
            "4abf0a7b.536ba4",
            "f4ddf088.12237",
            "e075a031.de73d",
            "b577d158.09844",
            "aa9618e3.489e98",
            "a50ccc58.1f6dd",
            "9c6f34ec.44c938",
            "8ee38a81.6bdf38",
            "b1be3310.5727e"
        ],
        "x": 175,
        "y": 460,
        "wires": [
            [
                "c39b1a4d.5b36d8",
                "e9098ccc.f7b2"
            ]
        ]
    },
    {
        "id": "c39b1a4d.5b36d8",
        "type": "function",
        "z": "68e17fbd.b18c8",
        "name": "",
        "func": "if (msg.topic !== 'model.loader')\n{\n    return\n}\n\nconst model = global.get('model')\n\nconst enabled = model.loader.state === 'INPUT'\n\nreturn [\n    {\n        enabled,\n        payload: model.loader.input.operator\n    },\n    {\n        enabled,\n        payload: model.loader.input.workorder\n    }\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 320,
        "y": 460,
        "wires": [
            [
                "908b0ef4.71ecf"
            ],
            [
                "544b2d88.9c4dc4"
            ]
        ]
    },
    {
        "id": "5733be11.a8899",
        "type": "function",
        "z": "68e17fbd.b18c8",
        "name": "",
        "func": "const workorder = msg.payload\n\nreturn {\n    topic: 'loader.workorder',\n    payload: {\n        workorder: workorder\n    }\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 760,
        "y": 480,
        "wires": [
            [
                "d84a2899.ed42d8"
            ]
        ]
    },
    {
        "id": "d84a2899.ed42d8",
        "type": "link out",
        "z": "68e17fbd.b18c8",
        "name": "To Control",
        "links": [
            "3541d990.925686",
            "52efc3ab.55ab6c",
            "7418d21.45ad22c",
            "a7975a02.8a0c88",
            "3b97a635.15979a",
            "bb7671b1.06e21",
            "b0dc5ccf.b1d62",
            "55b00947.ddc508",
            "abb166c.3e09798",
            "6d90df4e.6ef51",
            "61ea8d29.c6a4f4",
            "f45dd390.154fa",
            "d83de82b.db06e8",
            "6d610381.b62fac",
            "bc6010e1.7537c",
            "f99d52f2.f8f68",
            "d3dcc847.1cd478",
            "6b1721e5.459cc",
            "37ba1dd3.f5c012",
            "71a73452.ac13dc",
            "beee06f7.be6498",
            "a9a83c81.2306a",
            "79dbf37.1b4860c"
        ],
        "x": 935,
        "y": 480,
        "wires": []
    },
    {
        "id": "e9098ccc.f7b2",
        "type": "function",
        "z": "68e17fbd.b18c8",
        "name": "",
        "func": "if (msg.topic !== 'model.loader')\n{\n    return\n}\n\nconst model = global.get('model')\n\nconst enabled = model.loader.state === 'INPUT'\n && !!model.loader.workorder.lotId\n && !!model.loader.workorder.pn\n && !!model.loader.workorder.lot\n && model.loader.input.enableStage\n\nreturn {\n    enabled,\n    payload: model.loader.workorder.stage\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 320,
        "y": 520,
        "wires": [
            [
                "79c3557a.8c659c"
            ]
        ]
    },
    {
        "id": "e8a8a5b3.ed8a48",
        "type": "function",
        "z": "68e17fbd.b18c8",
        "name": "",
        "func": "const stage = msg.payload\n\nreturn {\n    topic: 'loader.stage',\n    payload: {\n        stage: stage\n    }\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 760,
        "y": 520,
        "wires": [
            [
                "d84a2899.ed42d8"
            ]
        ]
    },
    {
        "id": "7872dcf4.2f77e4",
        "type": "function",
        "z": "68e17fbd.b18c8",
        "name": "",
        "func": "const operator = msg.payload\n\nreturn {\n    topic: 'loader.operator',\n    payload: {\n        operator: operator\n    }\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 760,
        "y": 440,
        "wires": [
            [
                "d84a2899.ed42d8"
            ]
        ]
    },
    {
        "id": "909185d6.8ceaf8",
        "type": "comment",
        "z": "68e17fbd.b18c8",
        "name": "工單內容",
        "info": "",
        "x": 220,
        "y": 660,
        "wires": []
    },
    {
        "id": "1d1b4086.69c9ef",
        "type": "ui_text",
        "z": "68e17fbd.b18c8",
        "group": "ba848a9a.d0ffe8",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "料號 (PN)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 540,
        "y": 700,
        "wires": []
    },
    {
        "id": "1047c33c.8a398d",
        "type": "ui_text",
        "z": "68e17fbd.b18c8",
        "group": "ba848a9a.d0ffe8",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "批號 (Lot)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 540,
        "y": 740,
        "wires": []
    },
    {
        "id": "25ed0a52.3d3176",
        "type": "ui_text",
        "z": "68e17fbd.b18c8",
        "group": "ba848a9a.d0ffe8",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "工令 (Lot ID)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 550,
        "y": 780,
        "wires": []
    },
    {
        "id": "613c90a9.cb49a",
        "type": "ui_text",
        "z": "68e17fbd.b18c8",
        "group": "ba848a9a.d0ffe8",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "層別 (Stage)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 550,
        "y": 820,
        "wires": []
    },
    {
        "id": "3cc7c4f0.f0312c",
        "type": "ui_button",
        "z": "68e17fbd.b18c8",
        "name": "",
        "group": "ba848a9a.d0ffe8",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "確認投板",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 540,
        "y": 860,
        "wires": [
            [
                "aa230f35.c1ac1"
            ]
        ]
    },
    {
        "id": "853f57b2.031ad8",
        "type": "function",
        "z": "68e17fbd.b18c8",
        "name": "",
        "func": "if (msg.topic !== 'model.loader')\n{\n    return\n}\n\nconst model = global.get('model')\n\nconst enabled = model.loader.state === 'INPUT'\n\nreturn [\n    {\n        enabled,\n        payload: model.loader.workorder.pn\n    },\n    {\n        enabled,\n        payload: model.loader.workorder.lot\n    },\n    {\n        enabled,\n        payload: model.loader.workorder.lotId\n    },\n    {\n        enabled,\n        payload: model.loader.workorder.stage\n    }\n]\n",
        "outputs": 4,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 320,
        "y": 760,
        "wires": [
            [
                "1d1b4086.69c9ef"
            ],
            [
                "1047c33c.8a398d"
            ],
            [
                "25ed0a52.3d3176"
            ],
            [
                "613c90a9.cb49a"
            ]
        ]
    },
    {
        "id": "2c4b532c.3aee0c",
        "type": "link in",
        "z": "68e17fbd.b18c8",
        "name": "To View",
        "links": [
            "1c425765.6b2309",
            "fae00d5b.4d7cf",
            "fe3b68d5.4d9bb8",
            "dd06c8ba.f3ede8",
            "89789973.e5e468",
            "489ba77a.50c808",
            "5996a99f.a82ad8",
            "e603e132.0cbe1",
            "a6a2f658.b55fa8",
            "774a8f54.a250b",
            "5cc58842.141918",
            "680f0250.6e2a2c",
            "e0443fff.4e35f",
            "49ed37b1.523d68",
            "5b27ed13.a3c814",
            "4abf0a7b.536ba4",
            "f4ddf088.12237",
            "e075a031.de73d",
            "b577d158.09844",
            "aa9618e3.489e98",
            "a50ccc58.1f6dd",
            "9c6f34ec.44c938",
            "8ee38a81.6bdf38",
            "b1be3310.5727e"
        ],
        "x": 175,
        "y": 760,
        "wires": [
            [
                "853f57b2.031ad8",
                "226b0117.1c376e"
            ]
        ]
    },
    {
        "id": "226b0117.1c376e",
        "type": "function",
        "z": "68e17fbd.b18c8",
        "name": "",
        "func": "if (msg.topic !== 'model.loader')\n{\n    return\n}\n\nconst model = global.get('model')\n\nconst enabled = model.loader.state === 'INPUT'\n && model.loader.workorder.lotId\n && model.loader.workorder.pn\n && model.loader.workorder.lot\n && model.loader.workorder.stage\n\nreturn {\n    enabled\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 320,
        "y": 860,
        "wires": [
            [
                "3cc7c4f0.f0312c"
            ]
        ]
    },
    {
        "id": "a3a6fb04.90f508",
        "type": "link out",
        "z": "68e17fbd.b18c8",
        "name": "To Control",
        "links": [
            "3541d990.925686",
            "52efc3ab.55ab6c",
            "7418d21.45ad22c",
            "a7975a02.8a0c88",
            "3b97a635.15979a",
            "bb7671b1.06e21",
            "b0dc5ccf.b1d62",
            "55b00947.ddc508",
            "abb166c.3e09798",
            "6d90df4e.6ef51",
            "61ea8d29.c6a4f4",
            "f45dd390.154fa",
            "d83de82b.db06e8",
            "6d610381.b62fac",
            "bc6010e1.7537c",
            "f99d52f2.f8f68",
            "d3dcc847.1cd478",
            "6b1721e5.459cc",
            "37ba1dd3.f5c012",
            "71a73452.ac13dc",
            "beee06f7.be6498",
            "a9a83c81.2306a",
            "79dbf37.1b4860c"
        ],
        "x": 935,
        "y": 860,
        "wires": []
    },
    {
        "id": "aa230f35.c1ac1",
        "type": "function",
        "z": "68e17fbd.b18c8",
        "name": "",
        "func": "return {\n    topic: 'loader.confirmWorkorder',\n    payload: {}\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 760,
        "y": 860,
        "wires": [
            [
                "a3a6fb04.90f508"
            ]
        ]
    },
    {
        "id": "f54adcbf.08411",
        "type": "comment",
        "z": "68e17fbd.b18c8",
        "name": "最後投入工單",
        "info": "",
        "x": 230,
        "y": 1040,
        "wires": []
    },
    {
        "id": "3f2c7389.805b8c",
        "type": "ui_text",
        "z": "68e17fbd.b18c8",
        "group": "174c3a20.2d7fe6",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "料號 (PN)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 540,
        "y": 1100,
        "wires": []
    },
    {
        "id": "85c9bfaf.de68a",
        "type": "ui_text",
        "z": "68e17fbd.b18c8",
        "group": "174c3a20.2d7fe6",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "批號 (Lot)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 540,
        "y": 1140,
        "wires": []
    },
    {
        "id": "edd4a6ae.749b08",
        "type": "ui_text",
        "z": "68e17fbd.b18c8",
        "group": "174c3a20.2d7fe6",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "工令 (Lot ID)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 550,
        "y": 1180,
        "wires": []
    },
    {
        "id": "70fbda32.5cf224",
        "type": "ui_text",
        "z": "68e17fbd.b18c8",
        "group": "174c3a20.2d7fe6",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "層別 (Stage)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 550,
        "y": 1220,
        "wires": []
    },
    {
        "id": "55e00ac1.3591f4",
        "type": "ui_text",
        "z": "68e17fbd.b18c8",
        "group": "174c3a20.2d7fe6",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "最後投板時間",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 560,
        "y": 1260,
        "wires": []
    },
    {
        "id": "311f95e2.873dea",
        "type": "comment",
        "z": "68e17fbd.b18c8",
        "name": "應投工單",
        "info": "",
        "x": 220,
        "y": 1420,
        "wires": []
    },
    {
        "id": "c18e5863.c93568",
        "type": "ui_text",
        "z": "68e17fbd.b18c8",
        "group": "ac3dfebc.ad43",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "料號 (PN)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 540,
        "y": 1480,
        "wires": []
    },
    {
        "id": "4b6a0f78.ac0b",
        "type": "ui_text",
        "z": "68e17fbd.b18c8",
        "group": "ac3dfebc.ad43",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "批號 (Lot)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 540,
        "y": 1520,
        "wires": []
    },
    {
        "id": "64be55dd.4fd0fc",
        "type": "ui_text",
        "z": "68e17fbd.b18c8",
        "group": "ac3dfebc.ad43",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "工令 (Lot ID)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 550,
        "y": 1560,
        "wires": []
    },
    {
        "id": "45d12cd4.c4f1e4",
        "type": "ui_text",
        "z": "68e17fbd.b18c8",
        "group": "ac3dfebc.ad43",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "層別 (Stage)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 550,
        "y": 1600,
        "wires": []
    },
    {
        "id": "e6e7c18f.2a688",
        "type": "ui_text",
        "z": "68e17fbd.b18c8",
        "group": "ac3dfebc.ad43",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "最後更新時間",
        "format": "<font color= {{msg.color}} >{{msg.payload}}</font>",
        "layout": "row-spread",
        "x": 560,
        "y": 1640,
        "wires": []
    },
    {
        "id": "e6f9459a.812828",
        "type": "ui_text",
        "z": "68e17fbd.b18c8",
        "group": "a33eb33d.bcefc",
        "order": 1,
        "width": "2",
        "height": "1",
        "name": "",
        "label": "狀態",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "x": 530,
        "y": 1800,
        "wires": []
    },
    {
        "id": "c46ccbd.c82a438",
        "type": "ui_button",
        "z": "68e17fbd.b18c8",
        "name": "",
        "group": "a33eb33d.bcefc",
        "order": 2,
        "width": "2",
        "height": "1",
        "passthru": false,
        "label": "清除",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 530,
        "y": 2160,
        "wires": [
            [
                "7b85b373.a27b2c"
            ]
        ]
    },
    {
        "id": "4d20534f.f23e0c",
        "type": "ui_text",
        "z": "68e17fbd.b18c8",
        "group": "a33eb33d.bcefc",
        "order": 3,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "蝕刻速度",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 540,
        "y": 1840,
        "wires": []
    },
    {
        "id": "7cac767c.18e5d8",
        "type": "ui_text",
        "z": "68e17fbd.b18c8",
        "group": "a33eb33d.bcefc",
        "order": 4,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "蝕刻1上噴",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 550,
        "y": 1880,
        "wires": []
    },
    {
        "id": "1d9cee59.040a72",
        "type": "ui_text",
        "z": "68e17fbd.b18c8",
        "group": "a33eb33d.bcefc",
        "order": 5,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "蝕刻1下噴",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 550,
        "y": 1920,
        "wires": []
    },
    {
        "id": "4f0c0cc.7be01f4",
        "type": "ui_text",
        "z": "68e17fbd.b18c8",
        "group": "a33eb33d.bcefc",
        "order": 6,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "蝕刻2開關",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 550,
        "y": 1960,
        "wires": []
    },
    {
        "id": "774408dc.d911e8",
        "type": "ui_text",
        "z": "68e17fbd.b18c8",
        "group": "a33eb33d.bcefc",
        "order": 7,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "蝕刻3開關",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 550,
        "y": 2000,
        "wires": []
    },
    {
        "id": "5e8d465b.14e1c8",
        "type": "ui_text",
        "z": "68e17fbd.b18c8",
        "group": "a33eb33d.bcefc",
        "order": 8,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "顯影速度",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 540,
        "y": 2040,
        "wires": []
    },
    {
        "id": "6a39f288.7717ec",
        "type": "ui_text",
        "z": "68e17fbd.b18c8",
        "group": "a33eb33d.bcefc",
        "order": 10,
        "width": "4",
        "height": "1",
        "name": "",
        "label": "工單碼/量產工單碼",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "x": 570,
        "y": 2080,
        "wires": []
    },
    {
        "id": "476da8e8.6a9f48",
        "type": "ui_text",
        "z": "68e17fbd.b18c8",
        "group": "a33eb33d.bcefc",
        "order": 12,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "時間",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "x": 530,
        "y": 2120,
        "wires": []
    },
    {
        "id": "ff29a1a4.fcb15",
        "type": "comment",
        "z": "68e17fbd.b18c8",
        "name": "待寫入配方",
        "info": "",
        "x": 220,
        "y": 1740,
        "wires": []
    },
    {
        "id": "5aab1dc6.83e614",
        "type": "function",
        "z": "68e17fbd.b18c8",
        "name": "",
        "func": "if (msg.topic !== 'model.pendingRecipe')\n{\n    return\n}\n\nconst model = global.get('model')\n\nreturn {\n    payload: model.pendingRecipe.status\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 320,
        "y": 1800,
        "wires": [
            [
                "e6f9459a.812828"
            ]
        ]
    },
    {
        "id": "fa88555.452f3a8",
        "type": "link in",
        "z": "68e17fbd.b18c8",
        "name": "To View",
        "links": [
            "1c425765.6b2309",
            "489ba77a.50c808",
            "5996a99f.a82ad8",
            "89789973.e5e468",
            "dd06c8ba.f3ede8",
            "fae00d5b.4d7cf",
            "fe3b68d5.4d9bb8",
            "e603e132.0cbe1",
            "a6a2f658.b55fa8",
            "774a8f54.a250b",
            "5cc58842.141918",
            "680f0250.6e2a2c",
            "e0443fff.4e35f",
            "49ed37b1.523d68",
            "5b27ed13.a3c814",
            "4abf0a7b.536ba4",
            "f4ddf088.12237",
            "e075a031.de73d",
            "b577d158.09844",
            "aa9618e3.489e98",
            "a50ccc58.1f6dd",
            "9c6f34ec.44c938",
            "8ee38a81.6bdf38",
            "b1be3310.5727e"
        ],
        "x": 175,
        "y": 1800,
        "wires": [
            [
                "5aab1dc6.83e614",
                "c25a452e.f19428",
                "cd059e02.216bc",
                "f0f4c01.921214"
            ]
        ]
    },
    {
        "id": "c25a452e.f19428",
        "type": "function",
        "z": "68e17fbd.b18c8",
        "name": "",
        "func": "if (msg.topic !== 'model.pendingRecipe')\n{\n    return\n}\n\nconst model = global.get('model')\nconst pendingRecipe = model.pendingRecipe\n\nif (pendingRecipe.status === 'OK')\n{\n    return\n}\n\nreturn [\n    {\n        payload: pendingRecipe.etchingSpeedSet\n    },\n    {\n        payload: pendingRecipe.etching1UpSprayPressureSet\n    },\n    {\n        payload: pendingRecipe.etching1DownSprayPressureSet\n    },\n    {\n        payload: pendingRecipe.etching2SwitchSet\n    },\n    {\n        payload: pendingRecipe.etching3SwitchSet\n    },\n    {\n        payload: pendingRecipe.developSpeedSet\n    },\n    {\n        payload: pendingRecipe.workorder\n    }\n]\n",
        "outputs": 7,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 320,
        "y": 1880,
        "wires": [
            [
                "4d20534f.f23e0c"
            ],
            [
                "7cac767c.18e5d8"
            ],
            [
                "1d9cee59.040a72"
            ],
            [
                "4f0c0cc.7be01f4"
            ],
            [
                "774408dc.d911e8"
            ],
            [
                "5e8d465b.14e1c8"
            ],
            [
                "6a39f288.7717ec"
            ]
        ]
    },
    {
        "id": "cd059e02.216bc",
        "type": "function",
        "z": "68e17fbd.b18c8",
        "name": "",
        "func": "if (msg.topic !== 'model.pendingRecipe')\n{\n    return\n}\n\nconst model = global.get('model')\nconst pendingRecipe = model.pendingRecipe\n\nconst enabled = pendingRecipe.status === 'READY'\n  && pendingRecipe.etchingSpeedSet\n  && pendingRecipe.etching1UpSprayPressureSet\n  && pendingRecipe.etching1DownSprayPressureSet\n  && pendingRecipe.etching2SwitchSet\n  && pendingRecipe.etching3SwitchSet\n  && pendingRecipe.developSpeedSet\n\nreturn {\n    enabled\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 320,
        "y": 2160,
        "wires": [
            [
                "c46ccbd.c82a438"
            ]
        ]
    },
    {
        "id": "f0f4c01.921214",
        "type": "function",
        "z": "68e17fbd.b18c8",
        "name": "",
        "func": "if (msg.topic !== 'model.pendingRecipe')\n{\n    return\n}\n\nconst model = global.get('model')\n\nreturn {\n    payload: model.pendingRecipe.recipeTimestamp\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 320,
        "y": 2120,
        "wires": [
            [
                "476da8e8.6a9f48"
            ]
        ]
    },
    {
        "id": "7b85b373.a27b2c",
        "type": "function",
        "z": "68e17fbd.b18c8",
        "name": "",
        "func": "return {\n    topic: 'loader.clear',\n    payload: {}\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 720,
        "y": 2160,
        "wires": [
            [
                "b3f2298f.3de718"
            ]
        ]
    },
    {
        "id": "b3f2298f.3de718",
        "type": "link out",
        "z": "68e17fbd.b18c8",
        "name": "To Control",
        "links": [
            "3541d990.925686",
            "3b97a635.15979a",
            "52efc3ab.55ab6c",
            "7418d21.45ad22c",
            "a7975a02.8a0c88",
            "bb7671b1.06e21",
            "b0dc5ccf.b1d62",
            "55b00947.ddc508",
            "abb166c.3e09798",
            "6d90df4e.6ef51",
            "61ea8d29.c6a4f4",
            "f45dd390.154fa",
            "d83de82b.db06e8",
            "6d610381.b62fac",
            "bc6010e1.7537c",
            "f99d52f2.f8f68",
            "d3dcc847.1cd478",
            "6b1721e5.459cc",
            "37ba1dd3.f5c012",
            "71a73452.ac13dc",
            "beee06f7.be6498",
            "a9a83c81.2306a",
            "79dbf37.1b4860c"
        ],
        "x": 935,
        "y": 2160,
        "wires": []
    },
    {
        "id": "bc4f14cc.f09938",
        "type": "function",
        "z": "e0b73c3e.34741",
        "name": "Handle loader.clear",
        "func": "if (msg.topic !== 'loader.clear') {\n    return\n}\n\nreturn {}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 370,
        "y": 360,
        "wires": [
            [
                "d23476e.7acef88"
            ]
        ]
    },
    {
        "id": "71a73452.ac13dc",
        "type": "link in",
        "z": "a8fedd5f.a9ed3",
        "name": "To Control",
        "links": [
            "58e75c96.95b2b4",
            "f9e43485.fec318",
            "44e76f83.bd737",
            "b20ba137.be08",
            "b17c3083.dd0c8",
            "b5f7b64b.c7a248",
            "b7b6c644.b328b8",
            "a8c2a30.58b5d6",
            "672a7a09.265094",
            "418f844b.671e2c",
            "8c4b9603.e1aee8",
            "4c11d973.d583d8",
            "73ad0302.9c13ac",
            "ca153323.175d",
            "9fb81c12.c17a1",
            "3d474729.48c3b8",
            "c362751b.9d6ec8",
            "b8efe10f.b23fd",
            "d84a2899.ed42d8",
            "a3a6fb04.90f508",
            "b3f2298f.3de718",
            "cb0d22ed.50e19"
        ],
        "x": 155,
        "y": 460,
        "wires": [
            [
                "6df6df73.b734",
                "c5098ed2.54f11",
                "909e9ff.8ae856"
            ]
        ]
    },
    {
        "id": "87e75f8c.3c0b4",
        "type": "comment",
        "z": "a8fedd5f.a9ed3",
        "name": "輸入",
        "info": "",
        "x": 190,
        "y": 380,
        "wires": []
    },
    {
        "id": "909e9ff.8ae856",
        "type": "function",
        "z": "a8fedd5f.a9ed3",
        "name": "Handle workorder (LC2 工單碼 3+1 段)",
        "func": "if (msg.topic !== 'loader.workorder')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.loader.state !== 'INPUT')\n{\n    node.error('unexpected')\n    return\n}\n\nconst workorder = msg.payload.workorder\n\nlet exp = /^[0-9A-Z]+;[0-9A-Z.]+;[0-9.]+$/ig\n\nif (!exp.test(workorder))\n{\n    return [null, msg]\n}\n\nlet splitted = workorder.split(';')\nlet pn = splitted[0]\nlet lotId = splitted[1]\nlet lot = splitted[2]\n\nlet input = model.loader.input\ninput.workorder = workorder\ninput.enableStage = true\n\nconst changes = {\n    input,\n    workorder: {\n        lotId: lotId,\n        pn: pn,\n        lot: lot,\n        stage: ''\n    }\n}\n\nmodel.loader = Object.assign(model.loader, changes)\nglobal.set('model', model)\n\nreturn [\n    {\n        topic: 'model.loader',\n        payload: changes\n    },\n    null\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 470,
        "y": 560,
        "wires": [
            [
                "a50ccc58.1f6dd"
            ],
            [
                "1d54acc4.827153"
            ]
        ]
    },
    {
        "id": "a50ccc58.1f6dd",
        "type": "link out",
        "z": "a8fedd5f.a9ed3",
        "name": "To View",
        "links": [
            "1f11def9.bf34a1",
            "25c230cf.7d5c1",
            "906e5b22.4989f8",
            "7b8c2c08.b563e4",
            "78dc8b8f.5838b4",
            "5a694f49.a6dc1",
            "9c023a.051afdc8",
            "ae422560.686178",
            "e6618bc.b92f578",
            "6022ffbc.3bfec",
            "6e7d7659.49a0c8",
            "86c694dd.0d3b58",
            "b00a14bc.49c178",
            "72b20f0d.07717",
            "7201918.9d8ef7",
            "92f89b72.0dfc58",
            "2296d51b.bb473a",
            "fb3100ee.25d73",
            "563d78f.923fb88",
            "4ed6ea6c.5812f4",
            "79ce718d.22dbf",
            "54cc6ac1.ba3754",
            "9cd75563.219f28",
            "2c4b532c.3aee0c",
            "fa88555.452f3a8",
            "fcecc3e7.5eb01",
            "bb14064e.2c38e8"
        ],
        "x": 995,
        "y": 620,
        "wires": []
    },
    {
        "id": "c5098ed2.54f11",
        "type": "function",
        "z": "a8fedd5f.a9ed3",
        "name": "Handle stage",
        "func": "if (msg.topic !== 'loader.stage')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.loader.state !== 'INPUT')\n{\n    node.error('unexpected')\n    return\n}\n\nconst stage = msg.payload.stage\n\nlet workorder = model.loader.workorder\nworkorder.stage = stage\n\nconst changes = {\n    workorder\n}\n\nmodel.loader = Object.assign(model.loader, changes)\n\nreturn {\n    topic: 'model.loader',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 390,
        "y": 860,
        "wires": [
            [
                "a50ccc58.1f6dd"
            ]
        ]
    },
    {
        "id": "116daee3.c04af1",
        "type": "function",
        "z": "a8fedd5f.a9ed3",
        "name": "Handle workorder (parse error)",
        "func": "if (msg.topic !== 'loader.workorder')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.loader.state !== 'INPUT')\n{\n    node.error('unexpected')\n    return\n}\n\nlet input = model.loader.input\ninput.workorder = msg.payload.workorder\ninput.enableStage = false\n\nconst changes = {\n    input,\n    workorder: {\n        lotId: '',\n        pn: '',\n        lot: '',\n        stage: ''\n    }\n}\n\nmodel.loader = Object.assign(model.loader, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.loader',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 450,
        "y": 760,
        "wires": [
            [
                "a50ccc58.1f6dd"
            ]
        ]
    },
    {
        "id": "6df6df73.b734",
        "type": "function",
        "z": "a8fedd5f.a9ed3",
        "name": "Handle operator",
        "func": "if (msg.topic !== 'loader.operator')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.loader.state !== 'INPUT')\n{\n    node.error('unexpected')\n    return\n}\n\nconst operator = msg.payload.operator\nlet input = model.loader.input\n\ninput.operator = operator\n\nconst changes = {\n    input\n}\n\nmodel.loader = Object.assign(model.loader, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.loader',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 400,
        "y": 460,
        "wires": [
            [
                "a50ccc58.1f6dd"
            ]
        ]
    },
    {
        "id": "1d54acc4.827153",
        "type": "function",
        "z": "a8fedd5f.a9ed3",
        "name": "Handle workorder (LC2 工單碼 4 段)",
        "func": "if (msg.topic !== 'loader.workorder')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.loader.state !== 'INPUT')\n{\n    node.error('unexpected')\n    return\n}\n\nconst workorder = msg.payload.workorder\n\nlet exp = /^[0-9A-Z]+;[0-9A-Z.]+;[0-9.]+&[0-9A-Z]+$/ig\n\nif (!exp.test(workorder))\n{\n    return [null, msg]\n}\n\nlet splitted = workorder.split(';')\nlet pn = splitted[0]\nlet lotId = splitted[1]\n\nsplitted = splitted[2].split('&')\nlet lot = splitted[0]\nlet stage = splitted[1]\n\nlet input = model.loader.input\ninput.workorder = workorder\ninput.enableStage = false\n\nconst changes = {\n    input,\n    workorder: {\n        lotId: lotId,\n        pn: pn,\n        lot: lot,\n        stage: stage\n    }\n}\n\nmodel.loader = Object.assign(model.loader, changes)\nglobal.set('model', model)\n\nreturn [\n    {\n        topic: 'model.loader',\n        payload: changes\n    },\n    null\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 470,
        "y": 600,
        "wires": [
            [
                "a50ccc58.1f6dd"
            ],
            [
                "ae2911bd.688ba"
            ]
        ]
    },
    {
        "id": "ae2911bd.688ba",
        "type": "function",
        "z": "a8fedd5f.a9ed3",
        "name": "Handle workorder (工單碼 3+1 段)",
        "func": "if (msg.topic !== 'loader.workorder')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.loader.state !== 'INPUT')\n{\n    node.error('unexpected')\n    return\n}\n\nconst workorder = msg.payload.workorder\n\nlet exp = /^[0-9A-Z.]+\\|[0-9A-Z]+\\|[0-9]+$/ig\n\nif (!exp.test(workorder))\n{\n    return [null, msg]\n}\n\nlet splitted = workorder.split('|')\nlet lotId = splitted[0]\nlet pn = splitted[1]\nlet lot = splitted[2]\n\nlet input = model.loader.input\ninput.workorder = workorder\ninput.enableStage = true\n\nconst changes = {\n    input,\n    workorder: {\n        lotId: lotId,\n        pn: pn,\n        lot: lot,\n        stage: ''\n    }\n}\n\nmodel.loader = Object.assign(model.loader, changes)\nglobal.set('model', model)\n\nreturn [\n    {\n        topic: 'model.loader',\n        payload: changes\n    },\n    null\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 460,
        "y": 640,
        "wires": [
            [
                "a50ccc58.1f6dd"
            ],
            [
                "cca8580.61f89a8"
            ]
        ]
    },
    {
        "id": "cca8580.61f89a8",
        "type": "function",
        "z": "a8fedd5f.a9ed3",
        "name": "Handle workorder (工單碼 4 段)",
        "func": "if (msg.topic !== 'loader.workorder')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.loader.state !== 'INPUT')\n{\n    node.error('unexpected')\n    return\n}\n\nconst workorder = msg.payload.workorder\n\nlet exp = /^[0-9A-Z.]+\\|[0-9A-Z]+\\|[0-9]+\\|[0-9A-Z]+$/ig\n\nif (!exp.test(workorder))\n{\n    return [null, msg]\n}\n\nlet splitted = workorder.split('|')\nlet lotId = splitted[0]\nlet pn = splitted[1]\nlet lot = splitted[2]\nlet stage = splitted[3]\n\nlet input = model.loader.input\ninput.workorder = workorder\ninput.enableStage = false\n\nconst changes = {\n    input,\n    workorder: {\n        lotId: lotId,\n        pn: pn,\n        lot: lot,\n        stage: stage\n    }\n}\n\nmodel.loader = Object.assign(model.loader, changes)\nglobal.set('model', model)\n\nreturn [\n    {\n        topic: 'model.loader',\n        payload: changes\n    },\n    null\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 450,
        "y": 680,
        "wires": [
            [
                "a50ccc58.1f6dd"
            ],
            [
                "ee3d0ca8.a4832"
            ]
        ]
    },
    {
        "id": "ee3d0ca8.a4832",
        "type": "function",
        "z": "a8fedd5f.a9ed3",
        "name": "Handle workorder (量產工單碼)",
        "func": "if (msg.topic !== 'loader.workorder')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.loader.state !== 'INPUT')\n{\n    node.error('unexpected')\n    return\n}\n\nconst workorder = msg.payload.workorder\n\nlet exp = /^[0-9A-Z]+\\|[0-9]+\\|[0-9A-Z.]+\\|[0-9A-Z]+$/ig\n\nif (!exp.test(workorder))\n{\n    return [null, msg]\n}\n\nlet splitted = workorder.split('|')\nlet pn = splitted[0]\nlet lot = splitted[1]\nlet lotId = splitted[2]\nlet stage = splitted[3]\n\nlet input = model.loader.input\ninput.workorder = workorder\ninput.enableStage = false\n\nconst changes = {\n    input,\n    workorder: {\n        lotId: lotId,\n        pn: pn,\n        lot: lot,\n        stage: stage\n    }\n}\n\nmodel.loader = Object.assign(model.loader, changes)\nglobal.set('model', model)\n\nreturn [\n    {\n        topic: 'model.loader',\n        payload: changes\n    },\n    null\n]\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 450,
        "y": 720,
        "wires": [
            [
                "a50ccc58.1f6dd"
            ],
            [
                "116daee3.c04af1"
            ]
        ]
    },
    {
        "id": "9498f2f3.b693c",
        "type": "comment",
        "z": "a8fedd5f.a9ed3",
        "name": "工單內容",
        "info": "",
        "x": 200,
        "y": 1000,
        "wires": []
    },
    {
        "id": "beee06f7.be6498",
        "type": "link in",
        "z": "a8fedd5f.a9ed3",
        "name": "To Control",
        "links": [
            "44e76f83.bd737",
            "58e75c96.95b2b4",
            "f9e43485.fec318",
            "b20ba137.be08",
            "b17c3083.dd0c8",
            "b5f7b64b.c7a248",
            "b7b6c644.b328b8",
            "a8c2a30.58b5d6",
            "672a7a09.265094",
            "418f844b.671e2c",
            "8c4b9603.e1aee8",
            "4c11d973.d583d8",
            "73ad0302.9c13ac",
            "ca153323.175d",
            "9fb81c12.c17a1",
            "3d474729.48c3b8",
            "c362751b.9d6ec8",
            "b8efe10f.b23fd",
            "d84a2899.ed42d8",
            "a3a6fb04.90f508",
            "b3f2298f.3de718",
            "cb0d22ed.50e19"
        ],
        "x": 155,
        "y": 1080,
        "wires": [
            [
                "5771dafa.b705f4"
            ]
        ]
    },
    {
        "id": "5771dafa.b705f4",
        "type": "function",
        "z": "a8fedd5f.a9ed3",
        "name": "Handle confirmWorkorder",
        "func": "if (msg.topic !== 'loader.confirmWorkorder')\n{\n    return\n}\n\nlet model = global.get('model')\nconst DATE_STRING = global.get('DATE_STRING')\n\nif (model.loader.state !== 'INPUT')\n{\n    node.error('unexpected')\n    return\n}\n\nlet changes = {\n    state: 'LAST_WORKORDER',\n    lastWorkorder: {\n        timestamp: DATE_STRING(new Date())\n    }\n}\n\nmodel.loader = Object.assign(model.loader, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.loader',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 430,
        "y": 1080,
        "wires": [
            [
                "9c6f34ec.44c938"
            ]
        ]
    },
    {
        "id": "9c6f34ec.44c938",
        "type": "link out",
        "z": "a8fedd5f.a9ed3",
        "name": "To View",
        "links": [
            "1f11def9.bf34a1",
            "25c230cf.7d5c1",
            "906e5b22.4989f8",
            "7b8c2c08.b563e4",
            "78dc8b8f.5838b4",
            "5a694f49.a6dc1",
            "9c023a.051afdc8",
            "ae422560.686178",
            "e6618bc.b92f578",
            "6022ffbc.3bfec",
            "6e7d7659.49a0c8",
            "86c694dd.0d3b58",
            "b00a14bc.49c178",
            "72b20f0d.07717",
            "7201918.9d8ef7",
            "92f89b72.0dfc58",
            "2296d51b.bb473a",
            "fb3100ee.25d73",
            "563d78f.923fb88",
            "4ed6ea6c.5812f4",
            "79ce718d.22dbf",
            "54cc6ac1.ba3754",
            "9cd75563.219f28",
            "2c4b532c.3aee0c",
            "fa88555.452f3a8",
            "fcecc3e7.5eb01",
            "bb14064e.2c38e8"
        ],
        "x": 995,
        "y": 1080,
        "wires": []
    },
    {
        "id": "36391286.edca4e",
        "type": "function",
        "z": "68e17fbd.b18c8",
        "name": "",
        "func": "if (msg.topic !== 'model.loader')\n{\n    return\n}\n\nconst model = global.get('model')\n\nif (model.loader.state !== 'LAST_WORKORDER')\n{\n    return\n}\n\nreturn [\n    {\n        payload: model.loader.workorder.pn\n    },\n    {\n        payload: model.loader.workorder.lot\n    },\n    {\n        payload: model.loader.workorder.lotId\n    },\n    {\n        payload: model.loader.workorder.stage\n    },\n    {\n        payload: model.loader.lastWorkorder.timestamp\n    }\n]\n",
        "outputs": 5,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 320,
        "y": 1140,
        "wires": [
            [
                "3f2c7389.805b8c"
            ],
            [
                "85c9bfaf.de68a"
            ],
            [
                "edd4a6ae.749b08"
            ],
            [
                "70fbda32.5cf224"
            ],
            [
                "55e00ac1.3591f4"
            ]
        ]
    },
    {
        "id": "fcecc3e7.5eb01",
        "type": "link in",
        "z": "68e17fbd.b18c8",
        "name": "To View",
        "links": [
            "1c425765.6b2309",
            "fae00d5b.4d7cf",
            "fe3b68d5.4d9bb8",
            "dd06c8ba.f3ede8",
            "89789973.e5e468",
            "489ba77a.50c808",
            "5996a99f.a82ad8",
            "e603e132.0cbe1",
            "a6a2f658.b55fa8",
            "774a8f54.a250b",
            "5cc58842.141918",
            "680f0250.6e2a2c",
            "e0443fff.4e35f",
            "49ed37b1.523d68",
            "5b27ed13.a3c814",
            "4abf0a7b.536ba4",
            "f4ddf088.12237",
            "e075a031.de73d",
            "b577d158.09844",
            "aa9618e3.489e98",
            "a50ccc58.1f6dd",
            "9c6f34ec.44c938",
            "8ee38a81.6bdf38",
            "b1be3310.5727e"
        ],
        "x": 175,
        "y": 1140,
        "wires": [
            [
                "36391286.edca4e",
                "9be930d1.af2fc"
            ]
        ]
    },
    {
        "id": "9be930d1.af2fc",
        "type": "function",
        "z": "68e17fbd.b18c8",
        "name": "",
        "func": "if (msg.topic !== 'model.loader')\n{\n    return\n}\n\nif (msg.payload.state !== 'LAST_WORKORDER')\n{\n    return\n}\n\nreturn {\n    topic: 'loader.lastWorkorder',\n    payload: {}\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 320,
        "y": 1340,
        "wires": [
            [
                "cb0d22ed.50e19"
            ]
        ]
    },
    {
        "id": "cb0d22ed.50e19",
        "type": "link out",
        "z": "68e17fbd.b18c8",
        "name": "To Control",
        "links": [
            "3541d990.925686",
            "52efc3ab.55ab6c",
            "7418d21.45ad22c",
            "a7975a02.8a0c88",
            "3b97a635.15979a",
            "bb7671b1.06e21",
            "b0dc5ccf.b1d62",
            "55b00947.ddc508",
            "abb166c.3e09798",
            "6d90df4e.6ef51",
            "61ea8d29.c6a4f4",
            "f45dd390.154fa",
            "d83de82b.db06e8",
            "6d610381.b62fac",
            "bc6010e1.7537c",
            "f99d52f2.f8f68",
            "d3dcc847.1cd478",
            "6b1721e5.459cc",
            "37ba1dd3.f5c012",
            "71a73452.ac13dc",
            "beee06f7.be6498",
            "a9a83c81.2306a",
            "79dbf37.1b4860c"
        ],
        "x": 935,
        "y": 1340,
        "wires": []
    },
    {
        "id": "2c1f8f6b.9fc94",
        "type": "comment",
        "z": "a8fedd5f.a9ed3",
        "name": "最後投入工單",
        "info": "",
        "x": 210,
        "y": 1240,
        "wires": []
    },
    {
        "id": "a9a83c81.2306a",
        "type": "link in",
        "z": "a8fedd5f.a9ed3",
        "name": "To Control",
        "links": [
            "44e76f83.bd737",
            "58e75c96.95b2b4",
            "f9e43485.fec318",
            "b20ba137.be08",
            "b17c3083.dd0c8",
            "b5f7b64b.c7a248",
            "b7b6c644.b328b8",
            "a8c2a30.58b5d6",
            "672a7a09.265094",
            "418f844b.671e2c",
            "8c4b9603.e1aee8",
            "4c11d973.d583d8",
            "73ad0302.9c13ac",
            "ca153323.175d",
            "9fb81c12.c17a1",
            "3d474729.48c3b8",
            "c362751b.9d6ec8",
            "b8efe10f.b23fd",
            "d84a2899.ed42d8",
            "a3a6fb04.90f508",
            "b3f2298f.3de718",
            "cb0d22ed.50e19"
        ],
        "x": 155,
        "y": 1360,
        "wires": [
            [
                "6736b037.18f9a"
            ]
        ]
    },
    {
        "id": "6736b037.18f9a",
        "type": "function",
        "z": "a8fedd5f.a9ed3",
        "name": "Handle lastWorkorder",
        "func": "if (msg.topic !== 'loader.lastWorkorder')\n{\n    return\n}\n\nlet model = global.get('model')\n\nif (model.loader.state !== 'LAST_WORKORDER')\n{\n    node.error('unexpected')\n    return\n}\n\nreturn {}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 420,
        "y": 1360,
        "wires": [
            [
                "c6936d10.2e2f5"
            ]
        ]
    },
    {
        "id": "8ee38a81.6bdf38",
        "type": "link out",
        "z": "a8fedd5f.a9ed3",
        "name": "To View",
        "links": [
            "1f11def9.bf34a1",
            "25c230cf.7d5c1",
            "906e5b22.4989f8",
            "7b8c2c08.b563e4",
            "78dc8b8f.5838b4",
            "5a694f49.a6dc1",
            "9c023a.051afdc8",
            "ae422560.686178",
            "e6618bc.b92f578",
            "6022ffbc.3bfec",
            "6e7d7659.49a0c8",
            "86c694dd.0d3b58",
            "b00a14bc.49c178",
            "72b20f0d.07717",
            "7201918.9d8ef7",
            "92f89b72.0dfc58",
            "2296d51b.bb473a",
            "fb3100ee.25d73",
            "563d78f.923fb88",
            "4ed6ea6c.5812f4",
            "79ce718d.22dbf",
            "54cc6ac1.ba3754",
            "9cd75563.219f28",
            "2c4b532c.3aee0c",
            "fa88555.452f3a8",
            "fcecc3e7.5eb01",
            "bb14064e.2c38e8"
        ],
        "x": 995,
        "y": 1360,
        "wires": []
    },
    {
        "id": "c6936d10.2e2f5",
        "type": "delay",
        "z": "a8fedd5f.a9ed3",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 640,
        "y": 1360,
        "wires": [
            [
                "79b493ff.34192c"
            ]
        ]
    },
    {
        "id": "79b493ff.34192c",
        "type": "function",
        "z": "a8fedd5f.a9ed3",
        "name": "clean",
        "func": "const changes = {\n    state: 'INPUT',\n\n    input: {\n        operator: '',\n        workorder: '',\n        enableStage: false\n    },\n    workorder: {\n        lotId: '',\n        pn: '',\n        lot: '',\n        stage: ''\n    }\n}\n\nlet model = global.get('model')\nmodel.loader = Object.assign(model.loader, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.loader',\n    payload: model\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 810,
        "y": 1360,
        "wires": [
            [
                "8ee38a81.6bdf38"
            ]
        ]
    },
    {
        "id": "bb14064e.2c38e8",
        "type": "link in",
        "z": "68e17fbd.b18c8",
        "name": "To View",
        "links": [
            "1c425765.6b2309",
            "fae00d5b.4d7cf",
            "fe3b68d5.4d9bb8",
            "dd06c8ba.f3ede8",
            "89789973.e5e468",
            "489ba77a.50c808",
            "5996a99f.a82ad8",
            "e603e132.0cbe1",
            "a6a2f658.b55fa8",
            "774a8f54.a250b",
            "5cc58842.141918",
            "680f0250.6e2a2c",
            "e0443fff.4e35f",
            "49ed37b1.523d68",
            "5b27ed13.a3c814",
            "4abf0a7b.536ba4",
            "f4ddf088.12237",
            "e075a031.de73d",
            "b577d158.09844",
            "aa9618e3.489e98",
            "a50ccc58.1f6dd",
            "9c6f34ec.44c938",
            "8ee38a81.6bdf38",
            "b1be3310.5727e"
        ],
        "x": 175,
        "y": 1560,
        "wires": [
            [
                "6e7781b4.8d6cd"
            ]
        ]
    },
    {
        "id": "6e7781b4.8d6cd",
        "type": "function",
        "z": "68e17fbd.b18c8",
        "name": "",
        "func": "if (msg.topic !== 'model.pendingRecipe' && msg.topic !== 'model.loader')\n{\n    return\n}\n\nconst model = global.get('model')\n\nif (msg.topic === 'model.pendingRecipe')\n{\n    if (model.pendingRecipe.status === 'OK' ||\n            (model.pendingRecipe.status === 'N/A' &&\n                model.pendingRecipe.lotId &&\n                model.pendingRecipe.pn &&\n                model.pendingRecipe.lot &&\n                model.pendingRecipe.stage))\n    {\n        return\n    }\n}\n\nreturn [\n    {\n        payload: model.pendingRecipe.pn\n    },\n    {\n        payload: model.pendingRecipe.lot\n    },\n    {\n        payload: model.pendingRecipe.lotId\n    },\n    {\n        payload: model.pendingRecipe.stage\n    },\n    {\n        payload: model.pendingRecipe.workorderTimestamp,\n        color: new Date(model.pendingRecipe.workorderTimestamp) < new Date(model.loader.lastWorkorder.timestamp) ? 'green': 'red'\n    }\n]\n",
        "outputs": 5,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 320,
        "y": 1560,
        "wires": [
            [
                "c18e5863.c93568"
            ],
            [
                "4b6a0f78.ac0b"
            ],
            [
                "64be55dd.4fd0fc"
            ],
            [
                "45d12cd4.c4f1e4"
            ],
            [
                "e6e7c18f.2a688"
            ]
        ]
    },
    {
        "id": "d23476e.7acef88",
        "type": "function",
        "z": "e0b73c3e.34741",
        "name": "clean",
        "func": "const DATE_STRING = global.get('DATE_STRING')\n\nconst changes = {\n    status: 'N/A',\n    etchingSpeedSet: '',\n    etching1UpSprayPressureSet: '',\n    etching1DownSprayPressureSet: '',\n    etching2SwitchSet: '',\n    etching3SwitchSet: '',\n    developSpeedSet: '',\n    workorder: '',\n    lotId: '',\n    pn: '',\n    lot: '',\n    stage: '',\n    recipeTimestamp: DATE_STRING(new Date()),\n    workorderTimestamp: DATE_STRING(new Date())\n}\n\nlet model = global.get('model')\nmodel.pendingRecipe = Object.assign(model.pendingRecipe, changes)\nglobal.set('model', model)\n\nreturn {\n    topic: 'model.pendingRecipe',\n    payload: changes\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 690,
        "y": 300,
        "wires": [
            [
                "5996a99f.a82ad8"
            ]
        ]
    },
    {
        "id": "503a140a.48beac",
        "type": "http in",
        "z": "e2d46b65.8c3d28",
        "name": "",
        "url": "/qrcode/image.png",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 280,
        "y": 2060,
        "wires": [
            [
                "75aa9e12.49cad"
            ]
        ]
    },
    {
        "id": "75aa9e12.49cad",
        "type": "function",
        "z": "e2d46b65.8c3d28",
        "name": "",
        "func": "const message = msg.req.query.message\n\nmsg.url = `http://bullseye/api/v1/qrcode/image.png?message=${message}`\n\nreturn msg",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 540,
        "y": 2060,
        "wires": [
            [
                "7111cb05.c11ef4"
            ]
        ]
    },
    {
        "id": "7111cb05.c11ef4",
        "type": "http request",
        "z": "e2d46b65.8c3d28",
        "name": "",
        "method": "GET",
        "ret": "bin",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 730,
        "y": 2060,
        "wires": [
            [
                "c25c52a6.c282d"
            ]
        ]
    },
    {
        "id": "c25c52a6.c282d",
        "type": "http response",
        "z": "e2d46b65.8c3d28",
        "name": "",
        "statusCode": "",
        "headers": {},
        "x": 910,
        "y": 2060,
        "wires": []
    },
    {
        "id": "e10ea17.548b96",
        "type": "debug",
        "z": "976482dc.415df",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 860,
        "y": 1120,
        "wires": []
    },
    {
        "id": "cb9bef38.9b83c",
        "type": "debug",
        "z": "976482dc.415df",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 790,
        "y": 1540,
        "wires": []
    },
    {
        "id": "c9948699.321c78",
        "type": "debug",
        "z": "976482dc.415df",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 610,
        "y": 1160,
        "wires": []
    }
]