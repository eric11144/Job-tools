import datetime
import os
import shutil
import sys

float_map = {
    'Brown1_CJ1M_CPU13' : [
        'D0110',
        'D0112',
        'D0114',
        'D0116',
        'D0150',
        'D0152'
    ],
    'Brown2_Q03UDVCPU' : [
        'D0100',
        'D0106',
        'D0108',
        'D0110',
        'D0120',
        'D0130',
        'D0140',
        'D0300',
        'D0310',
        'D0320',
        'D7700',
        'D07700',
        'D7702',
        'D07704'
    ],
    'DES1_Q03UDVCPU' : [
        'D0100',
        'D0106',
        'D0108',
        'D0110',
        'D0112',
        'D0116',
        'D0118',
        'D0120',
        'D0122',
        'D0124',
        'D0126',
        'D0130',
        'D0132',
        'D0134',
        'D0136',
        'D0140',
        'D0142',
        'D0144',
        'D0146',
        'D0150',
        'D0152',
        'D0154',
        'D0156',
        'D0160',
        'D0162',
        'D0164',
        'D0166',
        'D0170',
        'D0172',
        'D0174',
        'D0176',
        'D0180',
        'D0182',
        'D0184',
        'D0186',
        'D0190',
        'D0192',
        'D0200',
        'D0202',
        'D0204',
        'D0206',
        'D0208',
        'D0210',
        'D0212',
        'D0214',
        'D0216',
        'D0218',
        'D0220',
        'D0222',
        'D0230',
        'D0232',
        'D0234',
        'D0236',
        'D0250',
        'D0252',
        'D0254',
        'D0256',
        'D0380',
        'D0386',
        'D0390',
        'D0396',
        'D0900',
        'D0910',
        'D0920',
        'D0930',
        'D9560',
        'D9561',
        'D9562',
        'D9563'
    ],
    'DES2_Q03UDVCPU' : [
        'D100',
        'D0100',
        'D106',
        'D0106',
        'D108',
        'D0108',
        'D110',
        'D0110',
        'D112',
        'D0112',
        'D114',
        'D0114',
        'D116',
        'D0116',
        'D120',
        'D0120',
        'D122',
        'D0122',
        'D124',
        'D0124',
        'D126',
        'D0126',
        'D130',
        'D0130',
        'D132',
        'D0132',
        'D134',
        'D0134',
        'D136',
        'D0136',
        'D140',
        'D0140',
        'D142',
        'D0142',
        'D144',
        'D0144',
        'D146',
        'D0146',
        'D150',
        'D0150',
        'D152',
        'D0152',
        'D160',
        'D0160',
        'D162',
        'D0162',
        'D170',
        'D0170',
        'D172',
        'D0172',
        'D0174',
        'D180',
        'D0180',
        'D182',
        'D0182',
        'D0184',
        'D0186',
        'D190',
        'D0190',
        'D192',
        'D0192',
        'D200',
        'D0200',
        'D202',
        'D0202',
        'D0204',
        'D210',
        'D0210',
        'D212',
        'D0212',
        'D0214',
        'D0216',
        'D220',
        'D0220',
        'D222',
        'D0222',
        'D230',
        'D0230',
        'D231',
        'D0231',
        'D232',
        'D0232',
        'D240',
        'D0240',
        'D250',
        'D0250',
        'D260',
        'D0260',
        'D270',
        'D0270',
        'D9560',
        'D9561',
        'D9562',
        'D9563',
        'D9564',
        'D9660',
        'D9661',
        'D9662',
        'D9663',
        'D9664'
    ],
    'JY_iner_DES_fx3G_Unloader' : [
        'D0636',
        'D0656',
        'D0660',
        'D0662',
        'D0664',
        'D0666',
        'D0668',
        'D0672',
        'D0674',
        'D1760'
    ],
    'JY_iner_DES_Q03UDVCPU' : [
        'D0100',
        'D0106',
        'D0108',
        'D0110',
        'D0112',
        'D0114',
        'D0116',
        'D0120',
        'D0122',
        'D0124',
        'D0126',
        'D0130',
        'D0132',
        'D0134',
        'D0136',
        'D0138',
        'D0140',
        'D0142',
        'D0144',
        'D0146',
        'D0148',
        'D0150',
        'D0152',
        'D0153',
        'D0154',
        'D0156',
        'D0160',
        'D0162',
        'D0163',
        'D0164',
        'D0166',
        'D0170',
        'D0172',
        'D0173',
        'D0174',
        'D0176',
        'D0180',
        'D0182',
        'D0183',
        'D0184',
        'D0186',
        'D0190',
        'D0192',
        'D0193',
        'D0194',
        'D0196',
        'D0200',
        'D0202',
        'D0203',
        'D0204',
        'D0206',
        'D0210',
        'D0212',
        'D0213',
        'D0214',
        'D0216',
        'D0220',
        'D0222',
        'D0223',
        'D0224',
        'D0230',
        'D0231',
        'D0232',
        'D0233',
        'D0234',
        'D0236',
        'D0240',
        'D0242',
        'D0243',
        'D0244',
        'D0246',
        'D0250',
        'D0252',
        'D0253',
        'D0254',
        'D0256',
        'D0260',
        'D0262',
        'D0263',
        'D0264',
        'D0266',
        'D0330',
        'D0332',
        'D0334',
        'D0336',
        'D0360',
        'D0362',
        'D0404',
        'D0434',
        'D0454',
        'D0478',
        'D9110',
        'D9111',
        'D9112',
        'D9113',
        'D9114',
        'D9115',
        'D9117',
        'D9118',
        'D9119',
        'D9120',
        'D9121',
        'D9122',
        'D9123',
        'D9124',
        'D9125',
        'D9126',
        'D9128',
        'D9129',
        'D9130',
        'D9134',
        'D9563'
    ],
    'JY_Outer_DES_fx3G_Unloader' : [
        'D0602',
        'D0603',
        'D0604',
        'D0605',
        'D0607',
        'D0608',
        'D0609',
        'D0613',
        'D1720',
        'D1760',
        'D5670'
    ],
    'JY_Outer_DES_Main' : [
        'D0106',
        'D0108',
        'D0110',
        'D0112',
        'D0114',
        'D0116',
        'D0120',
        'D0122',
        'D0124',
        'D0126',
        'D0130',
        'D0132',
        'D0134',
        'D0136',
        'D0138',
        'D0140',
        'D0142',
        'D0144',
        'D0146',
        'D0148',
        'D0150',
        'D0152',
        'D0154',
        'D0156',
        'D0160',
        'D0162',
        'D0164',
        'D0166',
        'D0170',
        'D0172',
        'D0174',
        'D0176',
        'D0180',
        'D0182',
        'D0184',
        'D0186',
        'D0190',
        'D0194',
        'D0196',
        'D0200',
        'D0202',
        'D0204',
        'D0206',
        'D0210',
        'D0212',
        'D0214',
        'D0216',
        'D0220',
        'D0224',
        'D0226',
        'D0230',
        'D0231',
        'D0232',
        'D0234',
        'D0236',
        'D0240',
        'D0244',
        'D0246',
        'D0362',
        'D0404',
        'D0414',
        'D0434',
        'D9110',
        'D9111',
        'D9112',
        'D9113',
        'D9114',
        'D9115',
        'D9117',
        'D9118',
        'D9119',
        'D9120',
        'D9121',
        'D9122',
        'D9123',
        'D9124',
        'D9125',
        'D9126'
    ],
    'JY_P1_CS1G_CPU45H' : [
        'D0072',
        'D0082',
        'D0550',
        'D0551',
        'D0552',
        'D0553',
        'D0554',
        'D0555',
        'D0556',
        'D0557',
        'D0560',
        'D0561',
        'D0562',
        'D0563',
        'D0564',
        'D0565',
        'D0566',
        'D0567',
        'D0570',
        'D0650',
        'D0651',
        'D0652',
        'D0653',
        'D0654',
        'D0655',
        'D0656',
        'D0657',
        'D0658',
        'D0659',
        'D0680',
        'D0681',
        'D0682',
        'D0683',
        'D0684',
        'D0685',
        'D0686',
        'D0687',
        'D0688',
        'D0689',
        'D4200',
        'D4204',
        'D4208',
        'D4212',
        'D4220',
        'D4228',
        'D5700'
    ],
    'JY_P2_CS1G_CPU45H' : [
        'D0072',
        'D0082',
        'D0550',
        'D0551',
        'D0552',
        'D0553',
        'D0554',
        'D0555',
        'D0556',
        'D0557',
        'D0560',
        'D0561',
        'D0562',
        'D0563',
        'D0564',
        'D0565',
        'D0566',
        'D0567',
        'D0570',
        'D0650',
        'D0651',
        'D0652',
        'D0653',
        'D0654',
        'D0655',
        'D0656',
        'D0657',
        'D0658',
        'D0659',
        'D0680',
        'D0681',
        'D0682',
        'D0683',
        'D0684',
        'D0685',
        'D0686',
        'D0687',
        'D0688',
        'D0689',
        'D3622',
        'D3630',
        'D3631',
        'D4200',
        'D4204',
        'D4208',
        'D4212',
        'D4220',
        'D5700'
    ],
    'JY_P5_CS1G_CPU45H' : [
        'D0550',
        'D0551',
        'D0552',
        'D0553',
        'D0554',
        'D0555',
        'D0556',
        'D0557',
        'D0558',
        'D0559',
        'D0560',
        'D0561',
        'D0562',
        'D0563',
        'D0564',
        'D0565',
        'D0566',
        'D0567',
        'D0568',
        'D0569',
        'D0570',
        'D0650',
        'D0651',
        'D0652',
        'D0653',
        'D0654',
        'D0655',
        'D0656',
        'D0657',
        'D0658',
        'D0659',
        'D0660',
        'D0661',
        'D0680',
        'D0681',
        'D0682',
        'D0683',
        'D0684',
        'D0685',
        'D0686',
        'D0687',
        'D0688',
        'D0689',
        'D0690',
        'D0691',
        'D3600',
        'D3601',
        'D3602',
        'D3603',
        'D3604',
        'D3605',
        'D3606',
        'D3607',
        'D3608',
        'D3609',
        'D3610',
        'D3611',
        'D3612',
        'D3613',
        'D3614',
        'D3615',
        'D3616',
        'D3617',
        'D3618',
        'D3619',
        'D3620',
        'D3621',
        'D3622',
        'D3623',
        'D3624',
        'D3625',
        'D3626',
        'D3627',
        'D3628',
        'D3629',
        'D3630',
        'D3631',
        'D4200',
        'D4206',
        'D4212',
        'D4218',
        'D4224',
        'D4230',
        'D4236',
        'D5700'
    ],
    'JY_P6_CS1G_CPU45H' : [
        'D0550',
        'D0551',
        'D0552',
        'D0553',
        'D0554',
        'D0555',
        'D0556',
        'D0557',
        'D0558',
        'D0559',
        'D0560',
        'D0561',
        'D0562',
        'D0563',
        'D0564',
        'D0565',
        'D0566',
        'D0567',
        'D0568',
        'D0569',
        'D570',
        'D0570',
        'D0651',
        'D0652',
        'D0653',
        'D0654',
        'D0655',
        'D0656',
        'D0657',
        'D0658',
        'D0659',
        'D0660',
        'D0661',
        'D3600',
        'D3601',
        'D3602',
        'D3603',
        'D3604',
        'D3605',
        'D3606',
        'D3607',
        'D3610',
        'D3611',
        'D3612',
        'D3613',
        'D3614',
        'D3615',
        'D3616',
        'D3617',
        'D3620',
        'D3621',
        'D3622',
        'D3623',
        'D3624',
        'D3625',
        'D3626',
        'D3627',
        'D3630',
        'D3631',
        'D4200',
        'D4206',
        'D4212',
        'D4218',
        'D4224',
        'D4230',
        'D4236',
        'D4237',
        'D5700'
    ],
    'JY_S2_FX3G_Loader' : [
        'D0580',
        'D0584',
        'D0920',
        'D0924',
        'D1022',
        'D1024',
        'D1026',
        'D1028',
        'D1090'
    ],
    'JY_S2_FX3G_Unloader' : [
        'D1000'
    ],
    'JY_S2_Q02UCPU' : [
        'D0108',
        'D0110',
        'D0112',
        'D0605',
        'D0606',
        "D9124"
    ],
    'laminating_machine_1' : [
        'D0217',
        'D0218',
        'D0219',
        'D0351',
        'D0352',
        'D0353',
        'D0355',
        'D0356',
        'D0357',
        'D0360',
        'D0365',
        'D0370',
        'D0371'
    ],
    'laminating_machine_2' : [
        'D0217',
        'D0218',
        'D0219',
        'D0351',
        'D0352',
        'D0353',
        'D0355',
        'D0356',
        'D0357',
        'D0360',
        'D0365',
        'D0370',
        'D0371'
    ],
    'laminating_machine_3' : [
        'D0217',
        'D0218',
        'D0219',
        'D0351',
        'D0352',
        'D0353',
        'D0355',
        'D0356',
        'D0357',
        'D0360',
        'D0365',
        'D0370',
        'D0371'
    ],
    'Micro_etching_CJ1M_CPU11' : [
        'D0100',
        'D0106',
        'D0108',
        'D0110',
        'D0120',
        'D0130',
        'D0140',
        'D0150',
        'D0206',
        'D0208',
        'D0218',
        'D2012',
        'D2022',
        'D2032',
        'D2042',
        'D2102',
        'D2112',
        'D2122',
        'D2132',
        'D2142',
        'D2262',
        'D2272',
        'D2282',
        'D2292',
        'D2312',
        'D2322',
        'D2332',
        'D2342',
        'D2402',
        'D2412',
        'D2422',
        'D2432',
        'D2442',
        'D2502',
        'D2512',
        'D2522',
        'D2532',
        'D2542',
        'D2552',
        'D2562',
        'D2572',
        'D2582',
        'D2592',
        'D2612',
        'D2622',
        'D2632',
        'D2642',
        'D2812',
        'D2822',
        'D2832',
        'D2842',
        'D3002',
        'D3004',
        'D3006',
        'D3012',
        'D3014',
        'D3016',
        'D3022',
        'D3024',
        'D3026',
        'D3032',
        'D3034',
        'D3036',
        'D3042',
        'D3044',
        'D3046'
    ],
    'OUTDES_CJ1G_CPU44H' : [
        'D0100',
        'D0102',
        'D0104',
        'D0110',
        'D0112',
        'D0114',
        'D0116',
        'D0120',
        'D0122',
        'D0124',
        'D0126',
        'D0130',
        'D0132',
        'D0134',
        'D0136',
        'D0140',
        'D0142',
        'D0144',
        'D0146',
        'D0160',
        'D0162',
        'D0166',
        'D0170',
        'D0172',
        'D0176',
        'D0180',
        'D0182',
        'D0186',
        'D0190',
        'D0192',
        'D0196',
        'D0200',
        'D0202',
        'D0206',
        'D0210',
        'D0212',
        'D0216',
        'D0220',
        'D0222',
        'D0226',
        'D0230',
        'D0232',
        'D0236',
        'D0240',
        'D0242',
        'D0246',
        'D0250',
        'D0252',
        'D0260',
        'D0262',
        'D0276',
        'D1501',
        'D1504',
        'D1507',
        'D1510',
        'D1513',
        'D1516',
        'D1519',
        'D1522',
        'D1525',
        'D1528'
    ],
    'Polluted_water_fx5u' : [
        'R0001',
        'R0201',
        'R0202',
        'R0203',
        'R0204',
        'R0205',
        'R0206',
        'R0207',
        'R0208',
        'R0401',
        'R0402',
        'R0601',
        'R0603',
        'R1002',
        'R1023',
        'R1202'
    ],
    'Shadow_fx3u_Unloader' : [
        'R224',
        'R0224',
        'R234',
        'R0234'
    ],
    'Shadow_Q02UCPU' : [
        'D100',
        'D106',
        'D108',
        'D110',
        'D0120',
        'D0121',
        'D586',
        'D0100',
        'D0106',
        'D0108',
        'D0110',
        'D0122',
        'D0586'
    ],
    'VCP1_CS1G_CPU45H' : [
        'D550',
        'D0550',
        'D551',
        'D0551',
        'D552',
        'D0552',
        'D553',
        'D0553',
        'D554',
        'D0554',
        'D555',
        'D0555',
        'D556',
        'D0556',
        'D557',
        'D0557',
        'D560',
        'D0560',
        'D561',
        'D0561',
        'D562',
        'D0562',
        'D563',
        'D0563',
        'D564',
        'D0564',
        'D565',
        'D0565',
        'D566',
        'D0566',
        'D567',
        'D0567',
        'D570',
        'D0570',
        'D4200',
        'D4204',
        'D4208',
        'D4212',
        'D4216',
        'D4220',
        'D5700'
    ],
    'VCP2_CS1G_CPU45H' : [
        'D550',
        'D0550',
        'D551',
        'D0551',
        'D552',
        'D0552',
        'D553',
        'D0553',
        'D554',
        'D0554',
        'D555',
        'D0555',
        'D560',
        'D0560',
        'D561',
        'D0561',
        'D562',
        'D0562',
        'D563',
        'D0563',
        'D564',
        'D0564',
        'D565',
        'D0565',
        'D570',
        'D0570',
        'D4200',
        'D4201',
        'D4204',
        'D4208',
        'D4212',
        'D4213',
        'D4216',
        'D4217',
        'D4220',
        'D4221',
        'D4224',
        'D4225',
        'D5700'
    ],
    'VCP2_fx3u_ht_Loader' : [
        'D207',
        'D0207',
        'D215',
        'D0215',
        'D220',
        'D0220',
        'D223',
        'D0223',
        'D224',
        'D0224',
        'D232',
        'D0232',
        'D234',
        'D0234',
        'D238',
        'D0238',
        'D350',
        'D0350',
        'D352',
        'D0352',
        'D2002',
        'D2022',
        'D2210',
        'D2214',
        'D2220',
        'D3000'
    ],
    'VCP2_fx3u_ht_Unloader' : [
        'D0255',
        'D0256'
    ],
    'VCP3_CS1G_CPU45H' : [
        'D550',
        'D0550',
        'D551',
        'D0551',
        'D552',
        'D0552',
        'D553',
        'D0553',
        'D554',
        'D0554',
        'D555',
        'D0555',
        'D556',
        'D0556',
        'D557',
        'D0557',
        'D560',
        'D0560',
        'D561',
        'D0561',
        'D562',
        'D0562',
        'D563',
        'D0563',
        'D564',
        'D0564',
        'D565',
        'D0565',
        'D566',
        'D0566',
        'D567',
        'D0567',
        'D570',
        'D0570',
        'D4200',
        'D4204',
        'D4208',
        'D4212',
        'D4220',
        'D4221',
        'D4224',
        'D5000',
        'D5001',
        'D5002',
        'D5003',
        'D5004',
        'D5005',
        'D5006',
        'D5007',
        'D5008',
        'D5009',
        'D5010',
        'D5030',
        'D5031',
        'D5032',
        'D5033',
        'D5034',
        'D5035',
        'D5036',
        'D5037',
        'D5038',
        'D5039',
        'D5040',
        'D5700'
    ],
    'VCP3_fx3u_ht_Loader' : [
        'D200',
        'D0200',
        'D220',
        'D0220',
        'D223',
        'D0223',
        'D224',
        'D0224',
        'D0234',
        'D350',
        'D0350',
        'D512',
        'D0512'
    ],
    'VCP3_fx3u_ht_Unloader' : [
        'D0216',
        'D0220',
        'D0232',
        'D0234',
        'D2210',
        'D2214'
    ],
    'VCP5_CS1G_CPU45H' : [
        'D550',
        'D0550',
        'D551',
        'D0551',
        'D552',
        'D0552',
        'D553',
        'D0553',
        'D554',
        'D0554',
        'D555',
        'D0555',
        'D556',
        'D0556',
        'D557',
        'D0557',
        'D560',
        'D0560',
        'D561',
        'D0561',
        'D562',
        'D0562',
        'D563',
        'D0563',
        'D564',
        'D0564',
        'D565',
        'D0565',
        'D566',
        'D0566',
        'D567',
        'D0567',
        'D570',
        'D0570',
        'D650',
        'D0650',
        'D651',
        'D0651',
        'D652',
        'D0652',
        'D653',
        'D0653',
        'D654',
        'D0654',
        'D655',
        'D0655',
        'D656',
        'D0656',
        'D657',
        'D0657',
        'D658',
        'D0658',
        'D685',
        'D0685',
        'D686',
        'D0686',
        'D687',
        'D0687',
        'D688',
        'D0688',
        'D689',
        'D0689',
        'D4200',
        'D4204',
        'D4208',
        'D4212',
        'D4220',
        'D4221',
        'D4228',
        'D5700'
    ],
    'DES2-Q03UDVCPU' : [
        'D0100',
        'D0106',
        'D0108',
        'D0110',
        'D0114',
        'D0116',
        'D0120',
        'D0124',
        'D0126',
        'D0130',
        'D0134',
        'D0136',
        'D0140',
        'D0142',
        'D0144',
        'D0146',
        'D0150',
        'D0152',
        'D0160',
        'D0162',
        'D0170',
        'D0180',
        'D0182',
        'D0190',
        'D0200',
        'D0202',
        'D0210',
        'D0212',
        'D0220',
        'D0230',
        'D0240',
        'D0250',
        'D0260',
        'D9560',
        'D9561',
        'D9562',
        'D9563',
        'D9660',
        'D9661',
        'D9662',
        'D9663',
        'D9664'
    ],
    'Shadow_fx3u_Loader' : [
        'D0560',
        'D0564',
        'R224',
        'R0224',
        'R234',
        'R0234'
    ],
    'JY_Polluted_water_Q03_PLC_1' : [
        'D0501',
        'D0503',
        'D0505',
        'D0507',
        'D0508',
        'D0509',
        'D0517',
        'D0519',
        'D0520',
        'D0522',
        'D2104',
        'D2105',
        'D2112',
        'D2113',
        'D2220',
        'D2221',
        'D2222',
        'D2223',
        'D2224',
        'D2225'
    ],
    'virtual' : [
        'Assay_Plating_Cl_P6',
        'Assay_MicroEtch_H2SO4_P5',
        'Assay_MicroEtch_NaPS_P6'
    ],
    'JY_P3_CS1G_CPU45H' : [
        'D0650',
        'D0651',
        'D0652',
        'D0654',
        'D0656',
        'D0657',
        'D0658',
        'D0659',
        'D0660',
        'D3604'
    ]
}

str_map = {
    'virtual' : [
        'AssayLastStore_Date_AntiOxidation_H2SO4_V1',
        'AssayLastStore_Date_AntiOxidation_H2SO4_V3',
        'AssayLastStore_Date_MicroEtch_Cu2_P1',
        'AssayLastStore_Date_MicroEtch_Cu2_V1',
        'AssayLastStore_Date_MicroEtch_Cu2_V2',
        'AssayLastStore_Date_MicroEtch_Cu2_V3',
        'AssayLastStore_Date_MicroEtch_Cu2_V5',
        'AssayLastStore_Date_MicroEtch_H2SO4_P1',
        'AssayLastStore_Date_MicroEtch_H2SO4_V1',
        'AssayLastStore_Date_MicroEtch_H2SO4_V2',
        'AssayLastStore_Date_MicroEtch_H2SO4_V3',
        'AssayLastStore_Date_MicroEtch_H2SO4_V5',
        'AssayLastStore_Date_MicroEtch_NaPS_P1',
        'AssayLastStore_Date_MicroEtch_NaPS_V2',
        'AssayLastStore_Date_MicroEtch_NaPS_V3',
        'AssayLastStore_Date_MicroEtch_NaPS_V5',
        'AssayLastStore_Date_MicroEtch_SPS_V1',
        'AssayLastStore_Date_Plating_Cl_P1',
        'AssayLastStore_Date_Plating_Cl_V1',
        'AssayLastStore_Date_Plating_Cl_V2',
        'AssayLastStore_Date_Plating_Cl_V3',
        'AssayLastStore_Date_Plating_Cl_V5',
        'AssayLastStore_Date_Plating_Cu2_P1',
        'AssayLastStore_Date_Plating_Cu2_V1',
        'AssayLastStore_Date_Plating_Cu2_V2',
        'AssayLastStore_Date_Plating_Cu2_V3',
        'AssayLastStore_Date_Plating_Cu2_V5',
        'AssayLastStore_Date_Plating_EVF15_B_V3',
        'AssayLastStore_Date_Plating_EVF15_B_V5',
        'AssayLastStore_Date_Plating_EVF15_C_V3',
        'AssayLastStore_Date_Plating_EVF15_C_V5',
        'AssayLastStore_Date_Plating_EVF15_L_V3',
        'AssayLastStore_Date_Plating_EVF15_L_V5',
        'AssayLastStore_Date_Plating_EVF_B_V1',
        'AssayLastStore_Date_Plating_EVF_C_V1',
        'AssayLastStore_Date_Plating_EVF_L_V1',
        'AssayLastStore_Date_Plating_H2SO4_P1',
        'AssayLastStore_Date_Plating_H2SO4_V1',
        'AssayLastStore_Date_Plating_H2SO4_V2',
        'AssayLastStore_Date_Plating_H2SO4_V3',
        'AssayLastStore_Date_Plating_H2SO4_V5',
        'AssayLastStore_Date_Plating_HS200A_P1',
        'AssayLastStore_Date_Plating_HS200B_P1',
        'AssayLastStore_Date_Plating_Hs200A_V2',
        'AssayLastStore_Date_Plating_Hs200B_V2',
        'AssayLastStore_Date_Plating_TOC_P1',
        'AssayLastStore_Date_Plating_TOC_V1',
        'AssayLastStore_Date_Plating_TOC_V2',
        'AssayLastStore_Date_Plating_TOC_V3',
        'AssayLastStore_Date_Plating_TOC_V5',
        'AssayLastStore_Date_Prepreg_H2SO4_P1',
        'AssayLastStore_Date_Prepreg_H2SO4_V1',
        'AssayLastStore_Date_Prepreg_H2SO4_V2',
        'AssayLastStore_Date_Prepreg_H2SO4_V3',
        'AssayLastStore_Date_Prepreg_H2SO4_V5',
        'AssayLastStore_Time_AntiOxidation_H2SO4_V1',
        'AssayLastStore_Time_AntiOxidation_H2SO4_V3',
        'AssayLastStore_Time_MicroEtch_Cu2_P1',
        'AssayLastStore_Time_MicroEtch_Cu2_V1',
        'AssayLastStore_Time_MicroEtch_Cu2_V2',
        'AssayLastStore_Time_MicroEtch_Cu2_V3',
        'AssayLastStore_Time_MicroEtch_Cu2_V5',
        'AssayLastStore_Time_MicroEtch_H2SO4_P1',
        'AssayLastStore_Time_MicroEtch_H2SO4_V1',
        'AssayLastStore_Time_MicroEtch_H2SO4_V2',
        'AssayLastStore_Time_MicroEtch_H2SO4_V3',
        'AssayLastStore_Time_MicroEtch_H2SO4_V5',
        'AssayLastStore_Time_MicroEtch_NaPS_P1',
        'AssayLastStore_Time_MicroEtch_NaPS_V2',
        'AssayLastStore_Time_MicroEtch_NaPS_V3',
        'AssayLastStore_Time_MicroEtch_NaPS_V5',
        'AssayLastStore_Time_MicroEtch_SPS_V1',
        'AssayLastStore_Time_Plating_Cl_P1',
        'AssayLastStore_Time_Plating_Cl_V1',
        'AssayLastStore_Time_Plating_Cl_V2',
        'AssayLastStore_Time_Plating_Cl_V3',
        'AssayLastStore_Time_Plating_Cl_V5',
        'AssayLastStore_Time_Plating_Cu2_P1',
        'AssayLastStore_Time_Plating_Cu2_V1',
        'AssayLastStore_Time_Plating_Cu2_V2',
        'AssayLastStore_Time_Plating_Cu2_V3',
        'AssayLastStore_Time_Plating_Cu2_V5',
        'AssayLastStore_Time_Plating_EVF15_B_V3',
        'AssayLastStore_Time_Plating_EVF15_B_V5',
        'AssayLastStore_Time_Plating_EVF15_C_V3',
        'AssayLastStore_Time_Plating_EVF15_C_V5',
        'AssayLastStore_Time_Plating_EVF15_L_V3',
        'AssayLastStore_Time_Plating_EVF15_L_V5',
        'AssayLastStore_Time_Plating_EVF_B_V1',
        'AssayLastStore_Time_Plating_EVF_C_V1',
        'AssayLastStore_Time_Plating_EVF_L_V1',
        'AssayLastStore_Time_Plating_H2SO4_P1',
        'AssayLastStore_Time_Plating_H2SO4_V1',
        'AssayLastStore_Time_Plating_H2SO4_V2',
        'AssayLastStore_Time_Plating_H2SO4_V3',
        'AssayLastStore_Time_Plating_H2SO4_V5',
        'AssayLastStore_Time_Plating_HS200A_P1',
        'AssayLastStore_Time_Plating_HS200B_P1',
        'AssayLastStore_Time_Plating_Hs200A_V2',
        'AssayLastStore_Time_Plating_Hs200B_V2',
        'AssayLastStore_Time_Plating_TOC_P1',
        'AssayLastStore_Time_Plating_TOC_V1',
        'AssayLastStore_Time_Plating_TOC_V2',
        'AssayLastStore_Time_Plating_TOC_V3',
        'AssayLastStore_Time_Plating_TOC_V5',
        'AssayLastStore_Time_Prepreg_H2SO4_P1',
        'AssayLastStore_Time_Prepreg_H2SO4_V1',
        'AssayLastStore_Time_Prepreg_H2SO4_V2',
        'AssayLastStore_Time_Prepreg_H2SO4_V3',
        'AssayLastStore_Time_Prepreg_H2SO4_V5',
        'AssayValueLastStoreTimeV1',
        'AssayValueLastStoreTimeV2',
        'AssayValueLastStoreTimeV3',
        'AssayValueLastStoreTimeV5',
        'Assay_AntiOxidation_H2SO4_V1',
        'Assay_AntiOxidation_H2SO4_V3',
        'Assay_MicroEtch_Cu2_P1',
        'Assay_MicroEtch_Cu2_V1',
        'Assay_MicroEtch_Cu2_V2',
        'Assay_MicroEtch_Cu2_V3',
        'Assay_MicroEtch_Cu2_V5',
        'Assay_MicroEtch_H2SO4_P1',
        'Assay_MicroEtch_H2SO4_V1',
        'Assay_MicroEtch_H2SO4_V2',
        'Assay_MicroEtch_H2SO4_V3',
        'Assay_MicroEtch_H2SO4_V5',
        'Assay_MicroEtch_NaPS_P1',
        'Assay_MicroEtch_NaPS_V2',
        'Assay_MicroEtch_NaPS_V3',
        'Assay_MicroEtch_NaPS_V5',
        'Assay_MicroEtch_SPS_V1',
        'Assay_Plating_Cl_P1',
        'Assay_Plating_Cl_V1',
        'Assay_Plating_Cl_V2',
        'Assay_Plating_Cl_V3',
        'Assay_Plating_Cl_V5',
        'Assay_Plating_Cu2_P1',
        'Assay_Plating_Cu2_V1',
        'Assay_Plating_Cu2_V2',
        'Assay_Plating_Cu2_V3',
        'Assay_Plating_Cu2_V5',
        'Assay_Plating_EVF15_B_JYP5',
        'Assay_Plating_EVF15_B_JYP6',
        'Assay_Plating_EVF15_B_V3',
        'Assay_Plating_EVF15_B_V5',
        'Assay_Plating_EVF15_C_V3',
        'Assay_Plating_EVF15_C_V5',
        'Assay_Plating_EVF15_L_V3',
        'Assay_Plating_EVF15_L_V5',
        'Assay_Plating_EVF_B_V1',
        'Assay_Plating_EVF_C_V1',
        'Assay_Plating_EVF_L_V1',
        'Assay_Plating_H2SO4_P1',
        'Assay_Plating_H2SO4_V1',
        'Assay_Plating_H2SO4_V2',
        'Assay_Plating_H2SO4_V3',
        'Assay_Plating_H2SO4_V5',
        'Assay_Plating_HS200A_P1',
        'Assay_Plating_HS200B_P1',
        'Assay_Plating_Hs200A_JYP1',
        'Assay_Plating_Hs200A_V2',
        'Assay_Plating_Hs200B_JYP1',
        'Assay_Plating_Hs200B_V2',
        'Assay_Plating_Hv606A_JYP2',
        'Assay_Plating_Hv606B_JYP2',
        'Assay_Plating_TOC_P1',
        'Assay_Plating_TOC_V1',
        'Assay_Plating_TOC_V2',
        'Assay_Plating_TOC_V3',
        'Assay_Plating_TOC_V5',
        'Assay_Prepreg_H2SO4_P1',
        'Assay_Prepreg_H2SO4_V1',
        'Assay_Prepreg_H2SO4_V2',
        'Assay_Prepreg_H2SO4_V3',
        'Assay_Prepreg_H2SO4_V5',
        'TOP1nameV1',
        'TOP1valueV1',
        'TOP2nameV1',
        'TOP2valueV1',
        'TOP3nameV1',
        'TOP3valueV1',
        'VirCurrent11BV1',
        'VirCurrent11BV2',
        'VirCurrent11BV3',
        'VirCurrent11BV5',
        'VirCurrent11FV1',
        'VirCurrent11FV2',
        'VirCurrent11FV3',
        'VirCurrent11FV5',
        'VirCurrent12BV1',
        'VirCurrent12BV2',
        'VirCurrent12BV3',
        'VirCurrent12BV5',
        'VirCurrent12FV1',
        'VirCurrent12FV2',
        'VirCurrent12FV3',
        'VirCurrent12FV5',
        'VirCurrent13BV1',
        'VirCurrent13BV2',
        'VirCurrent13BV3',
        'VirCurrent13BV5',
        'VirCurrent13FV1',
        'VirCurrent13FV2',
        'VirCurrent13FV3',
        'VirCurrent13FV5',
        'VirCurrent14BV1',
        'VirCurrent14BV2',
        'VirCurrent14BV3',
        'VirCurrent14BV5',
        'VirCurrent14FV1',
        'VirCurrent14FV2',
        'VirCurrent14FV3',
        'VirCurrent14FV5',
        'VirCurrent21BV1',
        'VirCurrent21BV2',
        'VirCurrent21BV3',
        'VirCurrent21BV5',
        'VirCurrent21FV1',
        'VirCurrent21FV2',
        'VirCurrent21FV3',
        'VirCurrent21FV5',
        'VirCurrent22BV1',
        'VirCurrent22BV2',
        'VirCurrent22BV3',
        'VirCurrent22BV5',
        'VirCurrent22FV1',
        'VirCurrent22FV2',
        'VirCurrent22FV3',
        'VirCurrent22FV5',
        'VirCurrent23BV1',
        'VirCurrent23BV2',
        'VirCurrent23BV3',
        'VirCurrent23BV5',
        'VirCurrent23FV1',
        'VirCurrent23FV2',
        'VirCurrent23FV3',
        'VirCurrent23FV5',
        'VirCurrent24BV1',
        'VirCurrent24BV2',
        'VirCurrent24BV3',
        'VirCurrent24BV5',
        'VirCurrent24FV1',
        'VirCurrent24FV2',
        'VirCurrent24FV3',
        'VirCurrent24FV5',
        'VirCurrent31BV1',
        'VirCurrent31BV2',
        'VirCurrent31BV3',
        'VirCurrent31BV5',
        'VirCurrent31FV1',
        'VirCurrent31FV2',
        'VirCurrent31FV3',
        'VirCurrent31FV5',
        'VirCurrent32BV1',
        'VirCurrent32BV2',
        'VirCurrent32BV3',
        'VirCurrent32BV5',
        'VirCurrent32FV1',
        'VirCurrent32FV2',
        'VirCurrent32FV3',
        'VirCurrent32FV5',
        'VirCurrent33BV1',
        'VirCurrent33BV2',
        'VirCurrent33BV3',
        'VirCurrent33BV5',
        'VirCurrent33FV1',
        'VirCurrent33FV2',
        'VirCurrent33FV3',
        'VirCurrent33FV5',
        'VirCurrent34BV1',
        'VirCurrent34BV2',
        'VirCurrent34BV3',
        'VirCurrent34BV5',
        'VirCurrent34FV1',
        'VirCurrent34FV2',
        'VirCurrent34FV3',
        'VirCurrent34FV5',
        'VirCurrent41BV1',
        'VirCurrent41BV3',
        'VirCurrent41BV5',
        'VirCurrent41FV1',
        'VirCurrent41FV3',
        'VirCurrent41FV5',
        'VirCurrent42BV1',
        'VirCurrent42BV3',
        'VirCurrent42BV5',
        'VirCurrent42FV1',
        'VirCurrent42FV3',
        'VirCurrent42FV5',
        'VirCurrent43BV1',
        'VirCurrent43BV3',
        'VirCurrent43BV5',
        'VirCurrent43FV1',
        'VirCurrent43FV3',
        'VirCurrent43FV5',
        'VirCurrent44BV1',
        'VirCurrent44BV3',
        'VirCurrent44BV5',
        'VirCurrent44FV1',
        'VirCurrent44FV3',
        'VirCurrent44FV5',
        'VirD3210V1',
        'VirD3210V2',
        'VirD3210V3',
        'VirD3210V5',
        'VirPercentageTotalAHJYP1',
        'VirPercentageTotalAHJYP2',
        'VirPercentageTotalAHJYP5',
        'VirPercentageTotalAHJYP6',
        'VirPercentageTotalAHV1',
        'VirPercentageTotalAHV2',
        'VirPercentageTotalAHV3',
        'VirPercentageTotalAHV5',
        'VirPlating1TempV1',
        'VirPlating1TempV2',
        'VirPlating1TempV3',
        'VirPlating1TempV5',
        'VirPlating2TempV1',
        'VirPlating2TempV2',
        'VirPlating2TempV3',
        'VirPlating2TempV5',
        'VirPlating3TempV1',
        'VirPlating3TempV2',
        'VirPlating3TempV3',
        'VirPlating3TempV5',
        'VirPlating4TempV1',
        'VirPlating4TempV3',
        'VirPlating4TempV5',
        'VirPlatingFlowPressure1BV1',
        'VirPlatingFlowPressure1BV2',
        'VirPlatingFlowPressure1BV3',
        'VirPlatingFlowPressure1BV5',
        'VirPlatingFlowPressure1FV1',
        'VirPlatingFlowPressure1FV2',
        'VirPlatingFlowPressure1FV3',
        'VirPlatingFlowPressure1FV5',
        'VirPlatingFlowPressure2BV1',
        'VirPlatingFlowPressure2BV2',
        'VirPlatingFlowPressure2BV3',
        'VirPlatingFlowPressure2BV5',
        'VirPlatingFlowPressure2FV1',
        'VirPlatingFlowPressure2FV2',
        'VirPlatingFlowPressure2FV3',
        'VirPlatingFlowPressure2FV5',
        'VirPlatingFlowPressure3BV1',
        'VirPlatingFlowPressure3BV2',
        'VirPlatingFlowPressure3BV3',
        'VirPlatingFlowPressure3BV5',
        'VirPlatingFlowPressure3FV1',
        'VirPlatingFlowPressure3FV2',
        'VirPlatingFlowPressure3FV3',
        'VirPlatingFlowPressure3FV5',
        'VirPlatingFlowPressure4BV1',
        'VirPlatingFlowPressure4BV3',
        'VirPlatingFlowPressure4BV5',
        'VirPlatingFlowPressure4FV1',
        'VirPlatingFlowPressure4FV3',
        'VirPlatingFlowPressure4FV5',
        'VirPurgePress1BV1',
        'VirPurgePress1BV2',
        'VirPurgePress1BV3',
        'VirPurgePress1BV5',
        'VirPurgePress1FV1',
        'VirPurgePress1FV2',
        'VirPurgePress1FV3',
        'VirPurgePress1FV5',
        'VirPurgePress2BV1',
        'VirPurgePress2BV2',
        'VirPurgePress2BV3',
        'VirPurgePress2BV5',
        'VirPurgePress2FV1',
        'VirPurgePress2FV2',
        'VirPurgePress2FV3',
        'VirPurgePress2FV5',
        'VirPurgePress3BV1',
        'VirPurgePress3BV2',
        'VirPurgePress3BV3',
        'VirPurgePress3BV5',
        'VirPurgePress3FV1',
        'VirPurgePress3FV2',
        'VirPurgePress3FV3',
        'VirPurgePress3FV5',
        'VirPurgePress4BV1',
        'VirPurgePress4BV3',
        'VirPurgePress4BV5',
        'VirPurgePress4FV1',
        'VirPurgePress4FV3',
        'VirPurgePress4FV5',
        'VirShutter11V1',
        'VirShutter11V2',
        'VirShutter11V3',
        'VirShutter11V5',
        'VirShutter12V1',
        'VirShutter12V2',
        'VirShutter12V3',
        'VirShutter12V5',
        'VirShutter13V1',
        'VirShutter13V2',
        'VirShutter13V3',
        'VirShutter13V5',
        'VirShutter14V1',
        'VirShutter14V2',
        'VirShutter14V3',
        'VirShutter14V5',
        'VirShutter21V1',
        'VirShutter21V2',
        'VirShutter21V3',
        'VirShutter21V5',
        'VirShutter22V1',
        'VirShutter22V2',
        'VirShutter22V3',
        'VirShutter22V5',
        'VirShutter23V1',
        'VirShutter23V2',
        'VirShutter23V3',
        'VirShutter23V5',
        'VirShutter24V1',
        'VirShutter24V2',
        'VirShutter24V3',
        'VirShutter24V5',
        'VirShutter31V1',
        'VirShutter31V2',
        'VirShutter31V3',
        'VirShutter31V5',
        'VirShutter32V1',
        'VirShutter32V2',
        'VirShutter32V3',
        'VirShutter32V5',
        'VirShutter33V1',
        'VirShutter33V2',
        'VirShutter33V3',
        'VirShutter33V5',
        'VirShutter34V1',
        'VirShutter34V2',
        'VirShutter34V3',
        'VirShutter34V5',
        'VirShutter41V1',
        'VirShutter41V3',
        'VirShutter41V5',
        'VirShutter42V1',
        'VirShutter42V3',
        'VirShutter42V5',
        'VirShutter43V1',
        'VirShutter43V3',
        'VirShutter43V5',
        'VirShutter44V1',
        'VirShutter44V3',
        'VirShutter44V5',
        'VirTiPerBTypeJYP1',
        'VirTiPerBTypeJYP2',
        'VirTiPerBTypeJYP5',
        'VirTiPerBTypeJYP6',
        'VirTiPerBTypeV1',
        'VirTiPerBTypeV2',
        'VirTiPerBTypeV3',
        'VirTiPerBTypeV5',
        'VirTiPerCDJYP1',
        'VirTiPerCDJYP2',
        'VirTiPerCDJYP5',
        'VirTiPerCDJYP6',
        'VirTiPerCDV1',
        'VirTiPerCDV2',
        'VirTiPerCDV3',
        'VirTiPerCDV5',
        'VirTiPerCommJYP1',
        'VirTiPerCommJYP2',
        'VirTiPerCommJYP5',
        'VirTiPerCommJYP6',
        'VirTiPerCommV1',
        'VirTiPerCommV2',
        'VirTiPerCommV3',
        'VirTiPerCommV5',
        'VirTiPerCostCommJYP1',
        'VirTiPerCostCommJYP2',
        'VirTiPerCostCommJYP5',
        'VirTiPerCostCommJYP6',
        'VirTiPerCostCommV1',
        'VirTiPerCostCommV2',
        'VirTiPerCostCommV3',
        'VirTiPerCostCommV5',
        'VirTiPerCostJYP1',
        'VirTiPerCostJYP2',
        'VirTiPerCostJYP5',
        'VirTiPerCostJYP6',
        'VirTiPerCostV1',
        'VirTiPerCostV2',
        'VirTiPerCostV3',
        'VirTiPerCostV5',
        'VirTiPerJYP1',
        'VirTiPerJYP2',
        'VirTiPerJYP5',
        'VirTiPerJYP6',
        'VirTiPerProviderJYP1',
        'VirTiPerProviderJYP2',
        'VirTiPerProviderJYP5',
        'VirTiPerProviderJYP6',
        'VirTiPerProviderV1',
        'VirTiPerProviderV2',
        'VirTiPerProviderV3',
        'VirTiPerProviderV5',
        'VirTiPerUsedCommJYP1',
        'VirTiPerUsedCommJYP2',
        'VirTiPerUsedCommJYP5',
        'VirTiPerUsedCommJYP6',
        'VirTiPerUsedCommV1',
        'VirTiPerUsedCommV2',
        'VirTiPerUsedCommV3',
        'VirTiPerUsedCommV5',
        'VirTiPerUsedJYP1',
        'VirTiPerUsedJYP2',
        'VirTiPerUsedJYP5',
        'VirTiPerUsedJYP6',
        'VirTiPerUsedV1',
        'VirTiPerUsedV2',
        'VirTiPerUsedV3',
        'VirTiPerUsedV5',
        'VirTiPerV1',
        'VirTiPerV2',
        'VirTiPerV3',
        'VirTiPerV5',
        'VirTiToolIDJYP1',
        'VirTiToolIDJYP2',
        'VirTiToolIDJYP5',
        'VirTiToolIDJYP6',
        'VirTiToolIDV1',
        'VirTiToolIDV2',
        'VirTiToolIDV3',
        'VirTiToolIDV5',
        'VirW026114V3',
        'VirtualAddNoteV1',
        'VirtualAddNoteV2',
        'VirtualAddNoteV3',
        'VirtualAddNoteV5',
        'VirtualD9101V1',
        'VirtualD9101V2',
        'VirtualD9101V3',
        'VirtualD9101V5',
        'VirtualSuggestAHV1',
        'VirtualSuggestAHV2',
        'VirtualSuggestAHV3',
        'VirtualSuggestAHV5',
        'VirtualW026001V3',
        'VirtualW026001V5',
        'VirtualW026007V1',
        'VirtualW026007V2'
    ]
}

out_of_list = [
    'detect_board',
    'ink_CJ1M_CPU13',
    'IT_TEST',
    'P1_fx3u_ht_Loader',
    'P1_CS1G_CPU45H',
    'P1_fx3u_ht-Unloader',
    'VCP2_CS1G_CPU45H_utilization',
    'work_time'
]


def get_csv_list(file_dir):
    file_list = []

    for files in os.listdir(file_dir):
        file_list.append(files)

    file_list.sort(reverse=False)

    return file_list

def insert_csv_data(path, csv_name_list):
    os.makedirs('finish', exist_ok=True)
    os.makedirs('outside', exist_ok=True)
    # count = 0
    # total = len(csv_name_list)

    print('######## Start ' + str(datetime.datetime.now()) + ' ######## \n')

    for csv_name in csv_name_list:
        date, device, file_type = csv_name.split('.')

        if device in out_of_list:
            shutil.move(path + csv_name, 'outside')
            break

        print(csv_name)

        force_float = ''
        force_string = ''

        if device in float_map:
            for channel_id in float_map[device]:
                force_float += ' -f ' + channel_id

        if device in str_map:
            for channel_id in str_map[device]:
                force_string += ' -s ' + channel_id

        result = os.system(
            '/qcsv-venv/venv/bin/qcsv.qfeeder.inject --readings-per-request 200 --host 127.0.0.1 --port 6080'
            + force_string
            + force_float
            + ' --csv=' + path + csv_name
            + ' 2>&1 > ' + path + '_' + csv_name + '.log')
        
        exit_status = result >> 8

        if exit_status != 0:
            print(csv_name + '  Insert Fail !!!') 
            exit(1) # Let shell get exit status.
        # else:
        #     shutil.move(path + csv_name, 'finish')

        # count += 1
        #print(str(count) + '/' + str(total) + "  " + str(round(count/total*100)) + "% \n" )


def main():
    csv_path = sys.argv[1:]
    csv_path_str = str(csv_path[0])
    csv_name_list = get_csv_list(csv_path_str)
    insert_csv_data(csv_path_str, csv_name_list)

    print('\n######## Finish ' + str(datetime.datetime.now()) + ' ########\n' )

if __name__ == "__main__":
    main()